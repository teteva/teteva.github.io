
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
<script>
  // A global function that the theme toggle can use to apply the current theme.
  window.applyThemeSetting = function(override) {
    const currentSetting = override || localStorage.getItem('user-color-scheme');
    const currentAttribute = document.documentElement.getAttribute('data-user-theme');

    if (currentSetting && currentSetting !== currentAttribute) {
      document.documentElement.setAttribute('data-user-theme', currentSetting);
    }
  };
window.applyThemeSetting();
</script>

  
  <link rel="stylesheet" href="/css/next.css?v=2ebe2291ff38b">
  <link rel="stylesheet" href="/css/legacy-rollout.css?v=c64d3f6d2f07d">
  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Service worker mindset</title>
<meta name="description" content="Working with service workers is new and unfamiliar for many web devs. This post provides some tips for wrapping your mind around them. " />

<link rel="canonical" href="https://web.dev/service-worker-mindset/" />

<meta itemprop="name" content="Service worker mindset" />
<meta itemprop="description" content="Working with service workers is new and unfamiliar for many web devs. This post provides some tips for wrapping your mind around them. " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/service-worker-mindset/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Service worker mindset" />
<meta property="og:description" content="Working with service workers is new and unfamiliar for many web devs. This post provides some tips for wrapping your mind around them. " />
<meta property="og:image" content="https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="Service workers lining up." />
<meta property="tag" content="service-worker" />
<meta property="tag" content="progressive-web-apps" />
<meta property="tag" content="offline" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Service worker mindset" />
<meta name="twitter:description" content="Working with service workers is new and unfamiliar for many web devs. This post provides some tips for wrapping your mind around them. " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>







<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=834d3cd77caac', 'module');




  loadScript('/js/content.js?v=102ad6aa55ef6', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    
<a href="#main" class="skip-link button" data-type="primary">Skip to content</a>


<web-header role="banner" class="site-header">
  <div class="cluster gutter-base">
    <button class="icon-button tooltip color-core-text md:hidden-yes" data-open-drawer-button data-alignment="right">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
      <span class="tooltip__content">Open menu</span>
    </button>
    <a href="/" class="site-header__brand brand">
      


  <svg role="img" aria-label="web.dev" xmlns="http://www.w3.org/2000/svg" width="119.79" height="22.32" viewBox="0 0 119.79 22.32"><path class="brand__text" d="M114.99 19.32h-2.2l-4.8-11.9h2.4l3.5 9.2 3.5-9.2h2.4Zm-16.8-7.3h6.8a3.17 3.17 0 0 0-3.4-2.9 3.42 3.42 0 0 0-3.4 2.9Zm3.6 7.7a6 6 0 0 1-6-6.3c0-3.6 2.5-6.3 5.9-6.3s5.8 2.4 5.8 6.5v.2h-9.3a3.88 3.88 0 0 0 3.8 3.9 3.56 3.56 0 0 0 3.3-2.1l2 1a6.22 6.22 0 0 1-5.5 3.1Zm-14 0c-3.1 0-5.7-2.8-5.7-6.3s2.6-6.3 5.7-6.3a5 5 0 0 1 4.1 2h.1l-.1-1.6v-5.5h2.2v17.3h-2.1v-1.6h-.1a5.12 5.12 0 0 1-4.1 2Zm.3-2c2.2 0 3.8-1.7 3.8-4.3s-1.6-4.3-3.8-4.3a4 4 0 0 0-3.8 4.3 4 4 0 0 0 3.8 4.3Zm-6.8.1a1.61 1.61 0 0 1-1.7 1.6 1.74 1.74 0 0 1-1.7-1.6 1.67 1.67 0 0 1 1.7-1.6 1.61 1.61 0 0 1 1.7 1.6Zm-10.5-.1a4 4 0 0 0 3.8-4.3 4 4 0 0 0-3.8-4.3c-2.2 0-3.8 1.8-3.8 4.3s1.6 4.3 3.8 4.3Zm.4 2a5 5 0 0 1-4.1-2h-.1v1.6h-2.1V2.02h2.2v5.5l-.1 1.6h.1a4.84 4.84 0 0 1 4.1-2c3.1 0 5.7 2.8 5.7 6.3s-2.6 6.3-5.7 6.3Zm-17.4-7.7h6.8a3.17 3.17 0 0 0-3.4-2.9 3.42 3.42 0 0 0-3.4 2.9Zm3.6 7.7a6 6 0 0 1-6-6.3c0-3.6 2.5-6.3 5.9-6.3s5.8 2.4 5.8 6.5v.2h-9.3a3.88 3.88 0 0 0 3.8 3.9 3.67 3.67 0 0 0 3.3-2.1l2 1a6.22 6.22 0 0 1-5.5 3.1Zm-6.3-12.2-3.8 11.9h-2.3l-3-9.1-2.9 9.1h-2.3l-3.9-11.9h2.3l2.6 9 2.9-9h2.3l2.9 9 2.6-9Z" fill="#5f6368" fill-rule="evenodd"/><path d="M0 19.28a3 3 0 0 1 3-3h16.27a3.045 3.045 0 0 1 0 6.09H3.04A3 3 0 0 1 0 19.28Z" fill="#6cf"/><path d="M.89.9a3 3 0 0 1 4.3 0l8.12 8.11a3.05 3.05 0 0 1 0 4.3l-8.12 8.12a3.04 3.04 0 1 1-4.3-4.3l5.6-5.61a.51.51 0 0 0 0-.72L.89 5.22A3 3 0 0 1 .89.9Z" fill="#06f" fill-rule="evenodd"/><path d="m10.39 16.22-5.2 5.2a3.04 3.04 0 1 1-4.3-4.3l.89-.9Z" fill="#c6f"/><circle cx="19.27" cy="19.27" r="3.04" fill="#06f"/></svg>


    </a>
  </div>
  <web-navigation-drawer type="standard">
    <nav class="site-header__nav" aria-label="main navigation" data-drawer-container>
      <a
        class="site-header__link"
        href="/learn/" data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
        >
          Learn
      </a>
      <a
        class="site-header__link"
        href="/measure/"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
        >
        Measure
      </a>
      <a
        class="site-header__link"
        href="/blog/"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
        >
        Blog
      </a>
      <a
        class="site-header__link"
        href="/tags/case-study/"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Case Studies"
        >
        Case studies
      </a>
      <a
        class="site-header__link"
        href="/about/"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About" >
        About
      </a>
      <button class="icon-button tooltip color-core-text md:hidden-yes" data-drawer-close-button>
        








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


        <span class="tooltip__content">Close</span>
      </button>
    </nav>
  </web-navigation-drawer>
  <div class="site-header__actions cluster">
    <div class="site-header__search">
      <web-search results-id="search-main-results" i18n="{&quot;search&quot;:{&quot;en&quot;:&quot;Search&quot;},&quot;open_search&quot;:{&quot;en&quot;:&quot;Open search&quot;},&quot;all_articles&quot;:{&quot;en&quot;:&quot;All articles&quot;},&quot;close_search&quot;:{&quot;en&quot;:&quot;Close search&quot;}}"></web-search>
      <web-search-results id="search-main-results"></web-search-results>
    </div>
  </div>
</web-header>

<main id="main">
  
    
  
  





  <img     alt="Service workers lining up."     class="hero-image"     decoding="async"     height="480"               sizes="100vw"     src="https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/7cjkg6ggaRsRNwZ0C2Vf.jpg?auto=format&w=1600 1600w"          width="1600"   />


<div class="post wrapper" data-flush>
  
    
    
    
  
  

  <div class="sidebar region flex-align-start flex-dir-rev flex-wrap-no">
    

  <nav class="course__toc toc over-scroll hidden-yes xl:hidden-no" data-type="side" aria-label="On this page">
    <div class="course-toc__heading font-google-sans weight-medium">On this page</div>
    <web-scroll-spy>
      <div class="toc__wrapper flow-recursive">
        <ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#the-same-but-different">The same, but different</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#a-new-layer">A new layer</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#powerful-but-limited">Powerful, but limited</a></li><li class="toc__listitem"><a class="toc__anchor" href="#long-lived-but-short-lived">Long-lived, but short-lived</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#stopped">Stopped</a></li><li class="toc__listitem"><a class="toc__anchor" href="#waituntil">waitUntil</a></li><li class="toc__listitem"><a class="toc__anchor" href="#watch-out-for-global-state">Watch out for global state</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#together-but-separate">Together, but separate</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#messing-with-another-service-worker's-caches">Messing with another service worker's caches</a></li><li class="toc__listitem"><a class="toc__anchor" href="#skip-skipwaiting">Skip skipWaiting</a></li><li class="toc__listitem"><a class="toc__anchor" href="#start-clean">Start clean</a></li><li class="toc__listitem"><a class="toc__anchor" href="#end-clean">End clean</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#service-worker-mindset">Service worker mindset</a></li></ul>
      </div>
    </web-scroll-spy>
  </nav>


    
    <article class="prose legacy-rollout">
      <header class="flow gap-bottom-size-3">
        
          <nav class="breadcrumbs" aria-label="breadcrumbs">
            <ul class="breadcrumbs__list" role="list">
              <li>
                <a
                  class="gc-analytics-event"
                  data-category="web.dev"
                  data-label="post, home breadcrumb"
                  data-action="click"
                  href="/"
                >
                  Home
                </a>
              </li>
              
              <li>
                <a
                  class="gc-analytics-event"
                  data-category="web.dev"
                  data-label="post, path breadcrumb"
                  data-action="click"
                  href="/blog"
                >
                  All articles
                </a>
              </li>
              
            </ul>
          </nav>
        

        <h1 id="service-worker-mindset">Service worker mindset</h1>
        
          <p class="color-mid-text flow-space-base">
            How to think when thinking about service workers.
          </p>
        

        
          <div class="flow-space-size-1 color-mid-text text-size-0">
            <time>Jun 4, 2019</time>
            
          </div>
        

        
        

        

        
          <div class="cluster flow-space-size-2">
            
              <div class="author">
  <a class="avatar" href="/authors/geddski/"> <img     alt="Dave Geddes"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/aU4CRVGbOgg8uSRuLAfh.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/aU4CRVGbOgg8uSRuLAfh.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/aU4CRVGbOgg8uSRuLAfh.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/aU4CRVGbOgg8uSRuLAfh.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/aU4CRVGbOgg8uSRuLAfh.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/aU4CRVGbOgg8uSRuLAfh.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /> </a>
  <div class="flow">
    <cite class="author__name">
      <a href="/authors/geddski/">Dave Geddes</a>
    </cite>
    <div class="author__links cluster">
               <a href="https://twitter.com/geddski">Twitter</a>
               <a href="https://github.com/geddski">GitHub</a>
               
               <a href="https://gedd.ski/">Homepage</a>
             </div>
  </div>
</div>
            
          </div>
        
      </header>

      

      

  

  <div class="xl:hidden-yes flow-space-size-1">
    <details data-type="inner" role="navigation" aria-label="On this page">
      <summary>
        On this page
      </summary>
      <div class="toc"><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#the-same-but-different">The same, but different</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#a-new-layer">A new layer</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#powerful-but-limited">Powerful, but limited</a></li><li class="toc__listitem"><a class="toc__anchor" href="#long-lived-but-short-lived">Long-lived, but short-lived</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#stopped">Stopped</a></li><li class="toc__listitem"><a class="toc__anchor" href="#waituntil">waitUntil</a></li><li class="toc__listitem"><a class="toc__anchor" href="#watch-out-for-global-state">Watch out for global state</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#together-but-separate">Together, but separate</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#messing-with-another-service-worker's-caches">Messing with another service worker's caches</a></li><li class="toc__listitem"><a class="toc__anchor" href="#skip-skipwaiting">Skip skipWaiting</a></li><li class="toc__listitem"><a class="toc__anchor" href="#start-clean">Start clean</a></li><li class="toc__listitem"><a class="toc__anchor" href="#end-clean">End clean</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#service-worker-mindset">Service worker mindset</a></li></ul></div>
    </details>
  </div>



      <p>Service workers are powerful and absolutely worth learning. They let you deliver an entirely new level of experience to your users. Your site can load <em>instantly</em>. It can work <em>offline</em>. It can be installed as a platform-specific app and feel every bit as polished—but with the reach and freedom of the web.</p>
<p>But service workers are unlike anything most of us web devs are used to. They come with a steep learning curve and a handful of snags you've got to watch out for.</p>
<p><a href="https://twitter.com/ChromiumDev" rel="noopener">Google Developers</a> and I recently collaborated on a project—<a href="https://serviceworkies.com" rel="noopener">Service Workies</a>—a free game for understanding service workers. While building it and working with the complex ins and outs of service workers, I ran into a few snags. What helped me the most was coming up with a handful of depictive metaphors. In this post we'll explore these mental models and wrap our brains around the paradoxical traits that make service workers both tricky and awesome.</p>
<h2 id="the-same-but-different">The same, but different <a class="w-headline-link" href="#the-same-but-different">#</a></h2>
<p>While coding your service worker, many things will feel familiar. You get to use your favorite new JavaScript language features. You listen to lifecycle events just like with UI events. You manage control flow with promises like you're used to.</p>
<p>But other service worker behavior causes you to scratch your head in confusion. Especially when you refresh the page and don't see your code changes applied.</p>
<h3 id="a-new-layer">A new layer <a class="w-headline-link" href="#a-new-layer">#</a></h3>
<p>Normally when building a site you have just two layers to think about: the client and the server. The service worker is a brand new layer that sits in the middle.</p>
<img     alt="A service worker acts as a middle layer between the client and the server"          decoding="async"     height="232"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/w6JgZDMJMoqp24IuC9UZ.jpg?auto=format&w=1600 1600w"          width="800"   />
<p>Think of your service worker as a sort of <em>browser extension</em>—one that your site can install in your user's browser. Once installed, the service worker <em>extends</em> the browser for your site with a powerful middle layer. This service worker layer can intercept and handle all of the requests your site makes.</p>
<p>The service worker layer has its <strong>own lifecycle</strong> independent of the browser tab. A simple page refresh isn't enough to update a service worker—just like you wouldn't expect a page refresh to update code deployed on a server. Each layer has its own unique rules for updating.</p>
<p>In the <a href="https://serviceworkies.com" rel="noopener">Service Workies</a> game we cover the many details of the service worker lifecycle and give you a ton of practice working with it.</p>
<img     alt="a new service worker replacing an old one"          decoding="async"     height="460"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format"     srcset="https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/mOyHcAJW55YiI12VW05a.gif?auto=format&w=1600 1600w"          width="800"   />
<aside class="aside flow bg-state-info-bg color-state-info-text">
<div class=" flow">
<p>Think of your service worker as a new middle layer with its own lifecycle and methods for updating.</p>
</div></aside>
<h2 id="powerful-but-limited">Powerful, but limited <a class="w-headline-link" href="#powerful-but-limited">#</a></h2>
<p>Having a service worker on your site gives you incredible benefits. Your site can:</p>
<ul>
<li>work flawlessly even when the user is offline</li>
<li>gain massive performance improvements through <a href="https://developer.mozilla.org/docs/Web/API/Cache" rel="noopener">caching</a></li>
<li>use <a href="https://developers.google.com/web/fundamentals/push-notifications/" rel="noopener">push notifications</a></li>
<li>be installed as a <a href="https://developers.google.com/web/progressive-web-apps/" rel="noopener">PWA</a></li>
</ul>
<p>With as much as service workers can do, they are limited by design. They can't do anything synchronous or in the same thread as your site. So that means no access to:</p>
<ul>
<li>localStorage</li>
<li>the DOM</li>
<li>the window</li>
</ul>
<p>The good news is there are a handful of ways your page can communicate with its service worker, including direct <a href="https://developer.mozilla.org/docs/Web/API/Client/postMessage" rel="noopener"><code>postMessage</code></a>, one-to-one <a href="https://developer.mozilla.org/docs/Web/API/MessageChannel" rel="noopener">Message Channels</a> and one-to-many <a href="https://developers.google.com/web/updates/2016/09/broadcastchannel" rel="noopener">Broadcast Channels</a>.</p>
<aside class="aside flow bg-state-info-bg color-state-info-text">
<div class=" flow">
<p>Think of your service worker as something that lives outside of your page. You can talk to it, but it can't access your page directly.</p>
</div></aside>
<h2 id="long-lived-but-short-lived">Long-lived, but short-lived <a class="w-headline-link" href="#long-lived-but-short-lived">#</a></h2>
<p>An active service worker goes on living even after a user leaves your site or closes the tab. The browser keeps this service worker around so that it will be ready the next time the user comes back to your site. Before the very first request is made, the service worker gets a chance to intercept it and take control of the page. This is what allows a site to work offline—the service worker can serve a cached version of the page itself, even if the user has no connection to the internet.</p>
<p>In <a href="https://serviceworkies.com" rel="noopener">Service Workies</a> we visualize this concept with Kolohe (a friendly service worker) intercepting and handling requests.</p>
<img     alt="service worker intercepting http requests"          decoding="async"     height="605"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format"     srcset="https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/YcXrupDTu2m7nlRU4FAz.gif?auto=format&w=1600 1600w"          width="800"   />
<h3 id="stopped">Stopped <a class="w-headline-link" href="#stopped">#</a></h3>
<p>Despite service workers appearing to be immortal, they can be <strong>stopped</strong> at almost any time. The browser doesn't want to waste resources on a service worker that isn't currently doing anything. Getting stopped isn't the same thing as getting <em>terminated</em>—the service worker remains installed and activated. It's just put to sleep. The next time it's needed (e.g., to handle a request), the browser wakes it back up.</p>
<h3 id="waituntil">waitUntil <a class="w-headline-link" href="#waituntil">#</a></h3>
<p>Because of the constant possibility of getting put to sleep, your service worker needs a way to let the browser know when it's doing something important and doesn't feel like taking a nap. This is where <code>event.waitUntil()</code> comes into play. This method extends the lifecycle it's used in, keeping it both from being stopped and from moving on to the next phase of its lifecycle until we're ready. This gives us time to setup caches, fetch resources from the network, etc.</p>
<p>This example tells the browser that our service worker isn't done installing until the <code>assets</code> cache has been created and populated with the picture of a sword:</p>
<web-copy-code><pre class="language-js"><code class="language-js">self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"install"</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><br>    caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"assets"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">cache</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/weapons/sword/blade.png"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><h3 id="watch-out-for-global-state">Watch out for global state <a class="w-headline-link" href="#watch-out-for-global-state">#</a></h3>
<p>When this start/stop happens the service worker's global scope is reset. So be careful not to use any global state in your service worker or you'll be sad the next time it wakes back up and has different state from what it was expecting.</p>
<p>Consider this example that uses a global state:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> favoriteNumber <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">let</span> hasHandledARequest <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br><br>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"fetch"</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>favoriteNumber<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hasHandledARequest<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  hasHandledARequest <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>On each request this service worker will log a number—let's say <code>0.13981866382421893</code>. The <code>hasHandledARequest</code> variable also changes to <code>true</code>. Now the service worker sits idle for a bit, so the browser stops it. The next time there's a request, the service worker is needed again, so the browser wakes it up. Its script is <strong>evaluated again</strong>. Now <code>hasHandledARequest</code> is reset to <code>false</code>, and <code>favoriteNumber</code> is something completely different—<code>0.5907281835659033</code>.</p>
<p>You can't rely on stored state in a service worker. Also, creating instances of things like Message Channels can cause bugs: you'll get a brand new instance every time the service worker stops/starts.</p>
<aside class="aside flow bg-state-warn-bg color-core-text">
<p class="cluster ">
<span class="aside__icon box-block color-state-warn-text"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" role="img" aria-label="Warning sign" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M23 21L12 2 1 21h22zm-12-3v-2h2v2h-2zm0-4h2v-4h-2v4z" />
</svg></span>
<strong>Warning</strong></p>
<div class=" flow">
<p>This snag is especially important to keep in mind while working on your service worker code because when Chrome DevTools is open, the start/stop behavior is disabled. You may not even see bugs caused by relying on global state until they've shipped to your users.</p>
</div></aside>
<p>In <a href="https://gedd.ski/post/service-workies-chapter3/" rel="noopener">Service Workies chapter 3</a> we visualize our stopped service worker as losing all color while it waits to be woken up.</p>
<img     alt="visualization of a stopped service worker"          decoding="async"     height="313"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/QBmObxFoIRgNtjsUttkF.jpg?auto=format&w=1600 1600w"          width="800"   />
<aside class="aside flow bg-state-info-bg color-state-info-text">
<div class=" flow">
<p>Think of your service worker as a <a href="https://www.akc.org/dog-breeds/whippet/" rel="noopener">whippet</a> dog. It's fast, loyal and awesome. It'll stick around by your side no matter what. But mostly it just wants to sleep. All the time. You've got to let it know when you want it to stay awake. Good dog!</p>
</div></aside>
<h2 id="together-but-separate">Together, but separate <a class="w-headline-link" href="#together-but-separate">#</a></h2>
<p>Your page can only be <em>controlled</em> by one service worker at a time. But it can have two service workers <em>installed</em> at once. When you make a change to your service worker code and refresh the page, you aren't actually editing your service worker at all. Service workers are <em>immutable</em>. You're instead making a brand new one. This new service worker (let's call it SW2) will <em>install</em> but it won't <em>activate</em> yet. It has to <em>wait</em> for the current service worker (SW1) to terminate (when your user leaves your site).</p>
<h3 id="messing-with-another-service-worker's-caches">Messing with another service worker's caches <a class="w-headline-link" href="#messing-with-another-service-worker's-caches">#</a></h3>
<p>While installing, SW2 can get things setup—usually creating and populating caches. But heads up: this new service worker has access to everything that the current service worker has access to. If you're not careful, your new waiting service worker can really mess things up for your current service worker. Some examples that could cause you trouble:</p>
<ul>
<li>SW2 could delete a cache that SW1 is actively using.</li>
<li>SW2 could edit the contents of a cache that SW1 is using, causing SW1 to respond with assets that the page isn't expecting.</li>
</ul>
<h3 id="skip-skipwaiting">Skip skipWaiting <a class="w-headline-link" href="#skip-skipwaiting">#</a></h3>
<p>A service worker can also use the risky <code>skipWaiting()</code> method to take control of the page as soon as it's done installing. This is generally a bad idea unless you're intentionally trying to replace a buggy service worker. The new service worker might be using updated resources that the current page isn't expecting, leading to errors and bugs.</p>
<h3 id="start-clean">Start clean <a class="w-headline-link" href="#start-clean">#</a></h3>
<p>The way to prevent your service workers from clobbering each other is to make sure they use different caches. The easiest way to accomplish that is to version the cache names they use.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> assetCacheName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">assets-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"install"</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>assetCacheName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">cache</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token comment">// confidently do stuff with your very own cache</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>When you deploy a new service worker, you'll bump the <code>version</code> so that it does what it needs with an entirely separate cache from the previous service worker.</p>
<img     alt="visualization of a cache"          decoding="async"     height="435"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/7REuAR11sps94W4tO7ng.jpg?auto=format&w=1600 1600w"          width="800"   />
<h3 id="end-clean">End clean <a class="w-headline-link" href="#end-clean">#</a></h3>
<p>Once your service worker reaches the <code>activated</code> state, you know it has taken over, and the previous service worker is redundant (i.e., no longer needed). At this point it's important to clean up after the old service worker. Not only does it respect your users' cache storage limits, but it can also prevent unintentional bugs.</p>
<p>The <a href="https://developer.mozilla.org/docs/Web/API/CacheStorage/match" rel="noopener"><code>caches.match()</code></a> method is an often-used shortcut for retrieving an item from <em>any</em> cache where there's a match. But it iterates through the caches in the order they were created. So let's say you've got two versions of a script file <code>app.js</code> in two different caches—<code>assets-1</code> and <code>assets-2</code>. Your page is expecting the newer script that's stored in <code>assets-2</code>. But if you haven't deleted the old cache, <code>caches.match('app.js')</code> is going to return the old one from <code>assets-1</code> and most likely break your site.</p>
<p>All it takes to clean up after previous service workers is to delete any cache that the new service worker doesn't need:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> assetCacheName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">assets-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><br>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"activate"</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><br>    caches<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">cacheNames</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><br>        cacheNames<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cacheName</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>          <span class="token keyword">if</span> <span class="token punctuation">(</span>cacheName <span class="token operator">!==</span> assetCacheName<span class="token punctuation">)</span><span class="token punctuation">{</span><br>            <span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></code></pre>
</web-copy-code><p>Preventing your service workers from clobbering each other takes a bit of work and discipline but is worth the trouble.</p>
<aside class="aside flow bg-state-info-bg color-state-info-text">
<div class=" flow">
<p>Think of the combination of your service worker and your site as an <a href="/installable">installable</a> app. Each version should work. Each version should be separate from the others. Imagine how buggy a game would be if the developer accidentally released a patch that used new game logic but outdated assets. You'd rage on the forums so fast! Keep your app versions tidy &amp; clean.</p>
</div></aside>
<h2 id="service-worker-mindset">Service worker mindset <a class="w-headline-link" href="#service-worker-mindset">#</a></h2>
<p>Getting into the right mindset while thinking about service workers will help you build yours with confidence. Once you get the hang of them you'll be able to create incredible experiences for your users.</p>
<p>If you want to understand all this by <a href="https://gedd.ski/post/mastery-through-play/" rel="noopener">playing a game</a>, then you're in luck! Go play <a href="https://serviceworkies.com" rel="noopener">Service Workies</a> where you'll learn the ways of the service worker in order to slay the offline beasts.</p>
<img     alt="preview of the Service Workies game"          decoding="async"     height="519"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format"     srcset="https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/HN8hJsK415482mqXmiaI.gif?auto=format&w=1600 1600w"          width="800"   />


      

      <div class="cluster gutter-base flow-space-size-2" role="list" aria-label="tags">
        
          
        
          
        
          
            
            <a class="pill" href="/tags/service-worker/">Service Worker</a>
          
        
          
            
            <a class="pill" href="/tags/progressive-web-apps/">Progressive Web Apps</a>
          
        
          
            
            <a class="pill" href="/tags/offline/">Offline</a>
          
        
      </div>

      <div class="text-size-0 color-mid-text">
        <span>
          
          Last updated: <time>Jun 4, 2019</time>
          
        </span>
        —
        <a
          href="https://github.com/GoogleChrome/web.dev/blob/main/src/site/content/en/blog/service-worker-mindset/index.md"
        >
          Improve article
        </a>
      </div>

      

      
        
        
      

      
        <div class="flow-space-size-2">
          <a href="/blog" class="button" data-type="secondary">
            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>

            <span>Return to all articles</span>
          </a>
        </div>
      
      <div class="docked-actions flow flow-space-base">    
        <div>
          <share-action class="gc-analytics-event fab"
            authors="@geddski"
            data-category="web.dev"
            data-label="share"
            data-action="click"
            data-type="primary"
            data-icon="share"
            tabindex="0"
            role="button"
          >
            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M18 16.1c-.8 0-1.4.3-2 .8l-7.1-4.2c.1-.2.1-.5.1-.7s0-.5-.1-.7L16 7.2c.5.5 1.2.8 2 .8 1.7 0 3-1.3 3-3s-1.3-3-3-3-3 1.3-3 3c0 .2 0 .5.1.7L8 9.8C7.5 9.3 6.8 9 6 9c-1.7 0-3 1.3-3 3s1.3 3 3 3c.8 0 1.5-.3 2-.8l7.1 4.2c-.1.2-.1.4-.1.6 0 1.6 1.3 2.9 2.9 2.9s2.9-1.3 2.9-2.9-1.2-2.9-2.8-2.9z" fill="currentColor"/></svg>
 
            <span class="fab__label">Share</span>
          </share-action>
        </div>
        
      </div>
    </article>
  </div>
</div>


</main>
<footer class="site-footer" role="contentinfo">
  <nav class="site-footer__primary-nav auto-grid" aria-label="footer navigation">
    <div>
      <h3 class="text-size-2 color-mid-text">Contribute</h3>
      <ul class="w-footer__linkbox-list" role="list">
        <li>
          <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            File a bug
          </a>
        </li>
        <li>
          <a href="https://github.com/googlechrome/web.dev"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
            View source
          </a>
        </li>
      </ul>
    </div>
    <div>
      <h3 class="text-size-2 color-mid-text">Related content</h3>
      <ul class="w-footer__linkbox-list" role="list">
          <li>
          <a href="https://developer.chrome.com/"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            developer.chrome.com
          </a>
        </li>
        <li>
          <a href="https://blog.chromium.org/"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            Chrome updates
          </a>
        </li>
        <li>
          <a href="https://developers.google.com/web/fundamentals"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
            Web Fundamentals
          </a>
        </li>
        <li>
          <a href="/tags/case-study/"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
            Case studies
          </a>
        </li>
        <li>
          <a href="/podcasts/"
            data-category="Podcasts" data-label="Footer Link (index 5)">
            Podcasts
          </a>
        </li>
        <li>
          <a href="/shows/"
            data-category="Shows" data-label="Footer Link (index 6)">
            Shows
          </a>
        </li>
      </ul>
    </div>
    <div>
      <h3 class="text-size-2 color-mid-text">Connect</h3>
      <ul class="w-footer__linkbox-list" role="list">
        <li>
          <a href="https://www.twitter.com/ChromiumDev"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            Twitter
          </a>
        </li>
        <li>
          <a href="https://www.youtube.com/user/ChromeDevelopers"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
            YouTube
          </a>
        </li>
      </ul>
    </div>
  </nav>
  <nav class="site-footer__brand-nav repel" aria-label="Google developers">
    <ul class="cluster" role="list">
      <li>
        <a href="https://developers.google.com/" data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
          <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
            alt="Google Developers" />
        </a>
      </li>
      <li>
        <a href="https://developer.chrome.com/"
          data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
          Chrome
        </a>
      </li>
      <li>
        <a href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
          data-label="Footer Firebase Link">
          Firebase
        </a>
      </li>
      <li>
        <a href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
          data-label="Footer Google Cloud Platform Link">
          Google Cloud Platform
        </a>
      </li>
      <li>
        <a href="https://developers.google.com/products"
          data-category="Site-Wide Custom Events" data-label="Footer All products Link">
          All products
        </a>
      </li>
    </ul>
    <web-language-select current="en"></web-language-select>
  </nav>
  <nav class="site-footer__misc-links" aria-label="terms and policies">
    <ul class="cluster" role="list">
      <li>
        <a href="https://policies.google.com/" data-category="Site-Wide Custom Events"
          data-label="Footer Terms and Privacy link">
          Terms &amp; Privacy
        </a>
      </li>
      <li>
        <a href="/community-guidelines/" data-category="Site-Wide Custom Events"
          data-label="Footer Community Guidelines link">
          Community Guidelines
        </a>
      </li>
    </ul>
  </nav>
  <p class="gap-top-size-2 text-size-0">
    Except as otherwise noted, the content of this page is licensed
    under the
    <a href="https://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 License</a>,
    and code samples are licensed under the
    <a href="https://www.apache.org/licenses/LICENSE-2.0">
    Apache 2.0 License</a>. For details, see the
    <a href="https://developers.google.com/terms/site-policies">
    Google Developers Site Policies</a>.
  </p>
</footer>


  </body>
</html>
