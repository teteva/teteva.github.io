
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=132bdb9d234ad">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Reduce JavaScript payloads with code splitting</title>
<meta name="description" content="In this codelab, learn how to improve the performance of a simple application through code splitting. " />

<link rel="canonical" href="https://web.dev/codelab-code-splitting/" />

<meta itemprop="name" content="Reduce JavaScript payloads with code splitting" />
<meta itemprop="description" content="In this codelab, learn how to improve the performance of a simple application through code splitting. " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/codelab-code-splitting/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Reduce JavaScript payloads with code splitting" />
<meta property="og:description" content="In this codelab, learn how to improve the performance of a simple application through code splitting. " />
<meta property="og:image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="" />
<meta property="tag" content="performance" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Reduce JavaScript payloads with code splitting" />
<meta name="twitter:description" content="In this codelab, learn how to improve the performance of a simple application through code splitting. " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>







<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=53199b158a6fa', 'module');




  loadScript('/js/content.js?v=45b6e00b09011', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="23" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results" i18n="{&quot;search&quot;:{&quot;en&quot;:&quot;Search&quot;},&quot;open_search&quot;:{&quot;en&quot;:&quot;Open search&quot;},&quot;all_articles&quot;:{&quot;en&quot;:&quot;All articles&quot;},&quot;close_search&quot;:{&quot;en&quot;:&quot;Close search&quot;}}"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
    
<div class="codelab-landing-page">
  
    
    
    
  
  <web-codelab class="web-codelab" glitch="code-splitting-starter"  >
    <div class="web-codelab__instructions">
      
      <article class="prose legacy-rollout">
        <header class="flow gap-bottom-size-3">

          <h1 id="reduce-javascript-payloads-with-code-splitting">Reduce JavaScript payloads with code splitting</h1>
          

          
            <div class="flow-space-size-1 color-mid-text text-size-0">
              <time>Nov 5, 2018</time>
              
            </div>
          

          

          
            <div class="cluster flow-space-size-2">
              
                <div class="w-author">
  <a href="/authors/houssein/"><img     alt="Houssein Djirdeh"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/houssein/">Houssein Djirdeh</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/hdjirdeh"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/housseindjirdeh">GitHub</a>
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://glitch.com/@housseindjirdeh"
          >Glitch</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://houssein.me/">Blog</a>
      </li>
    </ul>
  </div>
</div>
              
            </div>
          
        </header>

        

        <div class="w-aside w-aside--note">
<p>This codelab uses Chrome DevTools.
<a href="https://www.google.com/chrome" rel="noopener">Download Chrome</a> if you don't already have it.</p>
</div>
<p>Most web pages and applications are made up of many different parts. Instead of
sending all the JavaScript that makes up the application as soon as the first
page is loaded, splitting the JavaScript into multiple chunks
improves page performance.</p>
<p>This codelab shows how to use <strong>code splitting</strong> to improve the performance of a
simple application that sorts three numbers.</p>
<img     alt="A browser window shows an application titled Magic Sorter with three fields for inputting numbers and a sort button."          decoding="async"     height="504"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/1lb0XbGP6M4eShkmYaQW.png?auto=format&w=1600 1600w"          width="800"   />
<h2 id="measure">Measure <a class="w-headline-link" href="#measure">#</a></h2>
<div class="w-aside w-aside--note">
<p>Since webpack is used in this application, any changes made to the code will trigger a new build which can take a few seconds. Once it completes, you should see your changes reflected in the application.</p>
</div>
<p>Like always, it's important to first measure how well a website performs before
attempting to add any optimizations.</p>
<ol>
<li>To preview the site, press <strong>View App</strong>. Then press
<strong>Fullscreen</strong>
<img
src="/images/glitch/fullscreen.svg"
alt="fullscreen"
style="padding: 4px 8px; opacity: .5; border: 1px solid #c3c3c3; border-radius: 5px;"
/>.</li>
<li>Press `Control+Shift+J` (or `Command+Option+J` on Mac) to open DevTools.</li>
<li>Click the <strong>Network</strong> tab.</li>
<li>Select the <strong>Disable cache</strong> checkbox.</li>
<li>Reload the app.</li>
</ol>
<img     alt="Network panel showing 71.2 KB JavaScript bundle."     class="w-screenshot"     decoding="async"     height="153"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/pyzLwutSzSx2qztQMXTM.png?auto=format&w=1600 1600w"          width="800"   />
<p>71.2 KB worth of JavaScript just to sort a few numbers in a simple application.
What gives?</p>
<p>In the source code (<code>src/index.js</code>), the <code>lodash</code> library is imported and used
in this application. <a href="https://lodash.com/" rel="noopener">Lodash</a> provides many useful utility
functions, but only a single method from the package is being used here.
Installing and importing entire third-party dependencies where only a small
portion of it is being utilized is a common mistake.</p>
<h2 id="optimize">Optimize <a class="w-headline-link" href="#optimize">#</a></h2>
<p>There are a few ways the bundle size can be trimmed:</p>
<ol>
<li>Write a custom sorting method instead of importing a third-party library</li>
<li>Use the built in <code>Array.prototype.sort()</code> method to sort numerically</li>
<li>Only import the <code>sortBy</code> method from <code>lodash</code> and not the entire library</li>
<li>Download the code for sorting only when the user clicks the button</li>
</ol>
<p>Options 1 and 2 are perfectly appropriate methods to reduce the bundle size (and
would probably make the most sense for a real application). However, those are
not used in this tutorial for the sake of teaching 😈.</p>
<div class="w-aside w-aside--note">
<p>The concept of removing unused code is explored in further detail in a
<a href="/remove-unused-code">separate guide</a>.</p>
</div>
<p>Both options 3 and 4 help improve the performance of this application. The
next few sections of this codelab cover these steps. Like any coding
tutorial, always try to write the code yourself instead of copy and pasting.</p>
<h3 id="only-import-what-you-need">Only import what you need <a class="w-headline-link" href="#only-import-what-you-need">#</a></h3>
<p>A few files need to be modified to only import the single method from <code>lodash</code>.
To begin with, replace this dependency in <code>package.json</code>:</p>
<web-copy-code><pre class="language-json"><code class="language-json"><span class="token property">"lodash"</span><span class="token operator">:</span> <span class="token string">"^4.7.0"</span><span class="token punctuation">,</span></code></pre>
</web-copy-code><p>with this:</p>
<web-copy-code><pre class="language-json"><code class="language-json"><span class="token property">"lodash.sortby"</span><span class="token operator">:</span> <span class="token string">"^4.7.0"</span><span class="token punctuation">,</span></code></pre>
</web-copy-code><p>Now in <code>src/index.js</code>, import this specific module:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> <span class="token string">"./style.css"</span><span class="token punctuation">;</span></span><br><del class="highlight-line highlight-line-remove"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">"lodash"</span><span class="token punctuation">;</span></del><br><ins class="highlight-line highlight-line-add"><span class="token keyword">import</span> sortBy <span class="token keyword">from</span> <span class="token string">"lodash.sortby"</span><span class="token punctuation">;</span></ins></code></pre>
</web-copy-code><p>And update how the values are sorted::</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line">form<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"submit"</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span>input1<span class="token punctuation">.</span>valueAsNumber<span class="token punctuation">,</span> input2<span class="token punctuation">.</span>valueAsNumber<span class="token punctuation">,</span> input3<span class="token punctuation">.</span>valueAsNumber<span class="token punctuation">]</span><span class="token punctuation">;</span></span><br><del class="highlight-line highlight-line-remove">  <span class="token keyword">const</span> sortedValues <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">sortBy</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span></del><br><ins class="highlight-line highlight-line-add">  <span class="token keyword">const</span> sortedValues <span class="token operator">=</span> <span class="token function">sortBy</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span></ins><br><span class="highlight-line"></span><br>  results<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br><span class="highlight-line">    &lt;h2></span><br><span class="highlight-line">      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sortedValues<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"></span><br><span class="highlight-line">    &lt;/h2></span><br>  </span><span class="token template-punctuation string">`</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
</web-copy-code><p>Reload the application, open DevTools, and take a look at the <strong>Network</strong> panel
once again.</p>
<img     alt="Network panel showing 15.2 KB JavaScript bundle."     class="w-screenshot"     decoding="async"     height="148"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/J8c1PhqMDOJKjoenzMCN.png?auto=format&w=1600 1600w"          width="800"   />
<p>For this application, the bundle size was reduced by over 4X with very little
work, but there's still more room for improvement.</p>
<h3 id="code-splitting">Code splitting <a class="w-headline-link" href="#code-splitting">#</a></h3>
<p><a href="https://webpack.js.org/" rel="noopener"><strong>webpack</strong></a> is one of the most popular open-source
module bundlers used today. In short, it <em>bundles</em> all JavaScript modules (as
well as other assets) that make up a web application into static files that can
be read by the browser.</p>
<p>The single bundle used in this application can be split into two separate
chunks:</p>
<ul>
<li>One responsible for the code that makes up our initial route</li>
<li>A secondary chunk that contains our sorting code</li>
</ul>
<p>With the use of <strong>dynamic imports</strong>, a secondary chunk can be <em>lazy loaded,</em> or
loaded on demand. In this application, the code that makes up the chunk can be
loaded only when the user presses the button.</p>
<p>Begin by removing the top-level import for the sort method in <code>src/index.js</code>:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><del class="highlight-line highlight-line-remove"><span class="token keyword">import</span> sortBy <span class="token keyword">from</span> <span class="token string">"lodash.sortby"</span><span class="token punctuation">;</span></del></code></pre>
</web-copy-code><p>And import it within the event listener that fires when the button is pressed:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line">form<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"submit"</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><mark class="highlight-line highlight-line-active">  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'lodash.sortby'</span><span class="token punctuation">)</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">module</span> <span class="token operator">=></span> module<span class="token punctuation">.</span>default<span class="token punctuation">)</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">sortInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
</web-copy-code><p>The <code>import()</code> feature is part of a
<a href="https://github.com/tc39/proposal-dynamic-import" rel="noopener">proposal</a> (currently at stage
3 of the TC39 process) to include the capability to dynamically import a module.
webpack has already included support for this and follows the same syntax laid
out by the proposal.</p>
<div class="w-aside w-aside--note">
<p>Read more about how dynamic imports work in this <a href="https://developers.google.com/web/updates/2017/11/dynamic-import" rel="noopener">Web Updates
article</a>.</p>
</div>
<p><code>import()</code> returns a promise and when it resolves, the selected
module is provided which is split out into a separate chunk. After the module is
returned, <code>module.default</code> is used to reference the default
export provided by lodash. The promise is chained with another <code>.then</code> that
calls a <code>sortInput</code> method to sort the three input values. At the end of the
promise chain, .<code>catch()</code> is used to handle cases where the promise is rejected
due to an error.</p>
<div class="w-aside w-aside--caution">
<p><strong>Caution</strong>:
In a production application, always handle dynamic import
errors appropriately. A simple alert message similar to what is used here may
not provide the best user experience to let the user know something has
failed.</p>
</div>
<div class="w-aside w-aside--note">
<p>You may see a linting error that says:</p>
<web-copy-code><pre class="language-bash"><code class="language-bash">Parsing error: <span class="token string">'import'</span> and <span class="token string">'export'</span> may only appear at the <span class="token function">top</span> level.</code></pre>
</web-copy-code><p>This is due to the fact that
the dynamic import syntax is still in the proposal stage and has not been
finalized. Although webpack already supports it, the settings for
<a href="https://eslint.org" rel="noopener">ESLint</a> (a JavaScript linting utility) used by
Glitch has not been updated to include this syntax yet, but it still works!</p>
</div>
<p>The last thing that needs to be done is to write the <code>sortInput</code> method at the
end of the file. This needs to be a function that <em>returns</em> a function that
takes in the imported method from <code>lodash.sortBy</code>. The nested function can then
sort the three input values and update the DOM.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">sortInput</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">sortBy</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><br>      input1<span class="token punctuation">.</span>valueAsNumber<span class="token punctuation">,</span><br>      input2<span class="token punctuation">.</span>valueAsNumber<span class="token punctuation">,</span><br>      input3<span class="token punctuation">.</span>valueAsNumber<br>    <span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> sortedValues <span class="token operator">=</span> <span class="token function">sortBy</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    results<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br>      &lt;h2><br>        </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sortedValues<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br>      &lt;/h2><br>    </span><span class="token template-punctuation string">`</span></span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h2 id="monitor">Monitor <a class="w-headline-link" href="#monitor">#</a></h2>
<p>Reload the application one last time and keep a close eye on the <strong>Network</strong>
panel again. Only a small initial bundle is downloaded as soon as the app
loads.</p>
<img     alt="Network panel showing 2.7 KB JavaScript bundle."     class="w-screenshot"     decoding="async"     height="151"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/f1QZcSozkaA1rj52YWGV.png?auto=format&w=1600 1600w"          width="800"   />
<p>After the button is pressed to sort the input numbers, the chunk that contains
the sorting code gets fetched and executed.</p>
<img     alt="Network panel showing 2.7 KB JavaScript bundle followed by a 13.9 KB JavaScript bundle."     class="w-screenshot"     decoding="async"     height="211"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/LPNj3JpAmzsGppwJl5fs.png?auto=format&w=1600 1600w"          width="800"   />
<p>Notice how the numbers still get sorted!</p>
<h2 id="conclusion">Conclusion <a class="w-headline-link" href="#conclusion">#</a></h2>
<p>Code splitting and lazy loading can be extremely useful techniques to trim down
the initial bundle size of your application, and this can directly result in
much faster page load times. However, there are some important things that need
to be considered before including this optimization in your application.</p>
<h3 id="lazy-loading-ui">Lazy loading UI <a class="w-headline-link" href="#lazy-loading-ui">#</a></h3>
<p>When lazy loading specific modules of code, it's important to consider how the
experience would be for users with weaker network connections. Splitting and
loading a very large chunk of code when a user submits an action can make it
seem like the application may have stopped working, so consider showing a
loading indicator of some sort.</p>
<h3 id="lazy-loading-third-party-node-modules">Lazy loading third-party node modules <a class="w-headline-link" href="#lazy-loading-third-party-node-modules">#</a></h3>
<p>It is not always the best approach to lazy load third-party dependencies in your
application and it depends on where you use them. Usually, third party
dependencies are split into a separate <code>vendor</code> bundle that can be cached since
they don't update as often. Read more about how the
<a href="https://webpack.js.org/plugins/split-chunks-plugin/" rel="noopener">SplitChunksPlugin</a> can
help you do this.</p>
<h3 id="lazy-loading-with-a-javascript-framework">Lazy loading with a JavaScript framework <a class="w-headline-link" href="#lazy-loading-with-a-javascript-framework">#</a></h3>
<p>Many popular frameworks and libraries that use webpack provide abstractions to
make lazy loading easier than using dynamic imports in the middle of your
application.</p>
<ul>
<li><a href="https://angular.io/guide/lazy-loading-ngmodules" rel="noopener">Lazy loading modules with Angular</a></li>
<li><a href="https://reacttraining.com/react-router/web/guides/code-splitting" rel="noopener">Code splitting with React Router</a></li>
<li><a href="https://router.vuejs.org/guide/advanced/lazy-loading.html" rel="noopener">Lazy loading with Vue Router</a></li>
</ul>
<p>Although it is useful to understand how dynamic imports work, always use the
method recommended by your framework/library to lazy load specific modules.</p>
<h3 id="preloading-and-prefetching">Preloading and prefetching <a class="w-headline-link" href="#preloading-and-prefetching">#</a></h3>
<p>Where possible, take advantage of browser hints such as <code>&lt;link rel=&quot;preload&quot;&gt;</code>
or <code>&lt;link rel=&quot;prefetch&quot;&gt;</code> in order to try and load critical modules even
sooner. webpack supports both hints through the use of magic comments in import
statements. This is explained in more detail in the
<a href="/preload-critical-assets">Preload critical chunks</a> guide.</p>
<h3 id="lazy-loading-more-than-code">Lazy loading more than code <a class="w-headline-link" href="#lazy-loading-more-than-code">#</a></h3>
<p>Images can make up a significant part of an application. Lazy loading those that
are below the fold, or outside the device viewport, can speed up a website. Read
more about this in the
<a href="/use-lazysizes-to-lazyload-images">Lazysizes</a> guide.</p>


        <div class="text-size-0 color-mid-text">
          <span>
            
            Last updated: <time>Nov 5, 2018</time>
            
          </span>
          —
          <a
            href="https://github.com/GoogleChrome/web.dev/blob/main/src/site/content/en/fast/codelab-code-splitting/index.md"
          >
            Improve article
          </a>
        </div>

        
          
          
        

        
          <div class="flow-space-size-2">
            <a href="/reduce-javascript-payloads-with-code-splitting" class="button" data-type="secondary">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>

              <span>Return to article</span>
            </a>
          </div>
        
      </article>
    </div>
  </web-codelab>
</div>

  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
         <li class="w-footer__linkbox-item">
            <a href="https://developer.chrome.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              developer.chrome.com
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/fundamentals" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/terms/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
