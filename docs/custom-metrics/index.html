
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=10eeb1458e3fd">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Custom metrics</title>
<meta name="description" content="Custom metrics allow you to measure and optimize aspects of your site's experience that are unique to your site. " />

<link rel="canonical" href="https://web.dev/custom-metrics/" />

<meta itemprop="name" content="Custom metrics" />
<meta itemprop="description" content="Custom metrics allow you to measure and optimize aspects of your site's experience that are unique to your site. " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/custom-metrics/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Custom metrics" />
<meta property="og:description" content="Custom metrics allow you to measure and optimize aspects of your site's experience that are unique to your site. " />
<meta property="og:image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="" />
<meta property="tag" content="performance" />
<meta property="tag" content="metrics" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Custom metrics" />
<meta name="twitter:description" content="Custom metrics allow you to measure and optimize aspects of your site's experience that are unique to your site. " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>







<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=fe5b6fc50251e', 'module');




  loadScript('/js/content.js?v=d73f0a7315472', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="23" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results" i18n="{&quot;search&quot;:{&quot;en&quot;:&quot;Search&quot;},&quot;open_search&quot;:{&quot;en&quot;:&quot;Open search&quot;},&quot;all_articles&quot;:{&quot;en&quot;:&quot;All articles&quot;},&quot;close_search&quot;:{&quot;en&quot;:&quot;Close search&quot;}}"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
      
    
    


<div class="guide-landing-page">
  
    
    
    
  
  

  

  <web-table-of-contents>
    <h2 class="w-toc__header">
      <a href="#custom-metrics" class="w-toc__header--link">
        Custom metrics
      </a>
    </h2>
    <div class="w-toc__list">
        <ul><li><a href="#apis-to-measure-custom-metrics">APIs to measure custom metrics</a><ol><li><a href="#performance-observer">Performance Observer</a></li><li><a href="#user-timing-api">User Timing API</a></li><li><a href="#long-tasks-api">Long Tasks API</a></li><li><a href="#element-timing-api">Element Timing API</a></li><li><a href="#event-timing-api">Event Timing API</a></li><li><a href="#resource-timing-api">Resource Timing API</a></li><li><a href="#navigation-timing-api">Navigation Timing API</a></li><li><a href="#server-timing-api">Server Timing API</a></li></ol></li></ul></div>
  </web-table-of-contents>
  <web-table-of-contents-button></web-table-of-contents-button>

  
  <div class="w-actions">
    <share-action authors="@philwalton"
      class="gc-analytics-event w-actions__fab w-actions__fab--share"
      data-category="web.dev"
      data-label="share"
      data-action="click"
      data-icon="share"
      tabindex="0"
      role="button"
    >
      <span>Share</span>
    </share-action>
    
    
  </div>

  <div class="w-layout-container--narrow w-post-content">
    <header class="w-article-header">
      

      <h1 id="custom-metrics" class="w-article-header__headline">Custom metrics</h1>
      

      
        <div class="w-author__published">
          <time>Nov 8, 2019</time>
          
        </div>
      

      
      

      <div class="w-layout-container--narrow w-post-signpost">
  <span class="w-post-signpost__title">
    Appears in:
  </span>
  <a
          class="w-post-signpost__link"
          href="/metrics"
          >Metrics</a
        >
</div>

      
        <div class="w-authors w-mt--xl w-pt--sm">
          
            <div class="w-author">
  <a href="/authors/philipwalton/"><img     alt="Philip Walton"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/ovBM8MF9rYDxVVHUVlcG.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/ovBM8MF9rYDxVVHUVlcG.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/ovBM8MF9rYDxVVHUVlcG.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/ovBM8MF9rYDxVVHUVlcG.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/ovBM8MF9rYDxVVHUVlcG.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/ovBM8MF9rYDxVVHUVlcG.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/philipwalton/">Philip Walton</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/philwalton"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/philipwalton">GitHub</a>
      </li>
      
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://philipwalton.com">Blog</a>
      </li>
    </ul>
  </div>
</div>
          
        </div>
      
    </header>

    

    <p>There's a lot of value in having <a href="/user-centric-performance-metrics/">user-centric metrics</a>
that you can measure, universally, on any given website. These metrics allow you
to:</p>
<ul>
<li>Understand how real users experience the web as a whole</li>
<li>Easily compare your site to a competitor's</li>
<li>Track useful and actionable data in your analytics tools without needing to
write custom code</li>
</ul>
<p>Universal metrics offer a good baseline, but in many cases you need to measure
<em>more</em> than just these metrics in order to capture the full experience for your
particular site.</p>
<p>Custom metrics allow you to measure aspects of your site's experience that may
only apply to your site, such as:</p>
<ul>
<li>How long it takes for a single page app (SPA) to transition from one &quot;page&quot; to
another</li>
<li>How long it takes for a page to display data fetched from a database for
logged-in users</li>
<li>How long it takes for a server-side-rendered (SSR) app to
<a href="https://addyosmani.com/blog/rehydration/" rel="noopener">hydrate</a></li>
<li>The cache hit rate for resources loaded by returning visitors</li>
<li>The event latency of click or keyboard events in a game</li>
</ul>
<h2 id="apis-to-measure-custom-metrics">APIs to measure custom metrics <a class="w-headline-link" href="#apis-to-measure-custom-metrics">#</a></h2>
<p>Historically web developers haven't had many low-level APIs to measure
performance, and as a result they've had to resort to hacks in order to measure
whether a site was performing well.</p>
<p>For example, it's possible to determine whether the main thread is blocked due
to long-running JavaScript tasks by running a <code>requestAnimationFrame</code> loop and
calculating the delta between each frame. If the delta is significantly longer
than the display's framerate, you can report that as a long task. Such hacks are
not recommended, though, because they actually affect performance themselves
(by draining battery, for example).</p>
<p>The first rule of effective performance measurement is to make sure your
performance measurement techniques aren't causing performance issues themselves.
So for any custom metrics you measure on your site, it's best to use one of the
following APIs if possible.</p>
<h3 id="performance-observer">Performance Observer <a class="w-headline-link" href="#performance-observer">#</a></h3>
<p>Understanding the PerformanceObserver API is critical to creating custom
performance metrics because it's the mechanism by which you get data from all
other performance APIs discussed in this article.</p>
<p>With <code>PerformanceObserver</code> you can subscribe passively to performance-related
events, which means these APIs generally will not interfere with the performance
of the page, as their callbacks are generally fired during <a href="https://w3c.github.io/requestidlecallback/#idle-periods" rel="noopener">idle
periods</a>.</p>
<p>You create a <code>PerformanceObserver</code> by passing it a callback to be run whenever
new performance entries are dispatched. Then you tell the observer what types of
entries to listen for via the
<a href="https://developer.mozilla.org/docs/Web/API/PerformanceObserver/observe" rel="noopener"><code>observe()</code></a>
method:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// Log the entry and all associated details.</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'some-entry-type'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>The sections below list all the various entry types available for observing, but
in newer browsers you can inspect what entry types are available via the static
<a href="https://w3c.github.io/performance-timeline/#supportedentrytypes-attribute" rel="noopener"><code>PerformanceObserver.supportedEntryTypes</code></a>
property.</p>
<div class="w-aside w-aside--note">
<p>The object passed to the <code>observe()</code> method can also specify an <code>entryTypes</code>
array (in order to observe more than one entry type via the same observer).
While specifying <code>entryTypes</code> is an older option with wider browser support,
using <code>type</code> is now preferred, as it allows for specifying additional
entry-specific observation configuration (such as the <code>buffered</code> flag, discussed
next).</p>
</div>
<h4 id="observing-entries-that-already-happened">Observing entries that already happened <a class="w-headline-link" href="#observing-entries-that-already-happened">#</a></h4>
<p>By default, <code>PerformanceObserver</code> objects can only observe entries as they
occur. This can be problematic if you want to load your performance analytics
code lazily (to not block higher-priority resources).</p>
<p>To get historical entries (after they've occurred), set the <code>buffered</code> flag to
<code>true</code> when you call <code>observe()</code>. The browser will include historical entries
from its <a href="https://w3c.github.io/performance-timeline/#dfn-performance-entry-buffer" rel="noopener">performance entry
buffer</a>
the first time that your <code>PerformanceObserver</code> callback is called.</p>
<web-copy-code><pre class="language-js"><code class="language-js">po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>  type<span class="token operator">:</span> <span class="token string">'some-entry-type'</span><span class="token punctuation">,</span><br>  buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><div class="w-aside w-aside--note">
<p>To avoid memory issues, the performance entry buffer is not unlimited. For
most typical page loads it's unlikely that the buffer will fill up and entries
will be missed.</p>
</div>
<h4 id="legacy-performance-apis-to-avoid">Legacy performance APIs to avoid <a class="w-headline-link" href="#legacy-performance-apis-to-avoid">#</a></h4>
<p>Prior to the Performance Observer API, developers could access performance
entries using the following three methods defined on the
<a href="https://w3c.github.io/performance-timeline/" rel="noopener"><code>performance</code></a> object:</p>
<ul>
<li><a href="https://developer.mozilla.org/docs/Web/API/Performance/getEntries" rel="noopener"><code>getEntries()</code></a></li>
<li><a href="https://developer.mozilla.org/docs/Web/API/Performance/getEntriesByName" rel="noopener"><code>getEntriesByName()</code></a></li>
<li><a href="https://developer.mozilla.org/docs/Web/API/Performance/getEntriesByType" rel="noopener"><code>getEntriesByType()</code></a></li>
</ul>
<p>While these APIs are still supported, their usage is not recommended because
they don't allow you to listen for when new entries are emitted. In addition,
many new APIs (such as Long Tasks) are not exposed via the <code>performance</code> object,
they're only exposed via <code>PerformanceObserver</code>.</p>
<p>Unless you specifically need Internet Explorer compatibility, it's best to avoid
these methods in your code and use <code>PerformanceObserver</code> going forward.</p>
<h3 id="user-timing-api">User Timing API <a class="w-headline-link" href="#user-timing-api">#</a></h3>
<p>The <a href="https://w3c.github.io/user-timing/" rel="noopener">User Timing API</a> is your general
purpose measurement API for time-based metrics. It allows you to arbitrarily
mark points in time and then later measure the duration between those marks.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Record the time immediately before running a task.</span><br>performance<span class="token punctuation">.</span><span class="token function">mark</span><span class="token punctuation">(</span><span class="token string">'myTask:start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token keyword">await</span> <span class="token function">doMyTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">// Record the time immediately after running a task.</span><br>performance<span class="token punctuation">.</span><span class="token function">mark</span><span class="token punctuation">(</span><span class="token string">'myTask:end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Measure the delta between the start and end of the task</span><br>performance<span class="token punctuation">.</span><span class="token function">measure</span><span class="token punctuation">(</span><span class="token string">'myTask'</span><span class="token punctuation">,</span> <span class="token string">'myTask:start'</span><span class="token punctuation">,</span> <span class="token string">'myTask:end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>While APIs like <code>Date.now()</code> or <code>performance.now()</code> give you similar abilities,
the benefit of using the User Timing API is it integrates well with performance
tooling. For example, Chrome DevTools visualizes <a href="https://developers.google.com/web/updates/2018/04/devtools#tabs" rel="noopener">User Timing measurements in the
Performance panel</a>, and many analytics providers will also automatically track
any measurements you make and send the duration data to their analytics back
end.</p>
<p>To report User Timing measurements, you can use
<a href="#performance-observer">PerformanceObserver</a> and register to observe entries of
type <code>measure</code>:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Create the performance observer.</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// Log the entry and all associated details.</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Start listening for `measure` entries to be dispatched.</span><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'measure'</span><span class="token punctuation">,</span> buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h3 id="long-tasks-api">Long Tasks API <a class="w-headline-link" href="#long-tasks-api">#</a></h3>
<p>The <a href="https://w3c.github.io/longtasks/" rel="noopener">Long Tasks API</a> is useful for knowing
when the browser's main thread is blocked for long enough to affect frame rate
or input latency. Currently the API will report any tasks that execute for
longer than 50 milliseconds (ms).</p>
<p>Anytime you need to run expensive code (or load and execute large scripts) it's
useful to track whether or not that code blocked the main thread. In fact, many
higher-level metrics are built on top of the Long Tasks API themselves (such as
<a href="/interactive/">Time to Interactive (TTI)</a> and <a href="/lighthouse-total-blocking-time/">Total Blocking Time
(TBT)</a>).</p>
<p>To determine when long tasks happen, you can use
<a href="https://developer.mozilla.org/docs/Web/API/PerformanceObserver" rel="noopener">PerformanceObserver</a>
and register to observe entries of type <code>longtask</code>:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Create the performance observer.</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// Log the entry and all associated details.</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Start listening for `longtask` entries to be dispatched.</span><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'longtask'</span><span class="token punctuation">,</span> buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h3 id="element-timing-api">Element Timing API <a class="w-headline-link" href="#element-timing-api">#</a></h3>
<p>The <a href="/lcp/">Largest Contentful Paint (LCP)</a> metric is
useful for knowing when the largest image or text block was painted to the
screen, but in some cases you want to measure the render time of a different
element.</p>
<p>For these cases, you can use the <a href="https://wicg.github.io/element-timing/" rel="noopener">Element Timing
API</a>. In fact, the Largest Contentful
Paint API is actually built on top of the Element Timing API and adds automatic
reporting of the largest contentful element, but you can report on additional
elements by explicitly adding the <code>elementtiming</code> attribute to them, and
registering a PerformanceObserver to observe the element entry type.</p>
<web-copy-code><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">elementtiming</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hero-image<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">elementtiming</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>important-paragraph<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>This is text I care about.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><br>...<br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Create the performance observer.</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entryList</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> entryList<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// Log the entry and all associated details.</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Start listening for `element` entries to be dispatched.</span><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'element'</span><span class="token punctuation">,</span> buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre>
</web-copy-code><div class="w-aside w-aside--gotchas"><strong>Gotchas!</strong>
<p>The types of elements considered for Largest Contentful Paint are
the same as those observable via the Element Timing API. If you add the
<code>elementtiming</code> attribute to an element that isn't one of those types, the
attribute will be ignored.</p>
</div>
<h3 id="event-timing-api">Event Timing API <a class="w-headline-link" href="#event-timing-api">#</a></h3>
<p>The <a href="/fid/">First Input Delay (FID)</a> metric measures the time from when a user
first interacts with a page to the time when the browser is actually able to
begin processing event handlers in response to that interaction. However, in
some cases it may also be useful to measure the event processing time itself as
well as the time until the next frame can be rendered.</p>
<p>This is possible with the <a href="https://wicg.github.io/event-timing/" rel="noopener">Event Timing
API</a> (which is used to measure FID) as it
exposes a number of timestamps in the event lifecycle, including:</p>
<ul>
<li><a href="https://w3c.github.io/performance-timeline/#dom-performanceentry-starttime" rel="noopener"><code>startTime</code></a>:
the time when the browser receives the event.</li>
<li><a href="https://wicg.github.io/event-timing/#dom-performanceeventtiming-processingstart" rel="noopener"><code>processingStart</code></a>:
the time when the browser is able to begin processing event handlers for
the event.</li>
<li><a href="https://wicg.github.io/event-timing/#dom-performanceeventtiming-processingend" rel="noopener"><code>processingEnd</code></a>:
time when the browser finishes executing all synchronous code initiated from
event handlers for this event.</li>
<li><a href="https://wicg.github.io/event-timing/#dom-performanceeventtiming-processingstart" rel="noopener"><code>duration</code></a>:
the time (rounded to 8ms for security reasons) between when the browser
receives the event until it's able to paint the next frame after finishing
executing all synchronous code initiated from the event handlers.</li>
</ul>
<p>The following example shows how to use these these values to create custom
measurements:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entryList</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> firstInput <span class="token operator">=</span> entryList<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Measure First Input Delay (FID).</span><br>    <span class="token keyword">const</span> firstInputDelay <span class="token operator">=</span> firstInput<span class="token punctuation">.</span>processingStart <span class="token operator">-</span> firstInput<span class="token punctuation">.</span>startTime<span class="token punctuation">;</span><br><br>    <span class="token comment">// Measure the time it takes to run all event handlers</span><br>    <span class="token comment">// Note: this does not include work scheduled asynchronously using</span><br>    <span class="token comment">// methods like `requestAnimationFrame()` or `setTimeout()`.</span><br>    <span class="token keyword">const</span> firstInputProcessingTime <span class="token operator">=</span> firstInput<span class="token punctuation">.</span>processingEnd <span class="token operator">-</span> firstInput<span class="token punctuation">.</span>processingStart<span class="token punctuation">;</span><br><br>    <span class="token comment">// Measure the entire duration of the event, from when input is received by</span><br>    <span class="token comment">// the browser until the next frame can be painted after processing all</span><br>    <span class="token comment">// event handlers.</span><br>    <span class="token comment">// Note: similar to above, this value does not include work scheduled</span><br>    <span class="token comment">// asynchronously using `requestAnimationFrame()` or `setTimeout()`.</span><br>    <span class="token comment">// And for security reasons, this value is rounded to the nearest 8ms.</span><br>    <span class="token keyword">const</span> firstInputDuration <span class="token operator">=</span> firstInput<span class="token punctuation">.</span>duration<span class="token punctuation">;</span><br><br>    <span class="token comment">// Log these values the console.</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>      firstInputDelay<span class="token punctuation">,</span><br>      firstInputProcessingTime<span class="token punctuation">,</span><br>      firstInputDuration<span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'first-input'</span><span class="token punctuation">,</span> buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h3 id="resource-timing-api">Resource Timing API <a class="w-headline-link" href="#resource-timing-api">#</a></h3>
<p>The <a href="https://w3c.github.io/resource-timing/" rel="noopener">Resource Timing API</a> gives
developers detailed insight into how resources for a particular page were
loaded. Despite the name of the API, the information it provides is not just
limited to timing data (though there's <a href="https://w3c.github.io/resource-timing/#processing-model" rel="noopener">plenty of
that</a>). Other data you
can access includes:</p>
<ul>
<li><a href="https://w3c.github.io/resource-timing/#dom-performanceresourcetiming-initiatortype" rel="noopener">initiatorType</a>:
how the resource was fetched: such as from a <code>&lt;script&gt;</code> or <code>&lt;link&gt;</code> tag, or
from <code>fetch()</code></li>
<li><a href="https://w3c.github.io/resource-timing/#dom-performanceresourcetiming-nexthopprotocol" rel="noopener">nextHopProtocol</a>:
the protocol used to fetch the resource, such as <code>h2</code> or <code>quic</code></li>
<li><a href="https://w3c.github.io/resource-timing/#dom-performanceresourcetiming-encodedbodysize" rel="noopener">encodedBodySize</a>/<a href="https://w3c.github.io/resource-timing/#dom-performanceresourcetiming-decodedbodysize" rel="noopener">decodedBodySize</a>]:
the size of the resource in its encoded or decoded form (respectively)</li>
<li><a href="https://w3c.github.io/resource-timing/#dom-performanceresourcetiming-transfersize" rel="noopener">transferSize</a>:
the size of the resource that was actually transferred over the network. When
resources are fulfilled via the cache, this value can be much smaller than the
<code>encodedBodySize</code>, and in some cases it can be zero (if no cache revalidation
is required).</li>
</ul>
<p>Note, you can use the <code>transferSize</code> property of resource timing entries to
measure a <em>cache hit rate</em> metric or perhaps even a <em>total cached resource size</em>
metric, which may be useful in understanding how your resource caching strategy
affects performance for repeat visitors.</p>
<p>The following example logs all resources requested by the page and indicates
whether or not each resource was fulfilled via the cache.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Create the performance observer.</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// If transferSize is 0, the resource was fulfilled via the cache.</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>name<span class="token punctuation">,</span> entry<span class="token punctuation">.</span>transferSize <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Start listening for `resource` entries to be dispatched.</span><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'resource'</span><span class="token punctuation">,</span> buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h3 id="navigation-timing-api">Navigation Timing API <a class="w-headline-link" href="#navigation-timing-api">#</a></h3>
<p>The <a href="https://w3c.github.io/navigation-timing/" rel="noopener">Navigation Timing API</a> is similar
to the Resource Timing API, but it reports only <a href="https://developers.google.com/web/fundamentals/primers/service-workers/high-performance-loading#first_what_are_navigation_requests" rel="noopener">navigation
requests</a>.
The <code>navigation</code> entry type is also similar to the <code>resource</code> entry type, but it
contains some <a href="https://w3c.github.io/navigation-timing/#sec-PerformanceNavigationTiming" rel="noopener">additional
information</a>
specific to only navigation requests (such as when the <code>DOMContentLoaded</code> and
<code>load</code> events fire).</p>
<p>One metric many developers track to understand server response time (<a href="https://en.wikipedia.org/wiki/Time_to_first_byte" rel="noopener">Time to
First Byte</a>) is available via
the Navigation Timing APIâ€”specifically it's entry's <code>responseStart</code> timestamp.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Create the performance observer.</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// If transferSize is 0, the resource was fulfilled via the cache.</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Time to first byte'</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>responseStart<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Start listening for `navigation` entries to be dispatched.</span><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'navigation'</span><span class="token punctuation">,</span> buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>Another metric developers who use service worker may care about is the service
worker startup time for navigation requests. This is the amount of time it takes
the browser to start the service worker thread before it can start intercepting
fetch events.</p>
<p>The service worker startup time for a particular navigation request can be
determined from the delta between <code>entry.responseStart</code> and <code>entry.workerStart</code>.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Create the performance observer.</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Service Worker startup time:'</span><span class="token punctuation">,</span><br>          entry<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> entry<span class="token punctuation">.</span>workerStart<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Start listening for `navigation` entries to be dispatched.</span><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'navigation'</span><span class="token punctuation">,</span> buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h3 id="server-timing-api">Server Timing API <a class="w-headline-link" href="#server-timing-api">#</a></h3>
<p>The <a href="https://w3c.github.io/server-timing/" rel="noopener">Server Timing API</a> allows you to pass
request-specific timing data from your server to the browser via response
headers. For example, you can indicate how long it took to lookup data in a
database for a particular requestâ€”which can be useful in debugging performance
issues caused by slowness on the server.</p>
<p>For developers who use third-party analytics providers, the Server Timing API is
the only way to correlate server performance data with other business metrics
that these analytics tools may be measuring.</p>
<p>To specify server timing data in your responses, you can use the <code>Server-Timing</code>
response header. Here's an example.</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span><br><br><span class="token header-name keyword">Server-Timing:</span> miss, db;dur=53, app;dur=47.2</code></pre>
</web-copy-code><p>Then, from your pages, you can read this data on both <code>resource</code> or <code>navigation</code>
entries from the Resource Timing and Navigation Timing APIs.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Catch errors since some browsers throw when using the new `type` option.</span><br><span class="token comment">// https://bugs.webkit.org/show_bug.cgi?id=209216</span><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Create the performance observer.</span><br>  <span class="token keyword">const</span> po <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> entry <span class="token keyword">of</span> list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// Logs all server timing data for this response</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server Timing'</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>serverTiming<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// Start listening for `navigation` entries to be dispatched.</span><br>  po<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'navigation'</span><span class="token punctuation">,</span> buffered<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Do nothing if the browser doesn't support this API.</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code>

    

    
  <div class="w-chips ">
    
      
    
      
        
        <a class="w-chip" href="/tags/performance/">Performance</a>
      
    
      
        
        <a class="w-chip" href="/tags/metrics/">Metrics</a>
      
    
  </div>


    <div class="w-post-github-link w-mt--l w-mb--l">
      <span class="w-mr--sm">
        
        Last updated: <time>Nov 8, 2019</time>
        
      </span>
      <a
        href="https://github.com/GoogleChrome/web.dev/blob/main/src/site/content/en/metrics/custom-metrics/index.md"
      >
        Improve article
      </a>
       
    </div>

    
  </div>

  
    
    <nav class="w-article-navigation">
  <a
    class="w-article-navigation__link w-article-navigation__link--back
      w-article-navigation__link--single gc-analytics-event"
    data-category="web.dev"
    data-label="navigation, go back"
    data-action="click"
    href="/metrics"
  >
    Return to all articles
  </a>
</nav>
  
</div>


  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
         <li class="w-footer__linkbox-item">
            <a href="https://developer.chrome.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              developer.chrome.com
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/fundamentals" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/terms/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
