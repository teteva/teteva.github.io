
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=26dae10f345ae">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Extract and inline critical CSS with Critical</title>
<meta name="description" content="Learn how use Critical to extract and inline critical CSS, and improve render times. " />

<link rel="canonical" href="https://web.dev/codelab-extract-and-inline-critical-css/" />

<meta itemprop="name" content="Extract and inline critical CSS with Critical" />
<meta itemprop="description" content="Learn how use Critical to extract and inline critical CSS, and improve render times. " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/codelab-extract-and-inline-critical-css/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Extract and inline critical CSS with Critical" />
<meta property="og:description" content="Learn how use Critical to extract and inline critical CSS, and improve render times. " />
<meta property="og:image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="" />
<meta property="tag" content="performance" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Extract and inline critical CSS with Critical" />
<meta name="twitter:description" content="Learn how use Critical to extract and inline critical CSS, and improve render times. " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>







<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=cce289c1d618e', 'module');




  loadScript('/js/content.js?v=3c8015ad70109', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="23" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results" i18n="{&quot;search&quot;:{&quot;en&quot;:&quot;Search&quot;},&quot;open_search&quot;:{&quot;en&quot;:&quot;Open search&quot;},&quot;all_articles&quot;:{&quot;en&quot;:&quot;All articles&quot;},&quot;close_search&quot;:{&quot;en&quot;:&quot;Close search&quot;}}"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
    
<div class="codelab-landing-page">
  
    
    
    
  
  <web-codelab class="web-codelab" glitch="critical-css-starter"  >
    <div class="web-codelab__instructions">
      
      <article class="prose legacy-rollout">
        <header class="flow gap-bottom-size-3">

          <h1 id="extract-and-inline-critical-css-with-critical">Extract and inline critical CSS with Critical</h1>
          

          
            <div class="flow-space-size-1 color-mid-text text-size-0">
              <time>May 29, 2019</time>
              
            </div>
          

          

          
            <div class="cluster flow-space-size-2">
              
                <div class="w-author">
  <a href="/authors/mihajlija/"><img     alt="Milica Mihajlija"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/WkMOiDtaDgiAA2YkRZ5H.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/WkMOiDtaDgiAA2YkRZ5H.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/WkMOiDtaDgiAA2YkRZ5H.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/WkMOiDtaDgiAA2YkRZ5H.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/WkMOiDtaDgiAA2YkRZ5H.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/WkMOiDtaDgiAA2YkRZ5H.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/mihajlija/">Milica Mihajlija</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/bibydigital"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/mihajlija">GitHub</a>
      </li>
      
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://mihajlija.github.io/">Blog</a>
      </li>
    </ul>
  </div>
</div>
              
            </div>
          
        </header>

        

        <div class="w-aside w-aside--note">
<p>This codelab uses Chrome DevTools.
<a href="https://www.google.com/chrome" rel="noopener">Download Chrome</a> if you don't already have it.</p>
</div>
<p>Whether you use a UI library or handcraft your styles, shipping a significant amount of CSS delays rendering because the browser must download and parse CSS files before it can show the page.</p>
<p>This responsive ice cream gallery is built with <a href="https://getbootstrap.com/" rel="noopener">Bootstrap</a>. UI libraries like Bootstrap speed up development, but that often comes at the expense of bloated and unnecessary CSS, which can slow down your load times. Bootstrap 4 is 187 KB, while <a href="https://semantic-ui.com/" rel="noopener">Semantic UI</a>, another UI library, is a whopping 730 KB uncompressed. Even when minified and gzipped, Bootstrap still weighs around 20 KB, well over the <a href="/extract-critical-css/#14KB">14 KB threshold</a> for the first roundtrip.</p>
<p><a href="https://github.com/addyosmani/critical" rel="noopener">Critical</a> is a tool that extracts, minifies and inlines <a href="/extract-critical-css">above-the-fold</a> CSS. This allows above-the-fold content to be rendered as soon as possible, even if CSS for other parts of the page has not yet loaded. In this codelab, you'll learn how to use Critical's npm module.</p>
<h2 id="measure">Measure <a class="w-headline-link" href="#measure">#</a></h2>
<ul>
<li>To preview the site, press <strong>View App</strong>. Then press
<strong>Fullscreen</strong>
<img
src="/images/glitch/fullscreen.svg"
alt="fullscreen"
style="padding: 4px 8px; opacity: .5; border: 1px solid #c3c3c3; border-radius: 5px;"
/>.</li>
</ul>
<p>To run a Lighthouse audit on this site:</p>
<ol>
<li>Press `Control+Shift+J` (or `Command+Option+J` on Mac) to open DevTools.</li>
<li>Click the <strong>Lighthouse</strong> tab.</li>
<li>Click <strong>Mobile</strong>.</li>
<li>Select the <strong>Performance</strong> checkbox.</li>
<li>Clear the rest of the checkboxes in the Audits section.</li>
<li>Click <strong>Simulated Fast 3G, 4x CPU Slowdown</strong>.</li>
<li>Select the <strong>Clear Storage</strong> checkbox. With this option selected, Lighthouse will not load resources from the cache, which simulates how first-time visitors would experience the page.</li>
<li>Click <strong>Run Audits</strong>.</li>
</ol>
<img     alt="Audits panel of Chrome DevTools, powered by Lighthouse"          decoding="async"     height="1068"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/bk0impRv9Mo0yDpbuIQi.png?auto=format&w=1600 1600w"          width="800"   />
<p>When you run an audit on your machine, the exact results may vary, but in the filmstrip view, you'll notice the app has a blank screen for quite a while before finally rendering the content. This is why <a href="/first-contentful-paint/">First Contentful Paint (FCP)</a> is high and why overall performance score is not great.</p>
<img     alt="Lighthouse audit showing performance score of 84, FCP 3 seconds and a filmstrip view of loading the app"     class="w-screenshot"     decoding="async"     height="356"          loading="lazy"     sizes="(min-width: 710px) 710px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/otfxnEjhjP9cNpSF8W4o.png?auto=format&w=1420 1420w"          width="710"   />
<p>Lighthouse is here to help you fix performance issues, so look for solutions in the <strong>Opportunities</strong> section. <strong>Eliminate render-blocking resources</strong> is listed as an opportunity and that's where Critical shines!</p>
<img     alt="Lighthouse audit &#x27;Opportunities&#x27; section listing &#x27;Eliminate render-blocking resources&#x27;"     class="w-screenshot"     decoding="async"     height="449"          loading="lazy"     sizes="(min-width: 743px) 743px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/L0i6jb8G1eT0vr2V45vH.png?auto=format&w=1486 1486w"          width="743"   />
<h2 id="optimize">Optimize <a class="w-headline-link" href="#optimize">#</a></h2>
<ul>
<li>Click <strong>Remix to Edit</strong> to make the project editable.</li>
</ul>
<p>To speed things up, Critical is already installed and an empty configuration file is included in the codelab.</p>
<p>In the configuration file <code>critical.js</code>, add a reference to Critical and then invoke the <code>critical.generate()</code> function. This function accepts an object containing the configuration.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> critical <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'critical'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>critical<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>	<span class="token comment">// configuration</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> output</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Generated critical CSS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>Error handling isn't mandatory, but it's an easy way to gauge the operation success in the console.</p>
<h3 id="configure-critical">Configure Critical <a class="w-headline-link" href="#configure-critical">#</a></h3>
<p>The table below contains some useful Critical options. You can check out all of the <a href="https://github.com/addyosmani/critical#usage" rel="noopener">available options on GitHub</a>.</p>
<table>
    <th>Option</th>
    <th>Type</th>
    <th>Explanation</th>
  <tr>
    <td><code>base</code></td>
    <td>string</td>
    <td>The base directory for your files.</td>
  </tr>
  <tr>
    <td><code>src</code></td>
    <td>string</td>
    <td>HTML source file.</td>
  </tr>
  <tr>
    <td><code>dest</code></td>
    <td>string</td>
    <td>The target for the output file. If CSS is inlined the output file is HTML. If not, the output is a CSS file.</td>
  </tr>
  <tr>
    <td><code>width</code>, <code>height</code></td>
    <td>numbers</td>
    <td>Viewport width and height in pixels.</td>
  </tr>
  <tr>
    <td><code>dimensions</code></td>
    <td>array</td>
    <td>Contains objects with width and height properties. These objects represent the viewports you want to target with above-the-fold CSS. If you have media queries in your CSS, this allows you to generate critical CSS that covers multiple viewport sizes.</td>
  </tr>
  <tr>
    <td><code>inline</code></td>
    <td>boolean</td>
    <td>When set to true, the generated critical CSS is inlined in the <head> of the HTML source file.</td>
  </tr>
  <tr>
    <td><code>minify</code></td>
    <td>boolean</td>
    <td>When set to true, Critical minifies the generated critical CSS. Can be omitted when extracting critical CSS for multiple resolutions because Critical automatically minifies it to avoid duplicate rule inclusion.</td>
  </tr>
</table>
<p>Below is a configuration example for extracting critical CSS for multiple resolutions. Add it to <code>critical.js</code> or play around and tweak the options.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line">critical<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><ins class="highlight-line highlight-line-add">  base<span class="token operator">:</span> <span class="token string">'public/'</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">  src<span class="token operator">:</span> <span class="token string">'./index.html'</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">  dest<span class="token operator">:</span> <span class="token string">'./index.html'</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">  inline<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">  dimensions<span class="token operator">:</span> <span class="token punctuation">[</span></ins><br><ins class="highlight-line highlight-line-add">    <span class="token punctuation">{</span></ins><br><ins class="highlight-line highlight-line-add">      height<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">      width<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">    <span class="token punctuation">}</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">    <span class="token punctuation">{</span></ins><br><ins class="highlight-line highlight-line-add">      height<span class="token operator">:</span> <span class="token number">720</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">      width<span class="token operator">:</span> <span class="token number">1280</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">    <span class="token punctuation">}</span><span class="token punctuation">,</span></ins><br><ins class="highlight-line highlight-line-add">  <span class="token punctuation">]</span></ins><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> output</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>output<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Generated critical CSS'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
</web-copy-code><p>In this example, <code>index.html</code> is both the source file and the destination file because the <code>inline</code> option is set to true. Critical first reads the HTML source file, extracts critical CSS and then overwrites <code>index.html</code> with critical CSS inlined in the <code>&lt;head&gt;</code>.</p>
<p><code>dimensions</code> array has two viewport sizes specified: 300 x 500 for extra small screens and 1280 x 720 for standard laptop screens.</p>
<p><code>minify</code> option is omitted because Critical automatically minifies the extracted CSS when there are multiple viewport sizes specified.</p>
<h3 id="run-critical">Run Critical <a class="w-headline-link" href="#run-critical">#</a></h3>
<p>Add Critical to your scripts in <code>package.json</code>:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line">scripts<span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token string">"start"</span><span class="token operator">:</span> <span class="token string">"node server.js"</span><span class="token punctuation">,</span></span><br><ins class="highlight-line highlight-line-add">  <span class="token string">"critical"</span><span class="token operator">:</span> <span class="token string">"node critical.js"</span></ins><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
</web-copy-code><ol>
<li>Click <strong>Tools</strong>.</li>
<li>Click <strong>Logs</strong>.</li>
<li>Click <strong>Console</strong>.</li>
</ol>
<p>To generate critical CSS, in the console, run:</p>
<web-copy-code><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run critical<br>refresh</code></pre>
</web-copy-code><figure class="w-figure">
  <img     alt="Success message saying &#x27;Generated critical CSS&#x27; in the console]()"          decoding="async"     height="45"          loading="lazy"     sizes="(min-width: 243px) 243px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/alfJqwxI2WU3bUOT4xUZ.png?auto=format&w=486 486w"          width="243"   />
  <figcaption class="w-figcaption">Success message in the console</figcaption>
</figure>
<div class="w-aside w-aside--note">
<p>Glitch console and editor don't automatically sync, so <code>refresh</code> command is neccessary to update the editor with files generated from the console.</p>
</div>
<p>Now in the <code>&lt;head&gt;</code> tag of <code>index.html</code>, generated critical CSS is inlined between <code>&lt;style&gt;</code> tags, followed by a script that loads the rest of the CSS asynchronously.</p>
<figure class="w-figure">
  <img     alt="index.html with inlined critical CSS"          decoding="async"     height="325"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/NEQAkJJDV712y944PAxo.png?auto=format&w=1600 1600w"          width="800"   />
  <figcaption class="w-figcaption">Inlined critical CSS</figcaption>
</figure>
<h2 id="measure-again">Measure again <a class="w-headline-link" href="#measure-again">#</a></h2>
<p>Follow the steps from the beginning of the codelab to run Lighthouse performance audit again. The results you get will look similar to this:</p>
 <img     alt="Lighthouse audit showing performance score of 100, FCP 0.9 seconds and improved filmstrip view of loading the app"     class="w-screenshot"     decoding="async"     height="407"          loading="lazy"     sizes="(min-width: 716px) 716px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/7be1SdC4JpavF7338VuT.png?auto=format&w=1432 1432w"          width="716"   />
<div class="w-aside w-aside--success">
<p><strong>Success</strong>:
The filmstrip view shows that content is rendered much sooner and this is reflected in improved paint metrics. And &quot;Eliminate render-blocking resources&quot; has been eliminated! 🎉</p>
</div>


        <div class="text-size-0 color-mid-text">
          <span>
            
            Last updated: <time>May 29, 2019</time>
            
          </span>
          —
          <a
            href="https://github.com/GoogleChrome/web.dev/blob/main/src/site/content/en/fast/codelab-extract-and-inline-critical-css/index.md"
          >
            Improve article
          </a>
        </div>

        
          
          
        

        
          <div class="flow-space-size-2">
            <a href="/extract-critical-css" class="button" data-type="secondary">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>

              <span>Return to article</span>
            </a>
          </div>
        
      </article>
    </div>
  </web-codelab>
</div>

  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
         <li class="w-footer__linkbox-item">
            <a href="https://developer.chrome.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              developer.chrome.com
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/fundamentals" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/terms/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
