
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=52b30d11c6ad6">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Minify and compress network payloads with gzip</title>
<meta name="description" content="In this codelab, learn how both minifying and compressing the JavaScript bundle for an application improves page performance by reducing the app's request size. " />

<link rel="canonical" href="https://web.dev/codelab-text-compression/" />

<meta itemprop="name" content="Minify and compress network payloads with gzip" />
<meta itemprop="description" content="In this codelab, learn how both minifying and compressing the JavaScript bundle for an application improves page performance by reducing the app's request size. " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/codelab-text-compression/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Minify and compress network payloads with gzip" />
<meta property="og:description" content="In this codelab, learn how both minifying and compressing the JavaScript bundle for an application improves page performance by reducing the app's request size. " />
<meta property="og:image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="" />
<meta property="tag" content="performance" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Minify and compress network payloads with gzip" />
<meta name="twitter:description" content="In this codelab, learn how both minifying and compressing the JavaScript bundle for an application improves page performance by reducing the app's request size. " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/vU99HKzIf5EUPnzGVPf1.png?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>







<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=91b1a624b8092', 'module');




  loadScript('/js/content.js?v=f432886e6085f', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="23" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results" i18n="{&quot;search&quot;:{&quot;en&quot;:&quot;Search&quot;},&quot;open_search&quot;:{&quot;en&quot;:&quot;Open search&quot;},&quot;all_articles&quot;:{&quot;en&quot;:&quot;All articles&quot;},&quot;close_search&quot;:{&quot;en&quot;:&quot;Close search&quot;}}"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
    
<div class="codelab-landing-page">
  
    
    
    
  
  <web-codelab class="web-codelab" glitch="fav-kitties-compress-starter"  >
    <div class="web-codelab__instructions">
      
      <article class="prose legacy-rollout">
        <header class="flow gap-bottom-size-3">

          <h1 id="minify-and-compress-network-payloads-with-gzip">Minify and compress network payloads with gzip</h1>
          

          
            <div class="flow-space-size-1 color-mid-text text-size-0">
              <time>Apr 24, 2018</time>
              
            </div>
          

          

          
            <div class="cluster flow-space-size-2">
              
                <div class="w-author">
  <a href="/authors/houssein/"><img     alt="Houssein Djirdeh"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/BibySYHD7JweNcHZCCOe.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/houssein/">Houssein Djirdeh</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/hdjirdeh"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/housseindjirdeh">GitHub</a>
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://glitch.com/@housseindjirdeh"
          >Glitch</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://houssein.me/">Blog</a>
      </li>
    </ul>
  </div>
</div>
              
            </div>
          
        </header>

        

        <div class="w-aside w-aside--note">
<p>This codelab uses Chrome DevTools.
<a href="https://www.google.com/chrome" rel="noopener">Download Chrome</a> if you don't already have it.</p>
</div>
<p>This codelab explores how both minifying and compressing the JavaScript
bundle for the following application improves page performance by reducing
the app's request size.</p>
<img     alt="App screenshot"          decoding="async"     height="535"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/Ga0pUShY7cQ0BDAPgPuh.png?auto=format&w=1600 1600w"          width="800"   />
<h2 id="measure">Measure <a class="w-headline-link" href="#measure">#</a></h2>
<div class="w-aside w-aside--note">
<p>Since webpack is used in this application, any changes made to the code will
trigger a new build which can take a few seconds. Once it completes, you should
see your changes reflected in the application.</p>
</div>
<p>Before diving in to add optimizations, it's always a good idea to first analyze
the current state of the application.</p>
<ul>
<li>To preview the site, press <strong>View¬†App</strong>. Then press
<strong>Fullscreen</strong>
<img
src="/images/glitch/fullscreen.svg"
alt="fullscreen"
style="padding: 4px 8px; opacity: .5; border: 1px solid #c3c3c3; border-radius: 5px;"
/>.</li>
</ul>
<p>This app, which was also covered in the <a href="/remove-unused-code">&quot;Remove unused
code&quot;</a> codelab, lets you vote for your favorite
kitten. üêà</p>
<p>Now take a look at how large this application is:</p>
<ol>
<li>Press `Control+Shift+J` (or `Command+Option+J` on Mac) to open DevTools.</li>
<li>Click the <strong>Network</strong> tab.</li>
<li>Select the <strong>Disable cache</strong> checkbox.</li>
<li>Reload the app.</li>
</ol>
<img     alt="Original bundle size in Network panel"     class="w-screenshot"     decoding="async"     height="186"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/Zzm8kiE2W29yGEZC7C2u.png?auto=format&w=1600 1600w"          width="800"   />
<p>Although a lot of progress was made in the <a href="/remove-unused-code">&quot;Remove unused code&quot;</a>
codelab to trim this bundle size down, 225 KB is still quite large.</p>
<h2 id="minification">Minification <a class="w-headline-link" href="#minification">#</a></h2>
<p>Consider the following block of code.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">soNice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">while</span> <span class="token punctuation">(</span>counter <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nice'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    counter<span class="token operator">++</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>If this function is saved in a file of its own, the file size is around
<strong>112 B (bytes).</strong></p>
<p>If all whitespace is removed, the resulting code looks like this:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">soNice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">let</span> counter<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>counter<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"nice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>counter<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>The file size would now be around 83 B. If it gets further mangled by reducing
the length of variable name and modifying some expressions, the final code may
end up looking like this:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">soNice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">;</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"nice"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>i<span class="token operator">++</span><span class="token punctuation">}</span></code></pre>
</web-copy-code><p>The file size now reaches <strong>62 B</strong>.</p>
<p>With each step, the code is becoming harder to read. However, the browser's
JavaScript engine interprets each of these in the exact same way. The
benefit of obfuscating code in this manner can help achieve smaller file
sizes. 112 B really was not much to begin with, but there was still a 50%
reduction in size!</p>
<p>In this application, <a href="https://webpack.js.org/" rel="noopener">webpack</a> version 4 is used as a
module bundler. The specific version can be seen in <code>package.json</code>.</p>
<web-copy-code><pre class="language-json"><code class="language-json"><span class="highlight-line"><span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">//...</span></span><br><mark class="highlight-line highlight-line-active">  <span class="token property">"webpack"</span><span class="token operator">:</span> <span class="token string">"^4.16.4"</span><span class="token punctuation">,</span></mark><br><span class="highlight-line">  <span class="token comment">//...</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
</web-copy-code><p>Version 4 already minifies the bundle by default during production mode. It uses
<code>TerserWebpackPlugin</code> a plugin for <a href="https://github.com/terser-js/terser" rel="noopener">Terser</a>.
Terser is a popular tool used to compress JavaScript code.</p>
<p>To get an idea of what the minified code looks like, go ahead and click
<code>main.bundle.js</code> while still in the DevTools <strong>Network</strong> panel. Now click the
<strong>Response</strong> tab.</p>
<img     alt="Minified response"     class="w-screenshot"     decoding="async"     height="249"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/uti2q15O2MtiEsegYoV9.png?auto=format&w=1600 1600w"          width="800"   />
<p>The code in its final form, minified and mangled, is shown in the response body.
To find out how large the bundle may have been if it was not minified, open
<code>webpack.config.js</code> and update the <code>mode</code> configuration.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><del class="highlight-line highlight-line-remove">  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span></del><br><ins class="highlight-line highlight-line-add">  mode<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span></ins><br><span class="highlight-line">  <span class="token comment">//...</span></span></code></pre>
</web-copy-code><p>Reload the application and take a look at the bundle size again through the
DevTools <strong>Network</strong> panel</p>
<img     alt="Bundle size of 767 KB"     class="w-screenshot"     decoding="async"     height="129"          loading="lazy"     sizes="(min-width: 700px) 700px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/H0lINRmM2gF6NHnzmkGM.png?auto=format&w=1400 1400w"          width="700"   />
<p>That's a pretty big difference! üòÖ</p>
<p>Make sure to revert the changes here before continuing.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><ins class="highlight-line highlight-line-add">  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span></ins><br><del class="highlight-line highlight-line-remove">  mode<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span></del><br><span class="highlight-line">  <span class="token comment">//...</span></span></code></pre>
</web-copy-code><p>Including a process to minify code in your application depends on the tools
that you use:</p>
<ul>
<li>If webpack v4 or greater is used, no additional work needs to be done
since code is minified by default in production mode. üëç</li>
<li>If an older version of webpack is used, install and include <code>TerserWebpackPlugin</code>
into the webpack build process. The <a href="https://webpack.js.org/plugins/terser-webpack-plugin/" rel="noopener">documentation</a>
explains this in detail.</li>
<li>Other minification plugins also exist and can be used instead,
such as <a href="https://github.com/webpack-contrib/babel-minify-webpack-plugin" rel="noopener">BabelMinifyWebpackPlugin</a>
and <a href="https://github.com/roman01la/webpack-closure-compiler" rel="noopener">ClosureCompilerPlugin</a>.</li>
<li>If a module bundler is not being used at all, use <a href="https://github.com/terser-js/terser" rel="noopener">Terser</a>
as a CLI tool or include it directly as a dependency.</li>
</ul>
<h2 id="compression">Compression <a class="w-headline-link" href="#compression">#</a></h2>
<div class="w-aside w-aside--warning">
<p><strong>Warning</strong>:
Many hosting platforms, CDNs and reverse proxy servers either encode
assets with compression by default or allow you to easily configure them. This
means that you may rarely ever need to set up your server similar to how it is
done in the compression section of this tutorial, but you can continue to read
if you are interested in learning how compression works.</p>
</div>
<p>Although the term &quot;compression&quot; is sometimes loosely used to explain how code is
reduced during the minification process, it isn't actually compressed in the
literal sense.</p>
<p><strong>Compression</strong> usually refers to code that has been modified using a data
compression algorithm. Unlike minification which ends up providing perfectly
valid code, compressed code needs to be <em>decompressed</em> before being used.</p>
<p>With every HTTP request and response, browsers and web servers can add
<a href="https://developer.mozilla.org/docs/Web/HTTP/Headers" rel="noopener">headers</a> to include
additional information about the asset being fetched or received. This can be
seen in the <code>Headers</code> tab within the DevTools Network panel where three types
are shown:</p>
<ul>
<li><strong>General</strong> represents general headers relevant to the entire request-response
interaction.</li>
<li><strong>Response Headers</strong> shows a list of headers specific to the actual response
from the server.</li>
<li><strong>Request Headers</strong> shows a list of headers attached to the request by the
client.</li>
</ul>
<p>Take a look at the <code>accept-encoding</code> header in the <code>Request Headers</code>.</p>
<img     alt="Accept encoding header"     class="w-screenshot"     decoding="async"     height="361"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/shmaD9cmjjFMITKL0TAW.png?auto=format&w=1600 1600w"          width="800"   />
<p><code>accept-encoding</code> is used by the browser to specify which content
encoding formats, or compression algorithms, it supports. There are many
text-compression algorithms out there, but there are only three that are
supported here for the compression (and decompression) of HTTP network requests:</p>
<ul>
<li><a href="https://www.gzip.org/" rel="noopener">Gzip</a> (<code>gzip</code>): The most widely used compression
format for server and client interactions. It builds on top of the Deflate
algorithm and is supported in all current browsers.</li>
<li>Deflate (<code>deflate</code>): Not commonly used.</li>
<li><a href="https://github.com/google/brotli" rel="noopener">Brotli</a> (<code>br</code>): A newer compression
algorithm that aims to further improve compression ratios, which can result in
even faster page loads. It is supported in the
<a href="https://caniuse.com/#feat=brotli" rel="noopener">latest versions of most browsers</a>.</li>
</ul>
<p>The sample application in this tutorial is identical to the app completed in the
<a href="/remove-unused-code">&quot;Remove unused code&quot;</a> codelab except for the fact that
<a href="https://expressjs.com/" rel="noopener">Express</a> is now used as a server framework. In the next
few sections, both static and dynamic compression is explored.</p>
<h2 id="dynamic-compression">Dynamic compression <a class="w-headline-link" href="#dynamic-compression">#</a></h2>
<p><strong>Dynamic</strong> compression involves compressing assets on-the-fly as they get
requested by the browser.</p>
<h3 id="pros">Pros <a class="w-headline-link" href="#pros">#</a></h3>
<ul>
<li>Creating and updating saved compressed versions of assets does not need to be
done.</li>
<li>Compressing on-the-fly works especially well for web pages that are
dynamically generated.</li>
</ul>
<h3 id="cons">Cons <a class="w-headline-link" href="#cons">#</a></h3>
<ul>
<li>Compressing files at higher levels to achieve better compression ratios
takes longer. This can cause a performance hit as the user waits for assets to
compress before they are sent by the server.</li>
</ul>
<h3 id="dynamic-compression-with-nodeexpress">Dynamic compression with Node/Express <a class="w-headline-link" href="#dynamic-compression-with-nodeexpress">#</a></h3>
<p>The <code>server.js</code> file is responsible for setting up the Node server that hosts
the application.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> listener <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Your app is listening on port '</span> <span class="token operator">+</span> listener<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>All this currently does is import <code>express</code> and use the <code>express.static</code>
middleware to load all the static HTML, JS and CSS files in the
<code>public/</code> directory (and those files are created by webpack with every build).</p>
<p>To make sure all of the assets are compressed every time they're requested, the
<a href="https://github.com/expressjs/compression" rel="noopener">compression</a> middleware library can
be used. Begin by adding it as a <code>devDependency</code> in <code>package.json</code>:</p>
<web-copy-code><pre class="language-json"><code class="language-json"><span class="highlight-line"><span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">//...</span></span><br><mark class="highlight-line highlight-line-active">  <span class="token property">"compression"</span><span class="token operator">:</span> <span class="token string">"^1.7.3"</span></mark><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">,</span></span></code></pre>
</web-copy-code><p>And import it into the server file, <code>server.js</code>:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><mark class="highlight-line highlight-line-active"><span class="token keyword">const</span> compression <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'compression'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></mark></code></pre>
</web-copy-code><p>And add it as a middleware <strong>before</strong> <code>express.static</code> is mounted:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">//...</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><mark class="highlight-line highlight-line-active">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">compression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><span class="highlight-line"></span><br><span class="highlight-line">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">//...</span></span></code></pre>
</web-copy-code><p>Now reload the app and take a look at the bundle size in the <strong>Network</strong> panel.</p>
<img     alt="Bundle size with dynamic compression"     class="w-screenshot"     decoding="async"     height="161"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/MMtTKWPKfht8RYd8BMYF.png?auto=format&w=1600 1600w"          width="800"   />
<p>From 225 KB to 61.6 KB! In the <code>Response Headers</code> now, a <code>content-encoding</code>
header shows that the server is sending down this file encoded with <code>gzip</code>.</p>
<img     alt="Content encoding header"     class="w-screenshot"     decoding="async"     height="470"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/523FjNSQOK95lGzg0B6D.png?auto=format&w=1600 1600w"          width="800"   />
<h2 id="static-compression">Static compression <a class="w-headline-link" href="#static-compression">#</a></h2>
<p>The idea behind <strong>static</strong> compression is to have assets compressed and saved
ahead of time.</p>
<h3 id="pros-2">Pros <a class="w-headline-link" href="#pros-2">#</a></h3>
<ul>
<li>Latency due to high compression levels is not a concern anymore.
Nothing needs to happen on-the-fly to compress files as they can now be fetched directly.</li>
</ul>
<h3 id="cons-2">Cons <a class="w-headline-link" href="#cons-2">#</a></h3>
<ul>
<li>Assets need to compressed with every build. Build times can increase
significantly if high compression levels are used.</li>
</ul>
<h3 id="static-compression-with-nodeexpress-and-webpack">Static compression with Node/Express and webpack <a class="w-headline-link" href="#static-compression-with-nodeexpress-and-webpack">#</a></h3>
<p>Since static compression involves compressing files ahead of time, webpack
settings can be modified to compress assets as part of the build step.
<a href="https://github.com/webpack-contrib/compression-webpack-plugin" rel="noopener"><code>CompressionPlugin</code></a>
can be used for this.</p>
<p>Begin by adding it as a <code>devDependency</code> in <code>package.json</code>:</p>
<web-copy-code><pre class="language-json"><code class="language-json"><span class="highlight-line"><span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">//...</span></span><br><mark class="highlight-line highlight-line-active">  <span class="token property">"compression-webpack-plugin"</span><span class="token operator">:</span> <span class="token string">"^1.1.11"</span></mark><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">,</span></span></code></pre>
</web-copy-code><p>Like any other webpack plugin, import it in the configurations file,
<code>webpack.config.js:</code></p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token comment">//...</span></span><br><span class="highlight-line"></span><br><mark class="highlight-line highlight-line-active"><span class="token keyword">const</span> CompressionPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"compression-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></mark></code></pre>
</web-copy-code><p>And include it within the <code>plugins</code> array:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="highlight-line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">//...</span></span><br><span class="highlight-line">  plugins<span class="token operator">:</span> <span class="token punctuation">[</span></span><br><span class="highlight-line">    <span class="token comment">//...</span></span><br><mark class="highlight-line highlight-line-active">    <span class="token keyword">new</span> <span class="token class-name">CompressionPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span></mark><br><span class="highlight-line">  <span class="token punctuation">]</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
</web-copy-code><p>By default, the plugin compresses the build files using <code>gzip</code>. Take a look
at the <a href="https://github.com/webpack-contrib/compression-webpack-plugin" rel="noopener">documentation</a>
to learn how to add options to use a different algorithm or include/exclude
certain files.</p>
<p>When the app reloads and rebuilds, a compressed version of the main bundle is
now created. Open the Glitch Console to take a look at what's inside the
final <code>public/</code> directory that's served by the Node server.</p>
<div class="w-aside w-aside--note">
<p>The <code>public/</code> directory is included in the <code>.gitignore</code> file. Directories that
contain build files are usually included here in order to be ignored by Git, and
Glitch also hides these files from the editor tree.</p>
</div>
<ul>
<li>Click the <strong>Tools</strong> button.</li>
<li>Click the <strong>Console</strong> button.</li>
<li>In the console, run the following commands to change into the <code>public</code>
directory and see all of its files:</li>
</ul>
<web-copy-code><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">cd</span> public<br><span class="token function">ls</span></code></pre>
</web-copy-code><img     alt="Final outputted files in public directory"     class="w-screenshot"     decoding="async"     height="188"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/YQwCT87xMfMwWiH63lTS.png?auto=format&w=1600 1600w"          width="800"   />
<p>The gzipped version of the bundle, <code>main.bundle.js.gz</code>, is now saved here as
well. <code>CompressionPlugin</code> also compresses <code>index.html</code> by default.</p>
<p>The next thing that needs to be done is tell the server to send these gzipped
files whenever their original JS versions are being requested. This can be done
by defining a new route in <code>server.js</code> before the files are served with
<code>express.static</code>.</p>
<pre>
const express = require('express');
const app = express();

<strong>app.get('*.js', (req, res, next) => {
  req.url = req.url + '.gz';
  res.set('Content-Encoding', 'gzip');
  next();
});</strong>

app.use(express.static('public'));

//...
</pre>
<p><code>app.get</code> is used to tell the server how to respond to a GET request for a
specific endpoint. A callback function is then used to define how to handle this
request. The route works like this:</p>
<ul>
<li>Specifying <code>'*.js'</code> as the first argument means that this works for every
endpoint that is fired to fetch a JS file.</li>
<li>Within the callback, <code>.gz</code> is attached to the URL of the request and the
<code>Content-Encoding</code> response header is set to <code>gzip</code>.</li>
<li>Finally, <code>next()</code> ensures that the sequence continues to any callback
that may be next.</li>
</ul>
<p>Once the app reloads, take a look at the <code>Network</code> panel once more.</p>
<img     alt="Bundle size reduction with static compression"     class="w-screenshot"     decoding="async"     height="176"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/b7xYRsSdNhWX5Lc8zE51.png?auto=format&w=1600 1600w"          width="800"   />
<p>Just like before, a significant reduction in bundle size!</p>
<h2 id="conclusion">Conclusion <a class="w-headline-link" href="#conclusion">#</a></h2>
<p>This codelab covered the process of minifying and compressing source code.
Both these techniques are becoming a default in many of the tools
available today, so it's important to find out whether your toolchain already
supports them or if you should begin applying both processes yourself.</p>


        <div class="text-size-0 color-mid-text">
          <span>
            
            Last updated: <time>Apr 24, 2018</time>
            
          </span>
          ‚Äî
          <a
            href="https://github.com/GoogleChrome/web.dev/blob/main/src/site/content/en/fast/codelab-text-compression/index.md"
          >
            Improve article
          </a>
        </div>

        
          
          
        

        
          <div class="flow-space-size-2">
            <a href="/reduce-network-payloads-using-text-compression" class="button" data-type="secondary">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>

              <span>Return to article</span>
            </a>
          </div>
        
      </article>
    </div>
  </web-codelab>
</div>

  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
         <li class="w-footer__linkbox-item">
            <a href="https://developer.chrome.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              developer.chrome.com
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/fundamentals" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/terms/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
