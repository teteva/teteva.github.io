
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
    <link rel="stylesheet" href="/css/main.css?v=1b715e5cd20ff">
  

  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Security headers quick reference</title>
<meta name="description" content="This article lists the most important security headers you can use to protect your website. Use it to understand web-based security features, learn how to implement them on your website, and as a reference for when you need a reminder. " />

<link rel="canonical" href="https://web.dev/security-headers/" />

<meta itemprop="name" content="Security headers quick reference" />
<meta itemprop="description" content="This article lists the most important security headers you can use to protect your website. Use it to understand web-based security features, learn how to implement them on your website, and as a reference for when you need a reminder. " />
<meta itemprop="image" content="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/security-headers/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Security headers quick reference" />
<meta property="og:description" content="This article lists the most important security headers you can use to protect your website. Use it to understand web-based security features, learn how to implement them on your website, and as a reference for when you need a reminder. " />
<meta property="og:image" content="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="A keylock in front of compressed code" />
<meta property="tag" content="security" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Security headers quick reference" />
<meta name="twitter:description" content="This article lists the most important security headers you can use to protect your website. Use it to understand web-based security features, learn how to implement them on your website, and as a reference for when you need a reminder. " />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>







<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=543c5c55e5aed', 'module');




  loadScript('/js/content.js?v=4a63d00a5deb6', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    



<web-header class="header-default" role="navigation">
  <button data-open-drawer-button class="w-button--svg w-button--round" aria-label="Open menu">
    








  










  <svg class="icon " role="img" aria-label="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>


    <span class="w-tooltip w-tooltip--left">Open menu</span>
  </button>

  <a
    href="/"
    class="header-default__logo-link gc-analytics-event"
    data-category="Site-Wide Custom Events"
    data-label="Site logo"
  >
    <img class="header-default__logo" width="125" height="23" src="/images/lockup.svg" alt="web.dev" />
  </a>

  <div class="header-default__middle">
    <div class="header-default__links">
      <a
        href="/learn/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
      >
        Learn
      </a>

      <a
        href="/measure/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
      >
        Measure
      </a>

      <a
        href="/blog/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
      >
        Blog
      </a>

      <a
        href="/about/"
        class="header-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About"
      >
        About
      </a>
    </div>
    <web-search results-id="search-main-results" i18n="{&quot;search&quot;:{&quot;en&quot;:&quot;Search&quot;},&quot;open_search&quot;:{&quot;en&quot;:&quot;Open search&quot;},&quot;all_articles&quot;:{&quot;en&quot;:&quot;All articles&quot;},&quot;close_search&quot;:{&quot;en&quot;:&quot;Close search&quot;}}"></web-search>
    <web-search-results id="search-main-results"></web-search-results>
  </div>

  <web-profile-switcher-container></web-profile-switcher-container>
</web-header>



<web-navigation-drawer class="drawer-default" type="modal">
  <nav data-drawer-container>
    <div class="drawer-default__contents">
      <div class="drawer-default__header">
        <button
          data-drawer-close-button
          class="drawer-default__hide w-button--svg w-button--round"
          aria-label="Close"
        >
          








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


          <span class="w-tooltip">Close</span>
        </button>
        <a
          href="/"
          class="gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Site logo"
        >
          <img
            width="125"
            height="30"
            class="drawer-default__logo"
            src="/images/lockup.svg"
            alt="web.dev"
          />
        </a>
      </div>
      <a
        href="/learn/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Learn"
      >
        Learn
      </a>
      <a
        href="/measure/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Measure"
      >
        Measure
      </a>
      <a
        href="/blog/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: Blog"
      >
        Blog
      </a>
      <a
        href="/about/"
        class="drawer-default__link gc-analytics-event"
        data-category="Site-Wide Custom Events"
        data-label="SideNav: About"
      >
        About
      </a>
    </div>
  </nav>
</web-navigation-drawer>

<main>
  <div id="content">
    
      
    
    


<div class="guide-landing-page">
  
    
    
    
  
  

  
    <img     alt="A keylock in front of compressed code"     class="w-hero w-hero--cover"     decoding="auto"     height="480"               sizes="100vw"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/E3BVnrBFNV6w2Uqxn3bQ.jpg?auto=format&w=1600 1600w"          width="1600"   />
  

  <web-table-of-contents>
    <h2 class="w-toc__header">
      <a href="#security-headers-quick-reference" class="w-toc__header--link">
        Security headers quick reference
      </a>
    </h2>
    <div class="w-toc__list">
        <ul><li><a href="#protect-your-site-from-injection-vulnerabilities">Protect your site from injection vulnerabilities</a></li><li><a href="#csp">Content Security Policy (CSP)</a></li><li><a href="#isolate-your-site-from-other-websites">Isolate your site from other websites</a></li><li><a href="#tt">Trusted Types</a></li><li><a href="#build-a-powerful-website-securely">Build a powerful website securely</a></li><li><a href="#xcto">X-Content-Type-Options</a></li><li><a href="#encrypt-traffic-to-your-site">Encrypt traffic to your site</a></li><li><a href="#xfo">X-Frame-Options</a></li><li><a href="#recommended-usages">Recommended usages</a></li><li><a href="#corp">Cross-Origin Resource Policy (CORP)</a></li><li><a href="#supported-browsers">Supported browsers</a></li><li><a href="#coop">Cross-Origin Opener Policy (COOP)</a></li><li><a href="#other-things-to-note-about-csp">Other things to note about CSP</a></li><li><a href="#cors">Cross-Origin Resource Sharing (CORS)</a></li><li><a href="#learn-more">Learn more</a></li><li><a href="#coep">Cross-Origin Embedder Policy (COEP)</a></li><li><a href="#recommended-usages-2">Recommended usages</a></li><li><a href="#hsts">HTTP Strict Transport Security (HSTS)</a></li><li><a href="#supported-browsers-2">Supported browsers</a></li><li><a href="#further-reading">Further reading</a></li><li><a href="#learn-more-2">Learn more</a></li><li><a href="#recommended-usages-3">Recommended usages</a></li><li><a href="#supported-browsers-3">Supported browsers</a></li><li><a href="#learn-more-3">Learn more</a></li><li><a href="#recommended-usages-4">Recommended usages</a></li><li><a href="#supported-browsers-4">Supported browsers</a></li><li><a href="#learn-more-4">Learn more</a></li><li><a href="#recommended-usages-5">Recommended usages</a></li><li><a href="#supported-browsers-5">Supported browsers</a></li><li><a href="#learn-more-5">Learn more</a></li><li><a href="#recommended-usages-6">Recommended usages</a></li><li><a href="#supported-browsers-6">Supported browsers</a></li><li><a href="#learn-more-6">Learn more</a></li><li><a href="#recommended-usages-7">Recommended usages</a></li><li><a href="#supported-browsers-7">Supported browsers</a></li><li><a href="#learn-more-7">Learn more</a></li><li><a href="#example-usages">Example usages</a></li><li><a href="#supported-browsers-8">Supported browsers</a></li><li><a href="#learn-more-8">Learn more</a></li><li><a href="#recommended-usages-8">Recommended usages</a></li><li><a href="#supported-browsers-9">Supported browsers</a></li><li><a href="#learn-more-9">Learn more</a></li></ul></div>
  </web-table-of-contents>
  <web-table-of-contents-button></web-table-of-contents-button>

  
  <div class="w-actions">
    <share-action authors="@agektmr | @maudnals | @arturjanc"
      class="gc-analytics-event w-actions__fab w-actions__fab--share"
      data-category="web.dev"
      data-label="share"
      data-action="click"
      data-icon="share"
      tabindex="0"
      role="button"
    >
      <span>Share</span>
    </share-action>
    
    
  </div>

  <div class="w-layout-container--narrow w-post-content">
    <header class="w-article-header">
      
        
        <div class="w-post-breadcrumbs">
          <ul class="w-breadcrumbs">
  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link w-breadcrumbs__link--left-justify gc-analytics-event"
      data-category="web.dev"
      data-label="post, home breadcrumb"
      data-action="click"
      href="/"
    >
      Home
    </a>
  </li>

  <svg
    class="w-breadcrumbs__icon"
    xmlns="http://www.w3.org/2000/svg"
    height="24"
    viewBox="0 0 24 24"
    width="24"
    aria-hidden="true"
  >
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z" />
  </svg>

  <li class="w-breadcrumbs__crumb">
    <a
      class="w-breadcrumbs__link gc-analytics-event"
      data-category="web.dev"
      data-label="post, path breadcrumb"
      data-action="click"
      href=/blog
    >
      All articles
    </a>
  </li>
</ul>
        </div>
      

      <h1 id="security-headers-quick-reference" class="w-article-header__headline">Security headers quick reference</h1>
      
        <p class="w-article-header__subhead w-mb--non">
          Learn more about headers that can keep your site safe and quickly look up the most important details.
        </p>
      

      
        <div class="w-author__published">
          <time>May 18, 2021</time>
           <span class="w-author__separator">•</span> Updated <time>Aug 5, 2021</time> 
        </div>
      

      
      

      <div class="w-layout-container--narrow w-post-signpost">
  <span class="w-post-signpost__title">
    Appears in:
  </span>
  <a
          class="w-post-signpost__link"
          href="/secure"
          >Safe and secure</a
        >
</div>

      
        <div class="w-authors w-mt--xl w-pt--sm">
          
            <div class="w-author">
  <a href="/authors/agektmr/"><img     alt="Eiji Kitamura"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/Mh9DRmQhjlroJM9JDqsu.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/Mh9DRmQhjlroJM9JDqsu.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/Mh9DRmQhjlroJM9JDqsu.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/Mh9DRmQhjlroJM9JDqsu.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/Mh9DRmQhjlroJM9JDqsu.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/Mh9DRmQhjlroJM9JDqsu.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/agektmr/">Eiji Kitamura</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/agektmr"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/agektmr">GitHub</a>
      </li>
      
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://blog.agektmr.com">Blog</a>
      </li>
    </ul>
  </div>
</div>
          
            <div class="w-author">
  <a href="/authors/maudn/"><img     alt="Maud Nalpas"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/O2RNUyVSLubjvENAT3e7JSdqSOx1/9ORwve80jFiyYnPvNcWF.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/O2RNUyVSLubjvENAT3e7JSdqSOx1/9ORwve80jFiyYnPvNcWF.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/O2RNUyVSLubjvENAT3e7JSdqSOx1/9ORwve80jFiyYnPvNcWF.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/O2RNUyVSLubjvENAT3e7JSdqSOx1/9ORwve80jFiyYnPvNcWF.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/O2RNUyVSLubjvENAT3e7JSdqSOx1/9ORwve80jFiyYnPvNcWF.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/O2RNUyVSLubjvENAT3e7JSdqSOx1/9ORwve80jFiyYnPvNcWF.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/maudn/">Maud Nalpas</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/maudnals"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/maudnals">GitHub</a>
      </li>
      
      
    </ul>
  </div>
</div>
          
            <div class="w-author">
  <a href="/authors/arturjanc/"><img     alt="Artur Janc"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/hwvmzV4b6VQpTNrNF3wK.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/hwvmzV4b6VQpTNrNF3wK.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/hwvmzV4b6VQpTNrNF3wK.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/hwvmzV4b6VQpTNrNF3wK.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/hwvmzV4b6VQpTNrNF3wK.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/hwvmzV4b6VQpTNrNF3wK.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /></a>
  <div
    class="w-author__info"
    style="display: flex; flex-direction: column; justify-content: center;"
  >
    <cite class="w-author__name">
      <a class="w-author__name-link" href="/authors/arturjanc/">Artur Janc</a>
    </cite>
    <ul class="w-author__link-list">
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://twitter.com/arturjanc"
          >Twitter</a
        >
      </li>
      <li class="w-author__link-listitem">
        <a class="w-author__link" href="https://github.com/arturjanc">GitHub</a>
      </li>
      
      
    </ul>
  </div>
</div>
          
        </div>
      
    </header>

    

    <p>This article lists the most important security headers you can use to protect
your website. Use it to understand web-based security features, learn how to
implement them on your website, and as a reference for when you need a reminder.</p>
<dl>
<dt>Security headers recommended for websites that handle sensitive user data:</dt>
<dd><a href="#csp">Content Security Policy (CSP)</a></dd>
<dd><a href="#tt">Trusted Types</a></dd>
<dt>Security headers recommended for all websites:</dt>
<dd><a href="#xcto">X-Content-Type-Options</a></dd>
<dd><a href="#xfo">X-Frame-Options</a></dd>
<dd><a href="#corp">Cross-Origin Resource Policy (CORP)</a></dd>
<dd><a href="#coop">Cross-Origin Opener Policy (COOP)</a></dd>
<dd><a href="#hsts">HTTP Strict Transport Security (HSTS)</a></dd>
<dt>Security headers for websites with advanced capabilities:</dt>
<dd><a href="#cors">Cross-Origin Resource Sharing (CORS)</a></dd>
<dd><a href="#coep">Cross-Origin Embedder Policy (COEP)</a></dd>
</dl>
<details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    Known threats on the web
  </h2>
  <p class="w-details__preview"> Before diving into security headers, learn about known threats on the web and why you'd want to use these security headers.</p>
</summary>
<p>Before diving into security headers, learn about known threats on the web
and why you'd want to use these security headers.</p>
<h3 id="protect-your-site-from-injection-vulnerabilities">Protect your site from injection vulnerabilities <a class="w-headline-link" href="#protect-your-site-from-injection-vulnerabilities">#</a></h3>
<p>Injection vulnerabilities arise when untrusted data processed by your
application can affect its behavior and, commonly, lead to the execution of
attacker-controlled scripts. The most common vulnerability caused by injection
bugs is <a href="https://portswigger.net/web-security/cross-site-scripting" rel="noopener">cross-site
scripting</a> (XSS) in
its various forms, including <a href="https://portswigger.net/web-security/cross-site-scripting/reflected" rel="noopener">reflected
XSS</a>,
<a href="https://portswigger.net/web-security/cross-site-scripting/stored" rel="noopener">stored XSS</a>,
<a href="https://portswigger.net/web-security/cross-site-scripting/dom-based" rel="noopener">DOM-based
XSS</a>, and
other variants.</p>
<p>An XSS vulnerability can typically give an attacker complete access to user data
processed by the application and any other information hosted in the same <a href="/same-site-same-origin/#origin">web
origin</a>.</p>
<p>Traditional defenses against injections include consistent use of autoescaping
HTML template systems, avoiding the use of <a href="https://domgo.at/cxss/sinks" rel="noopener">dangerous JavaScript
APIs</a>, and properly processing user data by hosting
file uploads in a separate domain and sanitizing user-controlled HTML.</p>
<ul>
<li>Use <a href="#csp">Content Security Policy (CSP)</a> to control which scripts can be
executed by your application to mitigate the risk of injections.</li>
<li>Use <a href="#tt">Trusted Types</a> to enforce sanitization of data passed into dangerous
JavaScript APIs.</li>
<li>Use <a href="#xcto">X-Content-Type-Options</a> to prevent the browser from
misinterpreting the MIME types of your website's resources, which can lead to
script execution.</li>
</ul>
<h3 id="isolate-your-site-from-other-websites">Isolate your site from other websites <a class="w-headline-link" href="#isolate-your-site-from-other-websites">#</a></h3>
<p>The openness of the web allows websites to interact with each other in ways that
can violate an application's security expectations. This includes unexpectedly
making authenticated requests or embedding data from another application in the
attacker's document, allowing the attacker to modify or read application data.</p>
<p>Common vulnerabilities that undermine web isolation include
<a href="https://portswigger.net/web-security/clickjacking" rel="noopener">clickjacking</a>, <a href="https://portswigger.net/web-security/csrf" rel="noopener">cross-site
request forgery</a> (CSRF), <a href="https://www.scip.ch/en/?labs.20160414" rel="noopener">cross-site
script inclusion</a> (XSSI), and various
<a href="https://xsleaks.dev" rel="noopener">cross-site leaks</a>.</p>
<ul>
<li>Use <a href="#xfo">X-Frame-Options</a> to prevent your documents from being embedded by a
malicious website.</li>
<li>Use <a href="#corp">Cross-Origin Resource Policy (CORP)</a> to prevent your website's
resources from being included by a cross-origin website.</li>
<li>Use <a href="#coop">Cross-Origin Opener Policy (COOP)</a> to protect your website's
windows from interactions by malicious websites.</li>
<li>Use <a href="#cors">Cross-Origin Resource Sharing (CORS)</a> to control access to your
website's resources from cross-origin documents.</li>
</ul>
<p><a href="https://www.w3.org/TR/post-spectre-webdev/" rel="noopener">Post-Spectre Web
Development</a> is a great read
if you are interested in these headers.</p>
<h3 id="build-a-powerful-website-securely">Build a powerful website securely <a class="w-headline-link" href="#build-a-powerful-website-securely">#</a></h3>
<p><a href="https://ieeexplore.ieee.org/document/8835233" rel="noopener">Spectre</a> puts any data loaded
into the same <a href="/why-coop-coep/">browsing context group</a> potentially readable
despite <a href="/same-origin-policy/">same-origin policy</a>. Browsers restrict features
that may possibly exploit the vulnerability behind a special environment called
&quot;<a href="/coop-coep/">cross-origin isolation</a>&quot;. With cross-origin isolation, you can
use powerful features such as <code>SharedArrayBuffer</code>.</p>
<ul>
<li>Use <a href="#coep">Cross-Origin Embedder Policy (COEP)</a> along with <a href="#coop">COOP</a> to
enable cross-origin isolation.</li>
</ul>
<h3 id="encrypt-traffic-to-your-site">Encrypt traffic to your site <a class="w-headline-link" href="#encrypt-traffic-to-your-site">#</a></h3>
<p>Encryption issues appear when an application does not fully encrypt data in
transit, allowing eavesdropping attackers to learn about the user's interactions
with the application.</p>
<p>Insufficient encryption can arise in the following cases: not using HTTPS,
<a href="/what-is-mixed-content/">mixed content</a>, setting cookies without the <a href="https://developer.mozilla.org/docs/Web/HTTP/Cookies#restrict_access_to_cookies" rel="noopener"><code>Secure</code>
attribute</a>
(or <a href="https://developer.mozilla.org/docs/Web/HTTP/Cookies#Cookie_prefixes" rel="noopener"><code>__Secure</code>
prefix</a>),
or <a href="https://blog.detectify.com/2018/04/26/cors-misconfigurations-explained/" rel="noopener">lax CORS validation
logic</a>.</p>
<ul>
<li>Use <a href="#hsts">HTTP Strict Transport Security (HSTS)</a> to consisitently serve your
contents through HTTPS.</li>
</ul>
</details>
<h2 id="csp">Content Security Policy (CSP) <a class="w-headline-link" href="#csp">#</a></h2>
<p><a href="https://www.google.com/about/appsecurity/learning/xss/" rel="noopener">Cross-Site Scripting
(XSS)</a> is an attack
where a vulnerability on a website allows a malicious script to be injected and
executed.</p>
<p><code>Content-Security-Policy</code> provides an added layer to mitigate XSS attacks by
restricting which scripts can be executed by the page.</p>
<p>It's recommended that you enable strict CSP using one of the following approaches:</p>
<ul>
<li>If you render your HTML pages on the server, use <strong>a nonce-based strict CSP</strong>.</li>
<li>If your HTML has to be served statically or cached, for example if it's a
single-page application, use <strong>a hash-based strict CSP</strong>.</li>
</ul>
<p class="w-label">Example usage: A nonce-based CSP</p>
<web-copy-code><pre class="language-http"><code class="language-http">Content-Security-Policy:<br>  script-src 'nonce-{RANDOM1}' 'strict-dynamic' https: 'unsafe-inline';<br>  object-src 'none';<br>  base-uri 'none';</code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use CSP
  </h2>
</summary>
<h3 id="recommended-usages">Recommended usages <a class="w-headline-link" href="#recommended-usages">#</a></h3>
<div class="w-aside w-aside--note">
<p>A CSP can be an <em>extra</em> protection against XSS attacks; you should still make
sure to escape (and sanitize) user input.</p>
</div>
<h4 id="nonce-based-csp">1. Use a nonce-based strict CSP <a class="w-headline-link" href="#nonce-based-csp">#</a></h4>
<p>If you render your HTML pages on the server, use <strong>a nonce-based strict CSP</strong>.</p>
<div class="w-aside w-aside--caution">
<p><strong>Caution</strong>:</p>
<p>A nonce is a random number used only once. A nonce-based CSP is only secure if
you can generate a different nonce for each response. If you can't do this, use
<a href="#hash-based-csp">a hash-based CSP</a> instead.</p>
</div>
<p>Generate a new script nonce value for every request on the server side and set
the following header:</p>
<p class="w-label">server configuration file</p>
<web-copy-code><pre class="language-http"><code class="language-http">Content-Security-Policy:<br>  script-src 'nonce-{RANDOM1}' 'strict-dynamic' https: 'unsafe-inline';<br>  object-src 'none';<br>  base-uri 'none';</code></pre>
</web-copy-code><p>In HTML, in order to load the scripts, set the <code>nonce</code> attribute of all
<code>&lt;script&gt;</code> tags to the same <code>{RANDOM1}</code> string.</p>
<p class="w-label">index.html</p>
<web-copy-code><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nonce</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{RANDOM1}<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.com/script1.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nonce</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{RANDOM1}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br>  <span class="token comment">// Inline scripts can be used with the `nonce` attribute.</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre>
</web-copy-code><p><a href="https://photos.google.com/" rel="noopener">Google Photos</a> is a good nonce-based strict CSP
example. Use DevTools to see how it's used.</p>
<h4 id="hash-based-csp">2. Use a hash-based strict CSP <a class="w-headline-link" href="#hash-based-csp">#</a></h4>
<p>If your HTML has to be served statically or cached, for example if you're
building a single-page application, use <strong>a hash-based strict CSP</strong>.</p>
<p class="w-label">server configuration file</p>
<web-copy-code><pre class="language-http"><code class="language-http">Content-Security-Policy:<br>  script-src 'sha256-{HASH1}' 'sha256-{HASH2}' 'strict-dynamic' https: 'unsafe-inline';<br>  object-src 'none';<br>  base-uri 'none';</code></pre>
</web-copy-code><p>In HTML, you'll need to inline your scripts in order to apply a hash-based
policy, because <a href="https://wpt.fyi/results/content-security-policy/script-src/script-src-sri_hash.sub.html?label=master&amp;label=experimental&amp;aligned" rel="noopener">most browsers don't support hashing external
scripts</a>.</p>
<p class="w-label">index.html</p>
<web-copy-code><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br><span class="token operator">...</span><span class="token comment">// your script1, inlined</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br><span class="token operator">...</span><span class="token comment">// your script2, inlined</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre>
</web-copy-code><p>To load external scripts, read &quot;Load sourced scripts dynamically&quot; under
<a href="/strict-csp/#hash-based-csp">Option B: Hash-based CSP Response Header</a> section.</p>
<p><a href="https://csp-evaluator.withgoogle.com/" rel="noopener">CSP Evaluator</a> is a good tool to
evaluate your CSP, but at the same time a good nonce-based strict CSP example.
Use DevTools to see how it's used.</p>
<h3 id="supported-browsers">Supported browsers <a class="w-headline-link" href="#supported-browsers">#</a></h3>
<p>Chrome, Firefox, Edge, Safari</p>
<div class="w-aside w-aside--gotchas"><strong>Gotchas!</strong>
<ul>
<li><code>https:</code> is a fallback for Safari and <code>unsafe-inline</code> is a fallback for very
old browser versions. <code>https:</code> and <code>unsafe-inline</code> don't make your policy less
safe because they will be ignored by browsers who support <code>strict-dynamic</code>.
Read more in <a href="/strict-csp/#step-4:-add-fallbacks-to-support-safari-and-older-browsers">Add fallbacks to support Safari and older
browsers</a>.</li>
<li>Safari does <em>not</em> support <code>strict-dynamic</code> yet. But a strict CSP like in the
examples above is safer than an allowlist CSP (and much safer than no CSP at
all) for all of your users. Even in Safari, a strict CSP protects your site
from some types of XSS attacks, because the presence of the CSP disallows
certain unsafe patterns.</li>
</ul>
</div>
<p>See <a href="https://developer.mozilla.org/docs/Web/HTTP/CSP#browser_compatibility" rel="noopener">more
compatibilities</a>.</p>
<h3 id="other-things-to-note-about-csp">Other things to note about CSP <a class="w-headline-link" href="#other-things-to-note-about-csp">#</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors" rel="noopener"><code>frame-ancestors</code></a>
directive protects your site from clickjacking—a risk that arises if you allow
untrusted sites to embed yours. If you prefer simpler solution, you can use
<a href="#xfo"><code>X-Frame-Options</code></a> to block being loaded, but <code>frame-ancestors</code> gives
you an advanced configuration to only allow specific origins as embedders.</li>
<li>You may have used <a href="/fixing-mixed-content/#content-security-policy">a CSP to ensure that all of your site's resources are
loaded over HTTPS</a>. This has
become less relevant: nowadays, most browsers block
<a href="/what-is-mixed-content/">mixed-content</a>.</li>
<li>You can also set a CSP in <a href="/strict-csp/#step-2:-set-a-strict-csp-and-prepare-your-scripts">report-only
mode</a>.</li>
<li>If you can't set a CSP as a header server-side, you can also set it as a meta
tag. Note that you can't use <strong>report-only</strong> mode for meta tags (though
<a href="https://github.com/w3c/webappsec-csp/issues/277" rel="noopener">this may change</a>).</li>
</ul>
<h3 id="learn-more">Learn more <a class="w-headline-link" href="#learn-more">#</a></h3>
<ul>
<li><a href="/strict-csp">Mitigate XSS with a Strict Content Security Policy (CSP)</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html" rel="noopener">Content Security Policy Cheat
Sheet</a></li>
</ul>
</details>
<h2 id="tt">Trusted Types <a class="w-headline-link" href="#tt">#</a></h2>
<p><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based" rel="noopener">DOM-based
XSS</a> is an
attack where a malicious data is passed into a sink that supports dynamic code
execution such as <code>eval()</code> or <code>.innerHTML</code>.</p>
<p>Trusted Types provide the tools to write, security review, and maintain
applications free of DOM XSS. They can be enabled via <a href="#csp">CSP</a> and make
JavaScript code secure by default by limiting dangerous web APIs to only accept
a special object—a Trusted Type.</p>
<p>To create these objects you can define security policies in which you can ensure
that security rules (such as escaping or sanitization) are consistently applied
before the data is written to the DOM. These policies are then the only places
in code that could potentially introduce DOM XSS.</p>
<p class="w-label">Example usages</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Content-Security-Policy:</span> require-trusted-types-for 'script'</code></pre>
</web-copy-code><web-copy-code><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Feature detection</span><br><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>trustedTypes <span class="token operator">&amp;&amp;</span> trustedTypes<span class="token punctuation">.</span>createPolicy<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Name and create a policy</span><br>  <span class="token keyword">const</span> policy <span class="token operator">=</span> trustedTypes<span class="token punctuation">.</span><span class="token function">createPolicy</span><span class="token punctuation">(</span><span class="token string">'escapePolicy'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">createHTML</span><span class="token operator">:</span> <span class="token parameter">str</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"><span class="token escape">\&lt;</span></span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">></span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><web-copy-code><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Assignment of raw strings is blocked by Trusted Types.</span><br>el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'some string'</span><span class="token punctuation">;</span> <span class="token comment">// This throws an exception.</span><br><br><span class="token comment">// Assignment of Trusted Types is accepted safely.</span><br><span class="token keyword">const</span> escaped <span class="token operator">=</span> policy<span class="token punctuation">.</span><span class="token function">createHTML</span><span class="token punctuation">(</span><span class="token string">'&lt;img src=x onerror=alert(1)>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> escaped<span class="token punctuation">;</span>  <span class="token comment">// '&amp;lt;img src=x onerror=alert(1)&amp;gt;'</span></code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use Trusted Types
  </h2>
</summary>
<h3 id="recommended-usages-2">Recommended usages <a class="w-headline-link" href="#recommended-usages-2">#</a></h3>
<ol>
<li>
<p>Enforce Trusted Types for dangerous DOM sinks</p>
 <p class="w-label">CSP and Trusted Types header:</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Content-Security-Policy:</span> require-trusted-types-for 'script'</code></pre>
</web-copy-code><p>Currently <code>'script'</code> is the only acceptable value for
<code>require-trusted-types-for</code> directive.</p>
<p>Of course, you can combine Trusted Types with other CSP directives:</p>
 <p class="w-label"> Merging a nonce-based CSP from above with Trusted Types: </p>
<web-copy-code><pre class="language-http"><code class="language-http">Content-Security-Policy:<br>  script-src 'nonce-{RANDOM1}' 'strict-dynamic' https: 'unsafe-inline';<br>  object-src 'none';<br>  base-uri 'none';<br>  require-trusted-types-for 'script';</code></pre>
</web-copy-code> <div class="w-aside w-aside--note">
<p>You may limit allowed Trusted Types policy names by setting an additional
<code>trusted-types</code> directive (for example, <code>trusted-types myPolicy</code>). However, this is
not a requirement.</p>
 </div>
</li>
<li>
<p>Define a policy</p>
 <p class="w-label">Policy:</p>
<web-copy-code><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Feature detection</span><br><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>trustedTypes <span class="token operator">&amp;&amp;</span> trustedTypes<span class="token punctuation">.</span>createPolicy<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">// Name and create a policy</span><br>  <span class="token keyword">const</span> policy <span class="token operator">=</span> trustedTypes<span class="token punctuation">.</span><span class="token function">createPolicy</span><span class="token punctuation">(</span><span class="token string">'escapePolicy'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">createHTML</span><span class="token operator">:</span> <span class="token parameter">str</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"><span class="token escape">\&lt;</span></span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">></span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code> <div class="w-aside w-aside--note">
<p>You can define policies with arbitrary names unless you limit the names of
allowed Trusted Types policies by setting the <code>trusted-types</code> directive.</p>
 </div>
</li>
<li>
<p>Apply the policy</p>
 <p class="w-label">Use the policy when writing data to the DOM:</p>
<web-copy-code><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Assignment of raw strings are blocked by Trusted Types.</span><br>el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'some string'</span><span class="token punctuation">;</span> <span class="token comment">// This throws an exception.</span><br><br><span class="token comment">// Assignment of Trusted Types is accepted safely.</span><br><span class="token keyword">const</span> escaped <span class="token operator">=</span> policy<span class="token punctuation">.</span><span class="token function">createHTML</span><span class="token punctuation">(</span><span class="token string">'&lt;img src=x onerror=alert(1)>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> escaped<span class="token punctuation">;</span>  <span class="token comment">// '&amp;lt;img src=x onerror=alert(1)&amp;gt;'</span></code></pre>
</web-copy-code><p>With <code>require-trusted-types-for 'script'</code>, using a trusted type is a
requirement. Using any dangerous DOM API with a string will result in an
error.</p>
</li>
</ol>
<h3 id="supported-browsers-2">Supported browsers <a class="w-headline-link" href="#supported-browsers-2">#</a></h3>
<p>Chrome, Edge</p>
<p>See <a href="https://caniuse.com/?search=trusted%20types" rel="noopener">more compatibilities</a>.</p>
<h3 id="learn-more-2">Learn more <a class="w-headline-link" href="#learn-more-2">#</a></h3>
<ul>
<li><a href="/trusted-types/">Prevent DOM-based cross-site scripting vulnerabilities with Trusted
Types</a></li>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Content-Security-Policy/require-trusted-types-for" rel="noopener">CSP: require-trusted-types-for - HTTP |
MDN</a></li>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Content-Security-Policy/trusted-types" rel="noopener">CSP: trusted-types - HTTP |
MDN</a></li>
<li><a href="https://www.compass-demo.com/trusted-types/" rel="noopener">Trusted Types demo</a>—open DevTools Inspector and see
what is happening</li>
</ul>
</details>
<h2 id="xcto">X-Content-Type-Options <a class="w-headline-link" href="#xcto">#</a></h2>
<p>When a malicious HTML document is served from your domain (for example, if an
image uploaded to a photo service contains valid HTML markup), some browsers
will treat it as an active document and allow it to execute scripts in the
context of the application, leading to a <a href="https://www.google.com/about/appsecurity/learning/xss/" rel="noopener">cross-site scripting
bug</a>.</p>
<p><code>X-Content-Type-Options: nosniff</code> prevents it by instructing the browser that
the <a href="https://mimesniff.spec.whatwg.org/#introduction" rel="noopener">MIME type</a> set in the
<code>Content-Type</code> header for a given response is correct. This header is
recommended for <strong>all of your resources</strong>.</p>
<p class="w-label">Example usage</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">X-Content-Type-Options:</span> nosniff</code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use X-Content-Type-Options
  </h2>
</summary>
<h3 id="recommended-usages-3">Recommended usages <a class="w-headline-link" href="#recommended-usages-3">#</a></h3>
<p><code>X-Content-Type-Options: nosniff</code> is recommended for all resources served from
your server along with the correct <code>Content-Type</code> header.</p>
<img     alt="X-Content-Type-Options: nosniff"          decoding="async"     height="237"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/IWqRWe9R1mOJImmMbLoM.png?auto=format&w=1600 1600w"          width="800"   />
<p class="w-label">Example headers sent with a document HTML</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">X-Content-Type-Options:</span> nosniff<br><span class="token header-name keyword">Content-Type:</span> text/html; charset=utf-8</code></pre>
</web-copy-code><h3 id="supported-browsers-3">Supported browsers <a class="w-headline-link" href="#supported-browsers-3">#</a></h3>
<p>Chrome, Firefox, Safari, Edge</p>
<p>See <a href="https://caniuse.com/mdn-http_headers_x-content-type-options" rel="noopener">more
compatibilities</a>.</p>
<h3 id="learn-more-3">Learn more <a class="w-headline-link" href="#learn-more-3">#</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Content-Type-Options" rel="noopener">X-Content-Type-Options - HTTP MDN</a></li>
</ul>
</details>
<h2 id="xfo">X-Frame-Options <a class="w-headline-link" href="#xfo">#</a></h2>
<p>If a malicious website can embed your site as an iframe, this may allow
attackers to invoke unintended actions by the user with
<a href="https://portswigger.net/web-security/clickjacking" rel="noopener">clickjacking</a>. Also, in some
cases <a href="https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)" rel="noopener">Spectre-type
attacks</a> give
malicious websites a chance to learn about the contents of an embedded document.</p>
<p><code>X-Frame-Options</code> indicates whether or not a browser should be allowed to render
a page in a <code>&lt;frame&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;embed&gt;</code>, or <code>&lt;object&gt;</code>. <strong>All documents</strong>
are recommended to send this header to indicate whether they allow being
embedded by other documents.</p>
<div class="w-aside w-aside--note">
<p>If you need more granular control such as allowing only a specific origin to
embed the document, use the <a href="#csp">CSP</a>
<a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors" rel="noopener"><code>frame-ancestors</code></a>
directive.</p>
</div>
<p class="w-label">Example usage</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">X-Frame-Options:</span> DENY</code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use X-Frame-Options
  </h2>
</summary>
<h3 id="recommended-usages-4">Recommended usages <a class="w-headline-link" href="#recommended-usages-4">#</a></h3>
<p>All documents that are not designed to be embedded should use <code>X-Frame-Options</code> header.</p>
<p>You can try how the following configurations affect loading an iframe on <a href="https://first-party-test.glitch.me/" rel="noopener">this
demo</a>. Change the <code>X-Frame-Options</code>
dropdown menu and click the <strong>Reload the iframe</strong> button.</p>
<h4 id="protects-your-website-from-being-embedded-by-any-other-websites">Protects your website from being embedded by any other websites <a class="w-headline-link" href="#protects-your-website-from-being-embedded-by-any-other-websites">#</a></h4>
<p>Deny being embedded by any other documents.</p>
<img     alt="X-Frame-Options: DENY"          decoding="async"     height="237"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2ZM5obgGK38CMcZ75PkH.png?auto=format&w=1600 1600w"          width="800"   />
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">X-Frame-Options:</span> DENY</code></pre>
</web-copy-code><h4 id="protects-your-website-from-being-embedded-by-any-cross-origin-websites">Protects your website from being embedded by any cross-origin websites <a class="w-headline-link" href="#protects-your-website-from-being-embedded-by-any-cross-origin-websites">#</a></h4>
<p>Allow being embedded only by same-origin documents.</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">X-Frame-Options:</span> SAMEORIGIN</code></pre>
</web-copy-code><div class="w-aside w-aside--gotchas"><strong>Gotchas!</strong>
<p>Documents being embeddable by default means the web developers need to
explicitly send <code>DENY</code> or <code>SAMEORIGIN</code> to stop being embedded and protect
themselves from side-channel attacks. The Chrome team is considering switching
to block document embeds by default so that websites will be secure even if they
don't explicitly set the header. In that new world, documents would need to
explicitly opt-in to be embedded.</p>
</div>
<h3 id="supported-browsers-4">Supported browsers <a class="w-headline-link" href="#supported-browsers-4">#</a></h3>
<p>Chrome, Firefox, Safari, Edge</p>
<p>See <a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options#browser_compatibility" rel="noopener">more
compatibilities</a>.</p>
<h3 id="learn-more-4">Learn more <a class="w-headline-link" href="#learn-more-4">#</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/X-Frame-Options" rel="noopener">X-Frame-Options - HTTP</a></li>
</ul>
</details>
<h2 id="corp">Cross-Origin Resource Policy (CORP) <a class="w-headline-link" href="#corp">#</a></h2>
<p>An attacker can embed resources from another origin, for example from your site,
to learn information about them by exploiting web-based <a href="https://xsleaks.dev/" rel="noopener">cross-site
leaks</a>.</p>
<p><code>Cross-Origin-Resource-Policy</code> mitigates this risk by indicating the set of
websites it can be loaded by. The header takes one of three values:
<code>same-origin</code>, <code>same-site</code>, and <code>cross-origin</code>. <strong>All resources</strong> are
recommended to send this header to indicate whether they allow being loaded by
other websites.</p>
<p class="w-label">Example usage</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Resource-Policy:</span> same-origin</code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use CORP
  </h2>
</summary>
<h3 id="recommended-usages-5">Recommended usages <a class="w-headline-link" href="#recommended-usages-5">#</a></h3>
<p>It is recommended that <strong>all</strong> resources are served with one of the following
three headers.</p>
<p>You can try how the following configurations affect loading resources under a
<a href="#coep"><code>Cross-Origin-Embedder-Policy: require-corp</code> environment</a> on <a href="https://first-party-test.glitch.me/?coep=require-corp&amp;" rel="noopener">this
demo</a>. Change the
<strong>Cross-Origin-Resource-Policy</strong> dropdown menu and click the <strong>Reload the
iframe</strong> or <strong>Reload the image</strong> button to see the effect.</p>
<h4 id="allow-resources-to-be-loaded-cross-origin">Allow resources to be loaded <code>cross-origin</code> <a class="w-headline-link" href="#allow-resources-to-be-loaded-cross-origin">#</a></h4>
<p>It's recommended that CDN-like services apply <code>cross-origin</code> to resources
(since they are usually loaded by cross-origin pages), unless they are already served
through <a href="#cors">CORS</a> which has a similar effect.</p>
<img     alt="Cross-Origin-Resource-Policy: cross-origin"          decoding="async"     height="234"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/qP2mspVMC6RazxDjWUrL.png?auto=format&w=1600 1600w"          width="800"   />
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Resource-Policy:</span> cross-origin</code></pre>
</web-copy-code><h4 id="limit-resources-to-be-loaded-from-the-same-origin">Limit resources to be loaded from the <code>same-origin</code> <a class="w-headline-link" href="#limit-resources-to-be-loaded-from-the-same-origin">#</a></h4>
<p><code>same-origin</code> should be applied to resources that are intended to be loaded only
by same-origin pages. You should apply this to resources that include sensitive
information about the user, or responses of an API that is intended to be called
only from the same origin.</p>
<p>Keep in mind that resources with this header can still be loaded directly, for
example by navigating to the URL in a new browser window. Cross-Origin Resource
Policy only protects the resource from being embedded by other websites.</p>
<img     alt="Cross-Origin-Resource-Policy: same-origin"          decoding="async"     height="238"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/7UzYMWsbKkh89m5ZImvj.png?auto=format&w=1600 1600w"          width="800"   />
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Resource-Policy:</span> same-origin</code></pre>
</web-copy-code><h4 id="limit-resources-to-be-loaded-from-the-same-site">Limit resources to be loaded from the <code>same-site</code> <a class="w-headline-link" href="#limit-resources-to-be-loaded-from-the-same-site">#</a></h4>
<p><code>same-site</code> is recommended to be applied to resources that are similar to above
but are intended to be loaded by other subdomains of your site.</p>
<img     alt="Cross-Origin-Resource-Policy: same-site"          decoding="async"     height="233"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/R9yNRGSJ4xABc560WRJI.png?auto=format&w=1600 1600w"          width="800"   />
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Resource-Policy:</span> same-site</code></pre>
</web-copy-code><div class="w-aside w-aside--note">
<p>To learn more about the difference between same-origin and same-site, check out
<a href="/same-site-same-origin/">Understanding &quot;same-site&quot; and &quot;same-origin&quot;</a>.</p>
</div>
<h3 id="supported-browsers-5">Supported browsers <a class="w-headline-link" href="#supported-browsers-5">#</a></h3>
<p>Chrome, Firefox, Safari, Edge</p>
<p>See <a href="https://caniuse.com/mdn-http_headers_cross-origin-resource-policy" rel="noopener">more
compatibilities</a>.</p>
<h3 id="learn-more-5">Learn more <a class="w-headline-link" href="#learn-more-5">#</a></h3>
<ul>
<li><a href="https://resourcepolicy.fyi/" rel="noopener">Consider deploying cross-origin resource policy</a></li>
<li><a href="/coop-coep/">Making your website &quot;cross-origin isolated&quot; using COOP and COEP</a></li>
<li><a href="/why-coop-coep/">Why you need &quot;cross-origin isolated&quot; for powerful features</a></li>
</ul>
</details>
<h2 id="coop">Cross-Origin Opener Policy (COOP) <a class="w-headline-link" href="#coop">#</a></h2>
<p>An attacker's website can open another site in a popup window to learn
information about it by exploiting web-based <a href="https://xsleaks.dev/" rel="noopener">cross-site
leaks</a>. In some cases, this may also allow the
exploitation of side-channel attacks based on
<a href="https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)" rel="noopener">Spectre</a>.</p>
<p>The <code>Cross-Origin-Opener-Policy</code> header provides a way for a document to isolate
itself from cross-origin windows opened through <code>window.open()</code> or a link with
<code>target=&quot;_blank&quot;</code> without <code>rel=&quot;noopener&quot;</code>. As a result, any cross-origin opener
of the document will have no reference to it and will not be able to interact
with it.</p>
<p class="w-label">Example usage</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Opener-Policy:</span> same-origin-allow-popups</code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use COOP
  </h2>
</summary>
<h3 id="recommended-usages-6">Recommended usages <a class="w-headline-link" href="#recommended-usages-6">#</a></h3>
<p>You can try how the following configurations affect communication with a
cross-origin popup window on <a href="https://first-party-test.glitch.me/" rel="noopener">this demo</a>.
Change the <strong>Cross-Origin-Opener-Policy</strong> dropdown menu for both the document
and the popup window, click the <strong>Open a popup</strong> button then click <strong>Send a
postMessage</strong> to see if the message is actually delivered.</p>
<h4 id="isolate-a-document-from-cross-origin-windows">Isolate a document from cross-origin windows <a class="w-headline-link" href="#isolate-a-document-from-cross-origin-windows">#</a></h4>
<p>Setting <code>same-origin</code> puts the document to be isolated from cross-origin
document windows.</p>
<img     alt="Cross-Origin-Opener-Policy: same-origin"          decoding="async"     height="235"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/mSDG9auD7r5asxGJvJjg.png?auto=format&w=1600 1600w"          width="800"   />
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Opener-Policy:</span> same-origin</code></pre>
</web-copy-code><h4 id="isolate-a-document-from-cross-origin-windows-but-allow-popups">Isolate a document from cross-origin windows but allow popups <a class="w-headline-link" href="#isolate-a-document-from-cross-origin-windows-but-allow-popups">#</a></h4>
<p>Setting <code>same-origin-allow-popups</code> allows a document to retain a reference to
its popup windows unless they set COOP with <code>same-origin</code> or
<code>same-origin-allow-popups</code>. This means <code>same-origin-allow-popups</code> can still
protect the document from being referenced when opened as a popup window, but
allow it to communicate with its own popups.</p>
<img     alt="Cross-Origin-Opener-Policy: same-origin-allow-popups"          decoding="async"     height="233"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/2uJZ0s2VnjxJUcBI2Ol9.png?auto=format&w=1600 1600w"          width="800"   />
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Opener-Policy:</span> same-origin-allow-popups</code></pre>
</web-copy-code><h4 id="allow-a-document-to-be-referenced-by-cross-origin-windows">Allow a document to be referenced by cross-origin windows <a class="w-headline-link" href="#allow-a-document-to-be-referenced-by-cross-origin-windows">#</a></h4>
<p><code>unsafe-none</code> is the default value but you can explicitly indicate that this
document can be opened by a cross-origin window and retain mutual access.</p>
<img     alt="Cross-Origin-Opener-Policy: unsafe-none"          decoding="async"     height="233"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format"     srcset="https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/YLflGBAPWecgtKJLqCJHSzHqe2J2/oSco89ZT3RP7gZzNKDjY.png?auto=format&w=1600 1600w"          width="800"   />
<div class="w-aside w-aside--gotchas"><strong>Gotchas!</strong>
<p><code>unsafe-none</code> being the default means the web developers need to send
<code>same-origin</code> or <code>same-origin-allow-popups</code> explicitly to protect their website
from side-channel attacks.</p>
</div>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Opener-Policy:</span> unsafe-none</code></pre>
</web-copy-code><div class="w-aside w-aside--note">
<p>Features such as <code>SharedArrayBuffer</code> or
<code>performance.measureUserAgentSpecificMemory()</code> are disabled by default. Some
browsers allow you to use them in &quot;cross-origin isolated&quot; contexts, which
require you to set <a href="#coop">COOP</a> and <a href="#coep">COEP</a> headers.</p>
<p>To learn more, read <a href="/coop-coep/">Making your website &quot;cross-origin isolated&quot; using COOP and
COEP</a>.</p>
</div>
<h4 id="report-patterns-incompatible-with-coop">Report patterns incompatible with COOP <a class="w-headline-link" href="#report-patterns-incompatible-with-coop">#</a></h4>
<p>You can receive reports when COOP prevents cross-window interactions with the
Reporting API.</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Opener-Policy:</span> same-origin; report-to="coop"</code></pre>
</web-copy-code><p>COOP also supports a report-only mode so you can receive reports without
actually blocking communication between cross-origin documents.</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Opener-Policy-Report-Only:</span> same-origin; report-to="coop"</code></pre>
</web-copy-code><h3 id="supported-browsers-6">Supported browsers <a class="w-headline-link" href="#supported-browsers-6">#</a></h3>
<p>Chrome, Firefox, Edge</p>
<p>See <a href="https://caniuse.com/mdn-http_headers_cross-origin-opener-policy" rel="noopener">more
compatibilities</a>.</p>
<h3 id="learn-more-6">Learn more <a class="w-headline-link" href="#learn-more-6">#</a></h3>
<ul>
<li><a href="/why-coop-coep/">Why you need &quot;cross-origin isolated&quot; for powerful features</a></li>
</ul>
</details>
<h2 id="cors">Cross-Origin Resource Sharing (CORS) <a class="w-headline-link" href="#cors">#</a></h2>
<p>Unlike other items in this article, Cross-Origin Resource Sharing (CORS) is not
a header, but a browser mechanism that requests and permits access to
cross-origin resources.</p>
<p>By default, browsers enforce <a href="/same-origin-policy/">the same-origin policy</a> to
prevent a web page from accessing cross-origin resources. For example, when a
cross-origin image is loaded, even though it's displayed on the web page
visually, the JavaScript on the page doesn't have access to the image's data.
The resource provider can relax restrictions and allow other websites to read
the resource by opting-in with CORS.</p>
<p class="w-label">Example usage</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Access-Control-Allow-Origin:</span> https://example.com<br><span class="token header-name keyword">Access-Control-Allow-Credentials:</span> true</code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use CORS
  </h2>
</summary>
<p>Before looking into how to configure CORS, it's helpful to understand the
distinction between request types. Depending on request details, a request will
be classified as a <strong>simple request</strong> or a <strong>preflighted request</strong>.</p>
<p>Criteria for a simple request:</p>
<ul>
<li>The method is <code>GET</code>, <code>HEAD</code>, or <code>POST</code>.</li>
<li>The custom headers only include <code>Accept</code>, <code>Accept-Language</code>,
<code>Content-Language</code>, and <code>Content-Type</code>.</li>
<li>The <code>Content-Type</code> is <code>application/x-www-form-urlencoded</code>,
<code>multipart/form-data</code>, or <code>text/plain</code>.</li>
</ul>
<p>Everything else is classified as a preflighted request. For more details,
check out <a href="https://developer.mozilla.org/docs/Web/HTTP/CORS#simple_requests" rel="noopener">Cross-Origin Resource Sharing (CORS) - HTTP |
MDN</a>.</p>
<h3 id="recommended-usages-7">Recommended usages <a class="w-headline-link" href="#recommended-usages-7">#</a></h3>
<h4 id="simple-request">Simple request <a class="w-headline-link" href="#simple-request">#</a></h4>
<p>When a request meets the simple request criteria, the browser sends a
cross-origin request with an <code>Origin</code> header that indicates the requesting
origin.</p>
<p class="w-label">Example request header</p>
<web-copy-code><pre class="language-http"><code class="language-http">Get / HTTP/1.1<br><span class="token header-name keyword">Origin:</span> https://example.com</code></pre>
</web-copy-code><p class="w-label">Example response header</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Access-Control-Allow-Origin:</span> https://example.com<br><span class="token header-name keyword">Access-Control-Allow-Credentials:</span> true</code></pre>
</web-copy-code><ul>
<li><code>Access-Control-Allow-Origin: https://example.com</code> indicates that the
<code>https://example.com</code> can access the contents of the response. Resources meant
to be readable by any site can set this header to <code>*</code>, in which case the
browser will only require the request to be made <a href="https://developer.mozilla.org/docs/Web/API/Request/credentials#value" rel="noopener">without
credentials</a>.</li>
<li><code>Access-Control-Allow-Credentials: true</code> indicates that requests which carry
credentials (cookies) are allowed to load the resource. Otherwise,
authenticated requests will be rejected even if the requesting origin is
present in the <code>Access-Control-Allow-Origin</code> header.</li>
</ul>
<p>You can try how the simple request affect loading resources under a
<a href="#coep"><code>Cross-Origin-Embedder-Policy: require-corp</code> environment</a> on <a href="https://first-party-test.glitch.me/?coep=require-corp&amp;" rel="noopener">this
demo</a>. Click the
<strong>Cross-Origin Resource Sharing</strong> checkbox and click the <strong>Reload the image</strong>
button to see the effect.</p>
<h4 id="preflighted-requests">Preflighted requests <a class="w-headline-link" href="#preflighted-requests">#</a></h4>
<p>A preflighted request is preceded with an <code>OPTIONS</code> request to check if the
subsequent request is allowed to be sent.</p>
<p class="w-label">Example request header</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token request-line"><span class="token method property">OPTIONS</span> <span class="token request-target url">/</span> <span class="token http-version property">HTTP/1.1</span></span><br><span class="token header-name keyword">Origin:</span> https://example.com<br><span class="token header-name keyword">Access-Control-Request-Method:</span> POST<br><span class="token header-name keyword">Access-Control-Request-Headers:</span> X-PINGOTHER, Content-Type</code></pre>
</web-copy-code><ul>
<li><code>Access-Control-Request-Method: POST</code> allows the following request to be made
with the  <code>POST</code> method.</li>
<li><code>Access-Control-Request-Headers: X-PINGOTHER, Content-Type</code> allows the
requester to set the <code>X-PINGOTHER</code> and <code>Content-Type</code> HTTP headers in the
subsequent request.</li>
</ul>
<p class="w-label">Example response headers</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Access-Control-Allow-Origin:</span> https://example.com<br><span class="token header-name keyword">Access-Control-Allow-Credentials:</span> true<br><span class="token header-name keyword">Access-Control-Allow-Methods:</span> POST, GET, OPTIONS<br><span class="token header-name keyword">Access-Control-Allow-Headers:</span> X-PINGOTHER, Content-Type<br><span class="token header-name keyword">Access-Control-Max-Age:</span> 86400</code></pre>
</web-copy-code><ul>
<li><code>Access-Control-Allow-Methods: POST, GET, OPTIONS</code> indicates that subsequent
requests can be made with the  <code>POST</code>, <code>GET</code> and <code>OPTIONS</code> methods.</li>
<li><code>Access-Control-Allow-Headers: X-PINGOTHER, Content-Type</code> indicates subsequent
requests can include the <code>X-PINGOTHER</code> and <code>Content-Type</code> headers.</li>
<li><code>Access-Control-Max-Age: 86400</code>  indicates that the result of the preflighted
request can be cached for 86400 seconds.</li>
</ul>
<h3 id="supported-browsers-7">Supported browsers <a class="w-headline-link" href="#supported-browsers-7">#</a></h3>
<p>Chrome, Firefox, Safari, Edge</p>
<p>See <a href="https://caniuse.com/mdn-http_headers_content-length_cors_response_safelist" rel="noopener">more
compatibilities</a>.</p>
<h3 id="learn-more-7">Learn more <a class="w-headline-link" href="#learn-more-7">#</a></h3>
<ul>
<li><a href="/cross-origin-resource-sharing/">Cross-Origin Resource Sharing (CORS)</a></li>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/CORS" rel="noopener">Cross-Origin Resource Sharing (CORS) - HTTP |
MDN</a></li>
</ul>
</details>
<h2 id="coep">Cross-Origin Embedder Policy (COEP) <a class="w-headline-link" href="#coep">#</a></h2>
<p>To reduce the ability of <a href="https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)" rel="noopener">Spectre-based
attacks</a> to
steal cross-origin resources, features such as <code>SharedArrayBuffer</code> or
<code>performance.measureUserAgentSpecificMemory()</code> are disabled by default.</p>
<p><code>Cross-Origin-Embedder-Policy: require-corp</code> prevents documents and workers from
loading cross-origin resources such as images, scripts, stylesheets, iframes and
others unless these resources explicitly opt into being loaded via <a href="#cors">CORS</a>
or <a href="#corp">CORP</a> headers. COEP can be combined with<code>Cross-Origin-Opener-Policy</code>
to opt a document into <a href="/cross-origin-isolation-guide/">cross-origin isolation</a>.</p>
<p>Use <code>Cross-Origin-Embedder-Policy: require-corp</code> when you want to enable
<a href="/coop-coep/">cross-origin isolation</a> for your document.</p>
<p class="w-label">Example usage</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Embedder-Policy:</span> require-corp</code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use COEP
  </h2>
</summary>
<h3 id="example-usages">Example usages <a class="w-headline-link" href="#example-usages">#</a></h3>
<p>COEP takes a single value of <code>require-corp</code>. By sending this header, you can
instruct the browser to block loading resources that do not opt-in via
<a href="#cors">CORS</a> or <a href="#corp">CORP</a>.</p>
<img     alt="How COEP works"          decoding="async"     height="410"          loading="lazy"     sizes="(min-width: 800px) 800px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format"     srcset="https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/MAhaVZdShm8tRntWieU4.png?auto=format&w=1600 1600w"          width="800"   />
<p>You can try how the following configurations affect loading resources on <a href="https://first-party-test.glitch.me/" rel="noopener">this
demo</a>. Change the
<strong>Cross-Origin-Embedder-Policy</strong> dropdown menu, the
<strong>Cross-Origin-Resource-Policy</strong> dropdown menu, the <strong>Report Only</strong> checkbox etc
to see how they affect loading resources. Also, open <a href="https://reporting-endpoint.glitch.me/" rel="noopener">the reporting endpoint
demo</a> to see if the blocked resources are
reported.</p>
<h4 id="enable-cross-origin-isolation">Enable cross-origin isolation <a class="w-headline-link" href="#enable-cross-origin-isolation">#</a></h4>
<p>Enable <a href="/coop-coep">cross-origin isolation</a> by sending
<code>Cross-Origin-Embedder-Policy: require-corp</code> along with
<code>Cross-Origin-Opener-Policy: same-origin</code>.</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Embedder-Policy:</span> require-corp<br><span class="token header-name keyword">Cross-Origin-Opener-Policy:</span> same-origin</code></pre>
</web-copy-code><h4 id="report-resources-incompatible-withn-coep">Report resources incompatible withn COEP <a class="w-headline-link" href="#report-resources-incompatible-withn-coep">#</a></h4>
<p>You can receive reports of blocked resources caused by COEP with the Reporting
API.</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Embedder-Policy:</span> require-corp; report-to="coep"</code></pre>
</web-copy-code><p>COEP also supports report-only mode so you can receive reports without actually
blocking loading resources.</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Cross-Origin-Embedder-Policy-Report-Only:</span> require-corp; report-to="coep"</code></pre>
</web-copy-code><h3 id="supported-browsers-8">Supported browsers <a class="w-headline-link" href="#supported-browsers-8">#</a></h3>
<p>Chrome, Firefox, Edge</p>
<p>See <a href="https://caniuse.com/mdn-http_headers_cross-origin-embedder-policy" rel="noopener">more
compatibilities</a>.</p>
<h3 id="learn-more-8">Learn more <a class="w-headline-link" href="#learn-more-8">#</a></h3>
<ul>
<li><a href="/coop-coep/">Making your website &quot;cross-origin isolated&quot; using COOP and COEP</a></li>
<li><a href="/why-coop-coep/">Why you need &quot;cross-origin isolated&quot; for powerful features</a></li>
<li><a href="/cross-origin-isolation-guide/">A guide to enable cross-origin isolation</a></li>
</ul>
</details>
<h2 id="hsts">HTTP Strict Transport Security (HSTS) <a class="w-headline-link" href="#hsts">#</a></h2>
<p>Communication over a plain HTTP connection is not encrypted, making the
transferred data accessible to network-level eavesdroppers.</p>
<p><code>Strict-Transport-Security</code> header informs the browser that it should never load
the site using HTTP and use HTTPS instead. Once it's set, the browser will use
HTTPS instead of HTTP to access the domain without a redirect for a duration
defined in the header.</p>
<p class="w-label">Example usage</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Strict-Transport-Security:</span> max-age=31536000</code></pre>
</web-copy-code><details class="w-details" >
<summary class="w-details__summary">
  <h2 class="w-details__header">
    How to use HSTS
  </h2>
</summary>
<h3 id="recommended-usages-8">Recommended usages <a class="w-headline-link" href="#recommended-usages-8">#</a></h3>
<p>All websites that transition from HTTP to HTTPS should respond with a
<code>Strict-Transport-Security</code> header when a request with HTTP is received.</p>
<web-copy-code><pre class="language-http"><code class="language-http"><span class="token header-name keyword">Strict-Transport-Security:</span> max-age=31536000</code></pre>
</web-copy-code><h3 id="supported-browsers-9">Supported browsers <a class="w-headline-link" href="#supported-browsers-9">#</a></h3>
<p>Chrome, Firefox, Safari, Edge</p>
<p>See <a href="https://caniuse.com/stricttransportsecurity" rel="noopener">more compatibilities</a>.</p>
<h3 id="learn-more-9">Learn more <a class="w-headline-link" href="#learn-more-9">#</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/docs/Web/HTTP/Headers/Strict-Transport-Security" rel="noopener">Strict-Transport-Security -
HTTP</a></li>
</ul>
</details>
<h2 id="further-reading">Further reading <a class="w-headline-link" href="#further-reading">#</a></h2>
<ul>
<li><a href="https://www.w3.org/TR/post-spectre-webdev/" rel="noopener">Post-Spectre Web Development</a></li>
</ul>


    

    
  <div class="w-chips ">
    
      
    
      
    
      
        
        <a class="w-chip" href="/tags/security/">Security</a>
      
    
  </div>


    <div class="w-post-github-link w-mt--l w-mb--l">
      <span class="w-mr--sm">
        
        Last updated: <time>Aug 5, 2021</time>
        
      </span>
      <a
        href="https://github.com/GoogleChrome/web.dev/blob/main/src/site/content/en/secure/security-headers/index.md"
      >
        Improve article
      </a>
       
    </div>

    
  </div>

  
    
    <nav class="w-article-navigation">
  <a
    class="w-article-navigation__link w-article-navigation__link--back
      w-article-navigation__link--single gc-analytics-event"
    data-category="web.dev"
    data-label="navigation, go back"
    data-action="click"
    href="/blog"
  >
    Return to all articles
  </a>
</nav>
  
</div>


  </div>
</main>
<footer class="w-footer">
  <nav class="w-footer__linkboxes">
    <ul class="w-footer__linkboxes-list">
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Contribute</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
              class="w-footer__linkbox-link" data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              File a bug
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://github.com/googlechrome/web.dev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              View source
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Related content</h3>
        <ul class="w-footer__linkbox-list">
         <li class="w-footer__linkbox-item">
            <a href="https://developer.chrome.com/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              developer.chrome.com
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://blog.chromium.org/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Chrome updates
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/fundamentals" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              Web Fundamentals
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://developers.google.com/web/showcase/" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
              Case studies
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/podcasts/" class="w-footer__linkbox-link"
              data-category="Podcasts" data-label="Footer Link (index 5)">
              Podcasts
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="/shows/" class="w-footer__linkbox-link"
              data-category="Shows" data-label="Footer Link (index 6)">
              Shows
            </a>
          </li>
        </ul>
      </li>
      <li class="w-footer__linkbox">
        <h3 class="w-footer__linkbox-heading">Connect</h3>
        <ul class="w-footer__linkbox-list">
          <li class="w-footer__linkbox-item">
            <a href="https://www.twitter.com/ChromiumDev" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
              Twitter
            </a>
          </li>
          <li class="w-footer__linkbox-item">
            <a href="https://www.youtube.com/user/ChromeDevelopers" class="w-footer__linkbox-link"
              data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
              YouTube
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="w-footer__utility">
    <nav class="w-footer__utility-nav">
      <a href="https://developers.google.com/" class="w-footer__utility-logo-link"
        data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
        <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
          alt="Google Developers" />
      </a>
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developer.chrome.com/"
            data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
            Chrome
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Firebase Link">
            Firebase
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Google Cloud Platform Link">
            Google Cloud Platform
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://developers.google.com/products"
            data-category="Site-Wide Custom Events" data-label="Footer All products Link">
            All products
          </a>
        </li>
      </ul>
      <web-language-select current="en"></web-language-select>
    </nav>
    <nav class="w-footer__utility-nav">
      <ul class="w-footer__utility-list">
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="https://policies.google.com/" data-category="Site-Wide Custom Events"
            data-label="Footer Terms and Privacy link">
            Terms &amp; Privacy
          </a>
        </li>
        <li class="w-footer__utility-item">
          <a class="w-footer__utility-link" href="/community-guidelines/" data-category="Site-Wide Custom Events"
            data-label="Footer Community Guidelines link">
            Community Guidelines
          </a>
        </li>
      </ul>
      <div class="w-footer__license">
        <p>
          Except as otherwise noted, the content of this page is licensed
          under the
          <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons Attribution 4.0 License</a>,
          and code samples are licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">
          Apache 2.0 License</a>. For details, see the
          <a href="https://developers.google.com/terms/site-policies">
          Google Developers Site Policies</a>.
        </p>
      </div>
    </nav>
  </div>
</footer>

  </body>
</html>
