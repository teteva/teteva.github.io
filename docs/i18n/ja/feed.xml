<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>web.dev</title>
  <subtitle>Let&#39;s build the future of the web.</subtitle>
  <link href="https://web.dev/feed.xml" rel="self"/>
  <link href="https://web.dev"/>
  <updated>2021-12-27T06:00:49Z</updated>
  <id>https://web.dev/</id>
  <author>
    <name>Google Developers</name>
  </author>
  <icon>https://web.dev/images/social.png</icon>
  <logo>https://web.dev/images/shared/rss-banner.png</logo>
  
    
    
    <entry>
      <title>Designcember Calculator</title>
      <link href="https://web.dev/docs/designcember-calculator/"/>
      <updated>2021-12-26T00:00:00Z</updated>
      <id>https://web.dev/docs/designcember-calculator/</id>
      <content type="text/html" mode="escaped">&lt;h2 id=&quot;the-challenge&quot;&gt;The challenge &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/designcember-calculator/#the-challenge&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I&#39;m a kid of the 1980s. A thing that was all the rage back when I was in high school were solar
calculators. We were all given a
&lt;a href=&quot;https://en.wikipedia.org/wiki/TI-30#/media/File:TI-30X_SOLAR,_2.jpg&quot; rel=&quot;noopener&quot;&gt;TI-30X SOLAR&lt;/a&gt; by the school,
and I have fond memories of us benchmarking our calculators against each other by calculating the
factorial of 69, the highest number the TI-30X could handle. (The speed variance was very
measurable, I have still no idea why.)&lt;/p&gt;
&lt;p&gt;Now, almost 28 years later, I thought it would be a fun Designcember challenge to recreate the
calculator in HTML, CSS, and JavaScript. Being not much of a designer, I did not start from scratch,
but with a &lt;a href=&quot;https://codepen.io/sassjajc/pen/zNJgKg&quot; rel=&quot;noopener&quot;&gt;CodePen&lt;/a&gt; by
&lt;a href=&quot;https://codepen.io/sassjajc&quot; rel=&quot;noopener&quot;&gt;Sassja Ceballos&lt;/a&gt;.&lt;/p&gt;
&lt;img alt=&quot;CodePen view with stacked HTML, CSS, and JS panels on the left and the calculator preview on the right.&quot; decoding=&quot;async&quot; height=&quot;470&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/DvhjfNHAYtSgJ6jK8uoI.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;make-it-installable&quot;&gt;Make it installable &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/designcember-calculator/#make-it-installable&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;While not a bad start, I decided to pump it up for full skeuomorphic awesomeness. The first step was
to make it a PWA so it could be installed. I maintain a
&lt;a href=&quot;https://glitch.com/edit/#!/baseline-pwa&quot; rel=&quot;noopener&quot;&gt;baseline PWA template on Glitch&lt;/a&gt; that I remix whenever I
need a quick demo. Its service worker will not win you any coding award and it is definitely &lt;em&gt;not&lt;/em&gt;
production-ready, but it is sufficient to trigger Chromium&#39;s mini infobar so the app can be
installed.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;install&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;skipWaiting&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;activate&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;clients&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;claim&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;waitUntil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;navigationPreload&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;registration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;registration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;navigationPreload&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;enable&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;fetch&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;respondWith&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;preloadResponse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;          &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Offline&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;blending-with-mobile&quot;&gt;Blending with mobile &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/designcember-calculator/#blending-with-mobile&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now that the app is installable, the next step is to make it blend in with the operating system apps as much as possible. On
mobile, I can do this by setting the display mode to &lt;code&gt;fullscreen&lt;/code&gt; in the Web App Manifest.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;&quot;display&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;fullscreen&quot;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;On devices with a camera hole or notch,
&lt;a href=&quot;https://webkit.org/blog/7929/designing-websites-for-iphone-x/&quot; rel=&quot;noopener&quot;&gt;tweaking the viewport&lt;/a&gt; so that the
content covers the whole screen makes the app look gorgeous.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;meta&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;viewport&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;initial-scale=1, viewport-fit=cover&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;Designcember Calculator running fullscreen on a Pixel 6 Pro phone.&quot; decoding=&quot;async&quot; height=&quot;773&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kEOrYPiDbg6DSTGHeB0C.jpg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;blending-with-desktop&quot;&gt;Blending with desktop &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/designcember-calculator/#blending-with-desktop&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;On desktop, there is a cool feature I can use:
&lt;a href=&quot;https://web.dev/window-controls-overlay/&quot;&gt;Window Controls Overlay&lt;/a&gt;, which allows me to put content in the title
bar of the app window. The first step is to override the display mode fallback sequence so it tries
to use &lt;code&gt;window-controls-overlay&lt;/code&gt; first when it is available.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;&quot;display_override&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;window-controls-overlay&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This makes the title bar effectively go away and the content moves up into the title bar area as if
the title bar were not there. My idea is to move the skeuomorphic solar cell up into the title bar
and the rest of the calculator UI down accordingly, which I can do with some CSS that uses
the &lt;code&gt;titlebar-area-*&lt;/code&gt; environment variables. You will notice that all the selectors carry a &lt;code&gt;wco&lt;/code&gt;
class, which will be relevant a couple of paragraphs down.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;#calc_solar_cell.wco&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; fixed&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;left&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;0.25rem + &lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;titlebar-area-x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;0.75rem + &lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;titlebar-area-y&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;titlebar-area-width&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 100%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; - 0.5rem&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;titlebar-area-height&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 33px&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; - 0.5rem&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;#calc_display_surface.wco&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;margin-top&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;titlebar-area-height&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 33px&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; - 0.5rem&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Next, I need to decide which elements to make draggable, since the title bar that I would usually
use for dragging is not available. In the style of a classic widget, I can even make the
entire calculator draggable by applying &lt;code&gt;(-webkit-)app-region: drag&lt;/code&gt;, apart from the buttons, which
get &lt;code&gt;(-webkit-)app-region: no-drag&lt;/code&gt; so they cannot be used to drag.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;#calc_inside.wco,&lt;br /&gt;#calc_solar_cell.wco&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;-webkit-app-region&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; drag&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;app-region&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; drag&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;button&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;-webkit-app-region&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; no-drag&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;app-region&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; no-drag&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The final step is to make the app reactive to window controls overlay changes. In a true progressive
enhancement approach, I only load the code for this feature when the browser supports it.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;windowControlsOverlay&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; navigator&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;/wco.js&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Whenever the window controls overlay geometry changes, I modify the app to make
it look as natural as possible. It is a good idea to debounce this event, since it can be triggered
frequently when the user resizes the window. Namely, I apply the &lt;code&gt;wco&lt;/code&gt; class to some elements, so my
CSS from above kicks in, and I also change the theme color. I can detect if the window controls
overlay is visible by checking the &lt;code&gt;navigator.windowControlsOverlay.visible&lt;/code&gt; property.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; meta &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;meta[name=&quot;theme-color&quot;]&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; nodes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelectorAll&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&#39;#calc_display_surface, #calc_solar_cell, #calc_outside, #calc_inside&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;toggleWCO&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;navigator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;windowControlsOverlay&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;visible&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    meta&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;content &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    meta&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;content &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;#385975&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  nodes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    node&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;classList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toggle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;wco&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; navigator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;windowControlsOverlay&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;visible&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;debounce&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;func&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; wait&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; timeout&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;executedFunction&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;args&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;later&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;clearTimeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;timeout&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;clearTimeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;timeout&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    timeout &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;later&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; wait&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;navigator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;windowControlsOverlay&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ongeometrychange &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;debounce&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;toggleWCO&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;toggleWCO&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Now with all this in place, I get a calculator widget that feels almost like the classic
&lt;a href=&quot;https://en.wikipedia.org/wiki/Winamp&quot; rel=&quot;noopener&quot;&gt;Winamp&lt;/a&gt; with one of the oldschool
&lt;a href=&quot;https://en.wikipedia.org/wiki/Winamp#/media/File:Winamp5.png&quot; rel=&quot;noopener&quot;&gt;Winamp  themes&lt;/a&gt;. I can now
freely place the calculator on my desktop and activate the window controls feature by clicking the
chevron in the upper right corner.&lt;/p&gt;
&lt;img alt=&quot;Designcember Calculator running in standalone mode with the Window Controls Overlay feature active. The display spells &amp;#x27;Google&amp;#x27; in the calculator alphabet.&quot; decoding=&quot;async&quot; height=&quot;430&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 267px) 267px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/9iqLIfTrHYv0O8J1tBrr.png?auto=format&amp;w=534 534w&quot; width=&quot;267&quot; /&gt;
&lt;h2 id=&quot;an-actually-working-solar-cell&quot;&gt;An actually working solar cell &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/designcember-calculator/#an-actually-working-solar-cell&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;For the ultimate geekery, I of course needed to make the solar cell actually work. The calculator
should only be functioning if there is enough light. The way I modeled this is through setting the
CSS &lt;code&gt;opacity&lt;/code&gt; of the digits on the display via a CSS variable &lt;code&gt;--opacity&lt;/code&gt; that I control via
JavaScript.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--opacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0.75&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token selector&quot;&gt;#calc_expression,&lt;br /&gt;#calc_result&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--opacity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;To detect if enough light is available for the calculator to work, I use the
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/AmbientLightSensor&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;AmbientLightSensor&lt;/code&gt;&lt;/a&gt; API. For
this API to be available, I needed to set the &lt;code&gt;#enable-generic-sensor-extra-classes&lt;/code&gt; flag in
&lt;code&gt;about:flags&lt;/code&gt; and request the &lt;code&gt;&#39;ambient-light-sensor&#39;&lt;/code&gt; permission. As before, I use progressive
enhancement to only load the relevant code when the API is supported.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;AmbientLightSensor&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; window&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;/als.js&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The sensor returns the ambient light in &lt;a href=&quot;https://en.wikipedia.org/wiki/Lux&quot; rel=&quot;noopener&quot;&gt;lux&lt;/a&gt; units whenever a
new reading is available. Based on a
&lt;a href=&quot;https://en.wikipedia.org/wiki/Lux#Illuminance&quot; rel=&quot;noopener&quot;&gt;table of values&lt;/a&gt; of typical light situations, I came
up with a very simple formula to convert the lux value to a value between 0 and 1 that I
programmatically assign to the &lt;code&gt;--opacity&lt;/code&gt; variable.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;luxToOpacity&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;lux&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lux &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; lux &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; sensor &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AmbientLightSensor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;sensor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;onreading&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Current light level:&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sensor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;illuminance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;documentElement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;style&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;--opacity&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;luxToOpacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sensor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;illuminance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;sensor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;onerror&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; navigator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;permissions&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;ambient-light-sensor&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;state &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;granted&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    sensor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;In the video below you can see how the calculator starts working once I turn the room light up
enough. And there you have it: a skeuomorphic solar calculator that actually works. My good old
time-tested TI-30X SOLAR has come a long way indeed.&lt;/p&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/lXUTb872NtCdw7fqrQY3.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h2 id=&quot;demo&quot;&gt;Demo &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/designcember-calculator/#demo&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Be sure to play with the &lt;a href=&quot;https://designcember-calculator.glitch.me/&quot; rel=&quot;noopener&quot;&gt;Designcember Calculator demo&lt;/a&gt;
and check out the &lt;a href=&quot;https://glitch.com/edit/#!/designcember-calculator&quot; rel=&quot;noopener&quot;&gt;source code on Glitch&lt;/a&gt;. (To
install the app, you need to open it in its own window. The embedded version below will not trigger
the mini infobar.)&lt;/p&gt;
&lt;!-- Copy and Paste Me --&gt;
&lt;div class=&quot;glitch-embed-wrap&quot; style=&quot;height: 750px; width: 400px;&quot;&gt;
  &lt;iframe src=&quot;https://designcember-calculator.glitch.me/&quot; title=&quot;designcember-calculator on Glitch&quot; allow=&quot;geolocation; microphone; camera; midi; vr; encrypted-media&quot; style=&quot;height: 100%; width: 100%; border: 0;&quot;&gt;
  &lt;/iframe&gt;
&lt;/div&gt;
&lt;p&gt;Happy &lt;a href=&quot;https://designcember.com/&quot; rel=&quot;noopener&quot;&gt;Designcember&lt;/a&gt;!&lt;/p&gt;
</content>
      <author>
          <name>Thomas Steiner</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Community highlight: Miriam Suzanne</title>
      <link href="https://web.dev/docs/community-highlight-miriam-suzanne/"/>
      <updated>2021-12-24T00:00:00Z</updated>
      <id>https://web.dev/docs/community-highlight-miriam-suzanne/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;&lt;em&gt;This post is part of &lt;a href=&quot;https://designcember.com/&quot; rel=&quot;noopener&quot;&gt;Designcember&lt;/a&gt;. A celebration of web design, brought to you by web.dev.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Miriam Suzanne is an author, artist, and web developer in Denver, Colorado. She’s a co-founder of &lt;a href=&quot;https://oddbird.net/&quot; rel=&quot;noopener&quot;&gt;OddBird&lt;/a&gt; (a web agency), staff writer for CSS Tricks, member of the Sass core team, and W3C Invited Expert on the CSS Working Group. Lately she&#39;s been focused on &lt;a href=&quot;https://web.dev/docs/community-highlight-miriam-suzanne/css.oddbird.net&quot;&gt;developing new CSS features&lt;/a&gt; like Cascade Layers, Container Queries, and Scope. Offline, Miriam is a published novelist, playwright, and musician. We talked about her work with Sass and CSS.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Miriam onstage, smiling, lit by a spotlight.&quot; decoding=&quot;async&quot; height=&quot;534&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/waVF92Q2nGF3zqWcRkLc.jpeg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;Photo credit &lt;a href=&quot;https://fromthehipphoto.com/&quot;&gt;From the Hip Photo&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; I first learned about your work due to your grid framework &lt;a href=&quot;https://www.oddbird.net/susy/&quot; rel=&quot;noopener&quot;&gt;Susy&lt;/a&gt;, what led you to create that?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Miriam:&lt;/strong&gt; Back in 2008, layout on the web was a very different experience. Developers had moved away from table layout to more semantic (but still hacky) floated grids. There was a boom in one-size-fits-all 12-column &amp;quot;grid frameworks&amp;quot;–providing a pre-defined (usually static) grid with a set of pre-defined CSS classes. If you needed anything more customizable, you were on your own. It was clear that websites needed to become more responsive, but media-queries weren&#39;t available yet, and there were a load of browser compatibility issues around fluid floats.&lt;/p&gt;
&lt;p&gt;I was using Natalie Downe&#39;s &lt;a href=&quot;https://blog.natbat.net/post/46614243624/css-systems&quot; rel=&quot;noopener&quot;&gt;CSS Systems&lt;/a&gt; approach, which was clever about responding to both font and viewport sizes, but I was frustrated by all the repetitive math and browser hacks required. At the same time, Sass was starting to get some attention, and it fit perfectly for what I needed. The first draft of Susy was very simple: just a couple mixins to do the math and add the hacks I needed. The goal was to be minimal, and only output the essential code. Totally customizable grids, without any predefined classes.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; How did you make the shift from working on a CSS preprocessor to working on CSS specifications? Do you think working on the preprocessor was a good background for specification writing?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Miriam:&lt;/strong&gt; In my experience there is a lot of overlap, and I&#39;m still very active on both sides of that divide. But I think that&#39;s largely thanks to the Sass team in particular, led by &lt;a href=&quot;https://twitter.com/nex3&quot; rel=&quot;noopener&quot;&gt;Natalie Weizenbaum&lt;/a&gt;, which takes a very long-term view—trying to develop tools that integrate smoothly with developing web standards. Pushing beyond one-size-fits-all &amp;quot;opinionated&amp;quot; solutions and building for long-term flexibility is essential when you are thinking about the future of core web standards.&lt;/p&gt;
&lt;p&gt;How can we build tools that respect the diversity of developer needs and approaches, while still encouraging and facilitating accessibility and other important considerations?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; We’ve got a bunch of stuff coming into CSS that essentially replaces functionality that was traditionally part of Sass. Are there strong reasons to still use something like Sass?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Miriam:&lt;/strong&gt; Yes, for some people—but there&#39;s no universal answer here. Take variables for example. Sass variables are lexically scoped, and compiled on the server, with organized data structures like lists and objects, color manipulation, etc. That&#39;s great for design system logic that doesn&#39;t need to run in the browser.&lt;/p&gt;
&lt;p&gt;CSS variables have some overlap, they can also store values, but they provide an entirely different set of cascade-based strengths and weaknesses. Sass can&#39;t handle custom properties, and CSS can&#39;t really handle structured data. Both are useful, and both are powerful—but your specific needs may vary.&lt;/p&gt;
&lt;p&gt;I think it&#39;s great when people can eliminate tools that they no longer need, and some projects might not require both server- and client-side variables. Wonderful! But it&#39;s too simple to assume that means they are identical, and one simply replaces the other. There will always be use-cases for some design logic to happen server-side, and some to happen client-side—even if we get to the point where the languages provide essentially the same features. Pre-processors are with us for the long term.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; Is there anything that has surprised you as you’ve got more involved in the work of creating standards, or anything that you think folk generally might not be aware of about the process?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Miriam:&lt;/strong&gt; Before getting involved, the standards process felt like a mysterious and magical black box, and I wasn&#39;t sure what to expect. I was scared that I might not have enough knowledge of browser-internals to contribute, but the reality is they don&#39;t need more browser engineers. They need more developers and designers who are building websites and applications in the wild.&lt;/p&gt;
&lt;p&gt;I was surprised to find that very few of the people involved are primarily focused on standards, but also very few of them are primarily developing or designing websites. The W3C is made up of &#39;volunteers&#39; from member organizations (often paid by those orgs, but not as their primary job) and membership isn&#39;t cheap. That skews the participants away from day-to-day designers and developers, especially those of us doing client work at small agencies, or freelance. My role as an Invited Expert would be totally volunteer, an expensive hobby, if I hadn&#39;t found outside funding for that work.&lt;/p&gt;
&lt;p&gt;In reality, the process is quite open and public and needs developer involvement–but there are always so many conversations happening at once, it can be hard to find your place. Especially if it&#39;s not your day job.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;To find out how to contribute to the web platform, check out the &lt;a href=&quot;https://wpc.guide/&quot; rel=&quot;noopener&quot;&gt;Web Platform Contribution Guide&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; Container queries have been the holy grail for a lot of web developers for many years. I’m very excited about the fact that we’re getting them. I feel as if a lot of folk are thinking about the utility of container queries—do you feel they have potential to unlock more creativity too?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Miriam:&lt;/strong&gt; Absolutely, though I don&#39;t see those as entirely separate. We all have limited time, and we&#39;re trying to write maintainable and performant code. When something is hard to do practically, we are less likely to get creative with what&#39;s possible.&lt;/p&gt;
&lt;p&gt;Still, the web industry is now dominated by large corporate interests, and so those business concerns always get more airtime than web artists. And I think we lose a lot if we ignore web creativity as a primary use-case for features. I&#39;ve been very excited to see some of the CSS art folks playing with the container query prototype. &lt;a href=&quot;https://jhey.dev/&quot; rel=&quot;noopener&quot;&gt;Jhey Tompkins&lt;/a&gt; built a particularly clever and interactive demo of &lt;a href=&quot;https://jh3y.medium.com/can-we-create-a-resize-hack-with-css-container-queries-e9fc32501293&quot; rel=&quot;noopener&quot;&gt;CSS venetian blinds&lt;/a&gt; as commentary on the old anti-CSS meme. I think there&#39;s a lot more to explore in that space, and I can&#39;t wait to see what else people come up with.&lt;/p&gt;
&lt;p&gt;The conversation has also focused on size-based queries, as the original use-case, but I&#39;m excited to see what people do with style queries–the ability to write conditional styles based on the value of a CSS property or variable. It&#39;s an extremely powerful feature, and so far mostly unexplored. I think it opens up even more creative opportunities!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; Is there anything that we can’t do (or have an upcoming way to do) in CSS that you think would be useful?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Miriam:&lt;/strong&gt; I&#39;m very excited about some other specs I&#39;ve been working on. &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/@layer&quot; rel=&quot;noopener&quot;&gt;Cascade layers&lt;/a&gt; will give authors more control over specificity issues, and Scope should help with more precise selector targeting. But both of those are high-level architectural concerns. The artist in me is more excited for things like CSS toggles, a declarative way to create interactive styles, or container &#39;timelines&#39;, allowing us to smoothly transition values between media or container breakpoints. That has very practical implications for responsive typography, but would also open up a lot of creative opportunities for responsive art and animation.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; Who else is doing really interesting, fun, or creative work on the web right now?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Miriam:&lt;/strong&gt; Oh, I&#39;m not even sure how to answer that, there are so many people doing creative work in such different areas. There&#39;s a lot of exciting standards work in progress from both the CSSWG and Open-UI, including some of your work on fragmentation. But I often find the most inspiration from web artists, and how people are putting these tools into production, in ways that aren&#39;t directly tied to commerce. People like &lt;a href=&quot;https://jhey.dev/&quot; rel=&quot;noopener&quot;&gt;Jhey&lt;/a&gt;, or &lt;a href=&quot;https://lynnandtonic.com/&quot; rel=&quot;noopener&quot;&gt;Lynn Fisher&lt;/a&gt;, or &lt;a href=&quot;https://twitter.com/yuanchuan23&quot; rel=&quot;noopener&quot;&gt;Yuan Chuan&lt;/a&gt;, or many others who are pushing the boundaries of what web technologies can do visually and interactively. Even people doing more business-driven work can learn a lot from their artistic techniques.&lt;/p&gt;
&lt;p&gt;I also appreciate the more conceptual web art of people like &lt;a href=&quot;https://bengrosser.com/&quot; rel=&quot;noopener&quot;&gt;Ben Grosser&lt;/a&gt;, who keeps pushing us to reconsider what we want from the web, and social media in particular. Check out his new &lt;a href=&quot;https://minus.social/&quot; rel=&quot;noopener&quot;&gt;minus.social&lt;/a&gt;, for example.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; Keep up with Miriam’s work on CSS at &lt;a href=&quot;https://css.oddbird.net/&quot; rel=&quot;noopener&quot;&gt;css.oddbird.net&lt;/a&gt; and find out what else she is up to via her website at &lt;a href=&quot;https://miriam.codes/&quot; rel=&quot;noopener&quot;&gt;miriam.codes&lt;/a&gt; and Twitter &lt;a href=&quot;https://twitter.com/TerribleMia&quot; rel=&quot;noopener&quot;&gt;@TerribleMia&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Rachel Andrew</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>How The Economic Times passed Core Web Vitals thresholds and achieved an overall 43% better bounce rate</title>
      <link href="https://web.dev/docs/economic-times-cwv/"/>
      <updated>2021-12-21T00:00:00Z</updated>
      <id>https://web.dev/docs/economic-times-cwv/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;With internet speeds improving day-by-day, users expect websites to respond and behave faster than ever. &lt;a href=&quot;https://m.economictimes.com/&quot; rel=&quot;noopener&quot;&gt;The Economic Times&lt;/a&gt; handles over 45 million monthly active users. By optimizing for Core Web Vitals across the domain, on AMP and non-AMP pages, we managed to significantly reduce bounce rates and improve the reading experience.&lt;/p&gt;
&lt;h2 id=&quot;measuring-the-impact&quot;&gt;Measuring the Impact &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#measuring-the-impact&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We focused on &lt;a href=&quot;https://web.dev/lcp/&quot;&gt;Largest Contentful Paint (LCP)&lt;/a&gt; and&lt;a href=&quot;https://web.dev/cls/&quot;&gt;Cumulative Layout Shift (CLS)&lt;/a&gt;, as they matter the most when it comes to providing a great reading experience to our users. After implementing various performance fixes as described below, The Economic Times managed to improve Chrome User Experients (CrUX) report metrics significantly within a few months.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Overall, CLS improved&lt;/strong&gt; by 250% from 0.25 to 0.09.
&lt;strong&gt;Overall, LCP improved&lt;/strong&gt; by 80% from 4.5 seconds to 2.5 seconds.&lt;/p&gt;
&lt;p&gt;Further, LCP values in the &amp;quot;Poor&amp;quot; range were reduced by 33% from October 2020 to July 2021:&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;LCP distributions grouped by month, starting from October 2020 and ending in July 2021. The amount of LCP values classified as &amp;#x27;Poor&amp;#x27; was reduced from 15.03% to 10.08%.&quot; decoding=&quot;async&quot; height=&quot;477&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/1mrpePbYaQeKbIDJKo8b.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Additionally, CLS values in the &amp;quot;Poor&amp;quot; range were reduced by 65%, and CLS values in the &amp;quot;Good&amp;quot; range increased by 20% in the same timeframe:&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;CLS distributions grouped by month, starting from October 2020 and ending in July 2021. The amount of CLS values classified as &amp;#x27;Poor&amp;#x27; was reduced from 25.92% to 9%, and the amount of CLS values classified as &amp;#x27;Good&amp;#x27; increased from 62.62% to 76.5%.&quot; decoding=&quot;async&quot; height=&quot;463&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/NK3g38biuTH12zGzncHK.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;The result was that The Economic Times—which was previously not meeting CWV thresholds—now passed CWV thresholds across its entire origin and &lt;strong&gt;reduced bounce rates by 43% overall&lt;/strong&gt;.&lt;/p&gt;
&lt;figure class=&quot;w-caption&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/jL3OLOhcWUQDnR4XjewLBx4e3PC3/6C1gW9oQu7Njds1Gdpmv.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption&gt;
    A before and after animation of The Economic Times&#39;s Article page.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;what-is-lcp-and-how-did-we-improve-it&quot;&gt;What is LCP and how did we improve it? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#what-is-lcp-and-how-did-we-improve-it&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The largest element is the most relevant one for improving user experience and recognizing load speed. Performance metrics like &lt;a href=&quot;https://web.dev/fcp/&quot;&gt;First Contentful Paint (FCP)&lt;/a&gt; only capture the very initial experience of page loading. On the other hand, LCP reports the render time of the largest image, text or video section visible to the user.&lt;/p&gt;
&lt;p&gt;In addition to switching to a faster DNS provider and optimizing images, here are some of the techniques we applied we covered to improve LCP.&lt;/p&gt;
&lt;h3 id=&quot;critical-requests-first&quot;&gt;Critical requests first &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#critical-requests-first&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;As all modern browsers limit the concurrent number of requests, developers need to prioritize loading the critical content first. To load a complex web page we need to download assets such as header elements, CSS, JavaScript resources, hero image, article body, comments, other related news, footer, and ads. We evaluated what elements were required for LCP, and provided the preference to load those items first to improve LCP. We also deferred the calls that were not part of the initial page rendering.&lt;/p&gt;
&lt;h3 id=&quot;text-appearance&quot;&gt;Text appearance &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#text-appearance&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We experimented with the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/@font-face/font-display&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;font-display&lt;/code&gt; property&lt;/a&gt; as this impacts both LCP and CLS. We tried &lt;code&gt;font-display: auto;&lt;/code&gt; and then switched to &lt;code&gt;font-display: swap;&lt;/code&gt;. This renders the text initially in the best matching and available font, then switches to the font when it has been downloaded. This resulted in our text rendering quickly, independent of network speed.&lt;/p&gt;
&lt;h3 id=&quot;better-compression&quot;&gt;Better Compression &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#better-compression&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/google/brotli/&quot; rel=&quot;noopener&quot;&gt;Brotli&lt;/a&gt; is an alternative compression algorithm to Gzip and Deflate developed by Google. We replaced our fonts and assets and changed server compression from Gzip to Brotli to achieve a smaller footprint:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Javascript files are 15% smaller than with Gzip.&lt;/li&gt;
&lt;li&gt;HTML files are 18% smaller than with Gzip.&lt;/li&gt;
&lt;li&gt;CSS and font files are 17% smaller than with Gzip.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;preconnect-to-third-party-domains&quot;&gt;Preconnect to third-party domains &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#preconnect-to-third-party-domains&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://web.dev/preconnect-and-dns-prefetch/#establish-early-connections-with-relpreconnect&quot;&gt;&lt;code&gt;preconnect&lt;/code&gt;&lt;/a&gt; should be used carefully as it can still take up valuable CPU time, and delay other important resources, especially on secure connections.&lt;/p&gt;
&lt;p&gt;However, if it&#39;s known that a fetch for a resource on a third-party domain will occur, &lt;code&gt;preconnect&lt;/code&gt; is good. If it only happens occasionally on a high traffic website, &lt;code&gt;preconnect&lt;/code&gt; might trigger unnecessary TCP and TLS work. Thus &lt;a href=&quot;https://web.dev/preconnect-and-dns-prefetch/#resolve-domain-name-early-with-reldns-prefetch&quot;&gt;&lt;code&gt;dns-prefetch&lt;/code&gt;&lt;/a&gt; was a better fit for third-party resources—for example, social media, analytics, etc.—to perform DNS lookups ahead of time.&lt;/p&gt;
&lt;h3 id=&quot;break-up-code-into-chunks&quot;&gt;Break up code into chunks &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#break-up-code-into-chunks&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In the site&#39;s head, we only loaded those resources which contain either an essential part of the business logic or were &lt;a href=&quot;https://github.com/addyosmani/critical&quot; rel=&quot;noopener&quot;&gt;critical&lt;/a&gt; for above the fold page rendering. Furthermore, we split our code into chunks with &lt;a href=&quot;https://loadable-components.com/docs/code-splitting/&quot; rel=&quot;noopener&quot;&gt;code splitting&lt;/a&gt;. This helped us to further improve page LCP.&lt;/p&gt;
&lt;h3 id=&quot;better-caching&quot;&gt;Better caching &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#better-caching&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;For all the front-end routes, we added a &lt;a href=&quot;https://en.wikipedia.org/wiki/Redis&quot; rel=&quot;noopener&quot;&gt;Redis&lt;/a&gt; layer which served templates from the cache. This reduces the computation time on the server and builds the whole UI in each request, thus decreasing LCP in subsequent requests.&lt;/p&gt;
&lt;h3 id=&quot;summarizing-lcp-goals-and-achievements&quot;&gt;Summarizing LCP Goals and achievements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#summarizing-lcp-goals-and-achievements&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Before beginning the optimization project, the team benchmarked their LCP score at &lt;strong&gt;4.5 seconds&lt;/strong&gt; (for the 75th percentile of their users, based on CrUX report field data). After the optimization project, it was reduced to &lt;strong&gt;2.5 seconds&lt;/strong&gt;.&lt;/p&gt;
&lt;figure class=&quot;w-caption&quot;&gt;
  &lt;img alt=&quot;LCP distributions from September 2020 to June 2021. Overall, the 75th percentile of LCP values observed in the Chrome User Experience report showed an 8.97% reduction in &amp;#x27;Poor&amp;#x27; LCP values. The overall decrease in LCP time at the 75th percentile was 200 milliseconds, with 77.63% of LCP values falling in the &amp;#x27;Good&amp;#x27; range.&quot; decoding=&quot;async&quot; height=&quot;596&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/DsNmTCU3JTpWAam7a3df.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    Source: CrUX Report of The Economic Times overall LCP
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;what-is-cls-and-how-did-we-improve-it&quot;&gt;What is CLS and how did we improve it? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#what-is-cls-and-how-did-we-improve-it&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Have you ever noticed any unexpected movement of page content while browsing a website? One cause of this is asynchronous loading of media (images, videos, ads, etc.) on the page with unknown dimensions. As soon as media resources load, they shift the layout of the page.&lt;/p&gt;
&lt;div class=&quot;w-aside w-aside--note&quot;&gt;
&lt;p&gt;For more information on CLS, read the &lt;a href=&quot;https://web.dev/cls/&quot;&gt;CLS metric page&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;We&#39;re going to cover the measures we took to improve CLS on the The Economic Times website.&lt;/p&gt;
&lt;h3 id=&quot;use-placeholders&quot;&gt;Use placeholders &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#use-placeholders&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We used a styled placeholder for ad units and media elements of known dimensions to avoid layout shifts when the ad library loads and renders page ads. This ensures layout shifts are eliminated by reserving space for the ad.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;A side-by-side comparison of The Economic Times website as shown on a mobile phone. At left, a gray placeholder is reserved for the article hero image. At right, the placeholder is replaced with the loaded image.&quot; decoding=&quot;async&quot; height=&quot;647&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/ujvqcVK7usp89zn6njAN.jpg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;defined-container-dimensions&quot;&gt;Defined container dimensions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#defined-container-dimensions&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We specified explicit dimensions for all images and containers so that the browser engine doesn&#39;t need to calculate the DOM elements&#39; width and height once they are available. This avoided unnecessary layout shifts and extra painting work.&lt;/p&gt;
&lt;h3 id=&quot;summarizing-cls-goals-and-achievements&quot;&gt;Summarizing CLS goals and achievements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#summarizing-cls-goals-and-achievements&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Before beginning the optimization project, the team benchmarked their CLS score at &lt;strong&gt;0.25&lt;/strong&gt;. We were able to reduce it significantly by &lt;strong&gt;90%&lt;/strong&gt; to &lt;strong&gt;0.09&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;CLS distributions shown in the Chrome User Experience Report. 76% of CLS values are &amp;#x27;Good&amp;#x27;, 15% are &amp;#x27;Fair&amp;#x27;, and 9% are &amp;#x27;Poor&amp;#x27;. The 75th percentile of user experiences on The Economic Times website overall experienced a CLS of 0.09.&quot; decoding=&quot;async&quot; height=&quot;160&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 694px) 694px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/PvfZtgjSaShtmRASx5Mw.png?auto=format&amp;w=1388 1388w&quot; width=&quot;694&quot; /&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;what-is-first-input-delay-(fid)-and-how-did-we-improve-it&quot;&gt;What is First Input Delay (FID) and how did we improve it? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#what-is-first-input-delay-(fid)-and-how-did-we-improve-it&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://web.dev/fid/&quot;&gt;First Input Delay&lt;/a&gt; is the metric that tracks a website&#39;s responsiveness to user input. The primary cause of a poor FID score is heavy JavaScript work that keeps the browser&#39;s main thread busy, which can delay user interactions. We improved FID in several ways.&lt;/p&gt;
&lt;h3 id=&quot;break-up-long-javascript-tasks&quot;&gt;Break up long JavaScript tasks &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#break-up-long-javascript-tasks&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Long tasks are tasks that are 50 milliseconds or longer. Long tasks occupy the browser&#39;s main thread and prevent it from responding to user input. We broke up long running tasks into smaller tasks where possible on user request, which helped to reduce the Javascript bloat.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;CPU time broken down by activity type in the performance panel of Chrome&amp;#x27;s DevTools. 143 milliseconds was spent scheduling the loading of resources. 4553 milliseconds was spent on JavaScript. 961 milliseconds was spent on rendering work. 191 milliseconds was spent on painting operations. 1488 milliseconds on system tasks, with 3877 milliseconds of idle time. The total timeframe was 11212 milliseconds.&quot; decoding=&quot;async&quot; height=&quot;501&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/rfFVGpifiTIaiMIFpTOv.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;defer-unused-javascript&quot;&gt;Defer unused JavaScript &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#defer-unused-javascript&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We prioritized page content over third-party scripts such as analytics to keep the page more responsive. However, there are certain limitations on some libraries since they need to be loaded in the document &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; in order to accurately track the user journey.&lt;/p&gt;
&lt;h3 id=&quot;reduce-polyfills&quot;&gt;Reduce polyfills &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#reduce-polyfills&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We reduced our dependency on certain polyfills and libraries, since browsers provide support for modern APIs, and less users are using legacy browsers, such as Internet Explorer.&lt;/p&gt;
&lt;h3 id=&quot;lazy-load-ads&quot;&gt;Lazy load ads &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#lazy-load-ads&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Lazily loading below-the-fold ads helped cut down main thread blocking time and thereby improved FID.&lt;/p&gt;
&lt;h3 id=&quot;summarizing-fid-goals-and-achievements&quot;&gt;Summarizing FID goals and achievements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#summarizing-fid-goals-and-achievements&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;From routine experiments, we were able to reduce our FID from 200 ms to under 50 ms today.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;FID distributions shown in the Chrome User Experience Report. 86% of CLS values are &amp;#x27;Good&amp;#x27;, 10% are &amp;#x27;Fair&amp;#x27;, and 4% are &amp;#x27;Poor&amp;#x27;. The 75th percentile of user experiences on The Economic Times website overall experienced a FID of 44 milliseconds.&quot; decoding=&quot;async&quot; height=&quot;190&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 720px) 720px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/bqZP6cbsJhryp5E17dPV.png?auto=format&amp;w=1440 1440w&quot; width=&quot;720&quot; /&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;preventing-regressions&quot;&gt;Preventing regressions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/economic-times-cwv/#preventing-regressions&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Economics Times plans to introduce automated performance checks in production to avoid page performance regressions. They plan to evaluate Lighthouse-CI to automate lab tests, which can prevent regressions on their production branch.&lt;/p&gt;
</content>
      <author>
          <name>Anshu Sharma</name>
        </author><author>
          <name>Sumit Gugnani</name>
        </author><author>
          <name>Prashant Mishra</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>How Terra improved user engagement thanks to Dark Mode</title>
      <link href="https://web.dev/docs/terra-dark-mode/"/>
      <updated>2021-12-18T00:00:00Z</updated>
      <id>https://web.dev/docs/terra-dark-mode/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;Terra, one of Brazil&#39;s largest media companies with 75 million monthly users, reduced the bounce rate by 60% and increased the pages read per session by 170% on desktop for users that prefer dark mode by providing a custom dark theme.&lt;/p&gt;
&lt;p&gt;In this article, we&#39;ll analyze Terra&#39;s journey from identifying the size of the &amp;quot;dark mode&amp;quot; cohort, to applying a custom dark theme, and finally measuring the impact of this implementation on their main KPIs.&lt;/p&gt;
&lt;ul class=&quot;stats&quot;&gt;
  &lt;div class=&quot;stats__item&quot;&gt;
    &lt;p class=&quot;stats__figure&quot;&gt;60&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p&gt;Reduction in Bounce Rates&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;stats__item&quot;&gt;
    &lt;p class=&quot;stats__figure&quot;&gt;170&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p&gt;More pages per session&lt;/p&gt;
  &lt;/div&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;what-is-dark-mode&quot;&gt;What is dark mode? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#what-is-dark-mode&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Historically user interfaces in devices are displayed in &amp;quot;light mode&amp;quot;, which usually means displaying black text on top of light interfaces. The alternative is &amp;quot;dark mode&amp;quot;, with light text on a dark background, such as gray or black.&lt;/p&gt;
&lt;p&gt;Dark Mode has &lt;a href=&quot;https://web.dev/prefers-color-scheme/#why-dark-mode&quot;&gt;benefits&lt;/a&gt; for user experience. Some people prefer it for aesthetic or accessibility reasons. It has  other advantages, such as preserving battery life in devices. Users can express that they prefer dark mode via a setting in their devices, &lt;a href=&quot;https://web.dev/prefers-color-scheme/#activating-dark-mode-in-the-operating-system&quot;&gt;which depends on the operating system&lt;/a&gt;. For example, the following screenshot shows what the &lt;strong&gt;Dark Theme&lt;/strong&gt; configuration option looks like in devices that run &lt;strong&gt;Android Q&lt;/strong&gt;:&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Android Q dark mode settings.&quot; decoding=&quot;async&quot; height=&quot;250&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 218px) 218px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/admin/Yh6SEoWDK1SbqcGjlL6d.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/admin/Yh6SEoWDK1SbqcGjlL6d.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/admin/Yh6SEoWDK1SbqcGjlL6d.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/admin/Yh6SEoWDK1SbqcGjlL6d.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/admin/Yh6SEoWDK1SbqcGjlL6d.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/admin/Yh6SEoWDK1SbqcGjlL6d.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/admin/Yh6SEoWDK1SbqcGjlL6d.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/admin/Yh6SEoWDK1SbqcGjlL6d.png?auto=format&amp;w=436 436w&quot; style=&quot;max-width: 218px; margin: 0 auto;&quot; width=&quot;218&quot; /&gt;
  &lt;figcaption&gt;Android&amp;nbsp;Q dark theme settings.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;To offer a better experience to users who prefer &amp;quot;dark mode&amp;quot;, you can use the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/@media/prefers-color-scheme&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;prefers-color-scheme&lt;/code&gt;&lt;/a&gt; media query, with a value of &lt;code&gt;light&lt;/code&gt; or &lt;code&gt;dark&lt;/code&gt;. This media query reflects the user&#39;s choice in their device. You can then load a &lt;a href=&quot;https://web.dev/prefers-color-scheme/#dark-mode-in-practice&quot;&gt;custom dark theme&lt;/a&gt; for those that prefer dark. For example, by loading a &amp;quot;dark&amp;quot; CSS file, and changing values such as font and background colors. The following code shows an example of that:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;prefers-color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;   // apply a dark theme&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;prefers-color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  // apply a light theme&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;div class=&quot;browser-compat&quot;&gt;
      &lt;span&gt;Browser support:&lt;/span&gt;
      &lt;span class=&quot;browser-compat__icon browser-compat--chrome&quot;&gt;
          &lt;span class=&quot;w-visually-hidden&quot;&gt;chrome 76, Supported&lt;/span&gt;
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__version browser-compat--true&quot;&gt;
        76
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__icon browser-compat--firefox&quot;&gt;
          &lt;span class=&quot;w-visually-hidden&quot;&gt;firefox 67, Supported&lt;/span&gt;
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__version browser-compat--true&quot;&gt;
        67
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__icon browser-compat--edge&quot;&gt;
          &lt;span class=&quot;w-visually-hidden&quot;&gt;edge 79, Supported&lt;/span&gt;
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__version browser-compat--true&quot;&gt;
        79
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__icon browser-compat--safari&quot;&gt;
          &lt;span class=&quot;w-visually-hidden&quot;&gt;safari 12.1, Supported&lt;/span&gt;
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__version browser-compat--true&quot;&gt;
        12.1
      &lt;/span&gt;
&lt;p&gt;&lt;span class=&quot;browser-compat__link&quot;&gt;
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/@media/prefers-color-scheme#browser_compatibility&quot; target=&quot;_blank&quot;&gt;
Source
&lt;/a&gt;
&lt;/span&gt;
&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;This article will only cover the technique of applying a custom dark theme, provided by the developer. Chrome 96 has introduced an &lt;a href=&quot;https://developer.chrome.com/blog/auto-dark-theme/#sign-up-for-the-origin-trial&quot; rel=&quot;noopener&quot;&gt;origin trial&lt;/a&gt; for &amp;quot;Auto Dark Themes&amp;quot; on Android, for which the browser applies an automatically generated dark theme to light themed sites, when the user has opted into dark themes in the operating system, without requiring the developer to provide styles for it. For more information about &amp;quot;Chrome Auto Dark Mode&amp;quot;, check out &lt;a href=&quot;https://developer.chrome.com/blog/auto-dark-theme/&quot; rel=&quot;noopener&quot;&gt;this article&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;identifying-the-&amp;quot;prefers-light&amp;quot;-vs-&amp;quot;dark&amp;quot;-user-cohorts&quot;&gt;Identifying the &amp;quot;prefers light&amp;quot; vs &amp;quot;dark&amp;quot; user cohorts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#identifying-the-%22prefers-light%22-vs-%22dark%22-user-cohorts&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;At the time of writing (December 2021), &lt;a href=&quot;https://chromestatus.com/features&quot; rel=&quot;noopener&quot;&gt;Chrome Platform Status&lt;/a&gt; determines that approximately &lt;a href=&quot;https://chromestatus.com/metrics/feature/timeline/popularity/3581&quot; rel=&quot;noopener&quot;&gt;22% of the web traffic&lt;/a&gt; comes from users with the &amp;quot;prefer dark&amp;quot; setting.&lt;/p&gt;
&lt;p&gt;This is aggregated data, so the real percentage of users who prefer dark that come to a site can vary. For that reason, to understand the size of this group it is advisable to run in house measurement.&lt;/p&gt;
&lt;p&gt;The following code creates an analytics dimension, to measure the performance of users that prefer &lt;code&gt;light&lt;/code&gt; vs. &lt;code&gt;dark&lt;/code&gt;:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getColorScheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; colorScheme &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Unknown&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;matchMedia&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;matchMedia&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;(prefers-color-scheme: dark)&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;matches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;            colorScheme &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Dark&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;matchMedia&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;(prefers-color-scheme: light)&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;matches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;            colorScheme &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Light&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; colorScheme&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ga&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ga&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ga&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;q&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ga&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;q&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;arguments&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;ga&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;l&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ga&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;create&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;UA-ID&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;auto&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;ga&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;set&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;color-scheme-preference&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getColorScheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;ga&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;send&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;pageview&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Terra implemented this code in their site and compared the behavior of both groups in mobile (Android) and desktop (Windows) devices. At that moment Terra wasn&#39;t providing a custom dark theme, so the goals of this experiment were:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Determining the size of the group of users who prefer dark.&lt;/li&gt;
&lt;li&gt;Identifying patterns: for example, do users that prefer dark leave the site more quickly compared to those that prefer light?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Knowing this can inform decisions, for example: if it&#39;s necessary to provide a custom dark theme.
These are the results Terra obtained after testing for 14 days:&lt;/p&gt;
&lt;h3 id=&quot;mobile-(android)&quot;&gt;Mobile (Android) &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#mobile-(android)&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In the case of mobile (Android) the numbers for bounce rate and pages per session didn&#39;t show big differences between the users that prefer &amp;quot;light&amp;quot;, compared to those that prefer &amp;quot;dark&amp;quot;:&lt;/p&gt;
&lt;div class=&quot;table-wrapper scrollbar&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Display Mode&lt;/th&gt;
        &lt;th&gt;Bounce Rate&lt;/th&gt;
        &lt;th&gt;Pages Per Session&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;Prefers Light&lt;/td&gt;
        &lt;td&gt;25.84%&lt;/td&gt;
        &lt;td&gt;3.96&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Prefers Dark&lt;/td&gt;
        &lt;td&gt;26.10%&lt;/td&gt;
        &lt;td&gt;3.75&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&quot;desktop-(windows)&quot;&gt;Desktop (Windows) &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#desktop-(windows)&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In the case of desktop (Windows), the group of users that preferred &amp;quot;dark&amp;quot; stayed much less on the site: they had almost &lt;strong&gt;twice the bounce rate and read a little more than half of the pages&lt;/strong&gt; than those users that preferred &amp;quot;light&amp;quot;:&lt;/p&gt;
&lt;div class=&quot;table-wrapper scrollbar&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Display Mode&lt;/th&gt;
        &lt;th&gt;Bounce Rate&lt;/th&gt;
        &lt;th&gt;Pages Per Session&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;Prefers Light&lt;/td&gt;
        &lt;td&gt;13.20%&lt;/td&gt;
        &lt;td&gt;7.42&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Prefers Dark&lt;/td&gt;
        &lt;td&gt;24.12%&lt;/td&gt;
        &lt;td&gt;4.68&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;Based on this data, Terra hypothesized that users who prefer &amp;quot;dark&amp;quot; stay less in desktop devices, due to the lack of support of a dark theme in their site.&lt;/p&gt;
&lt;p&gt;As a next step Terra decided to work on a &amp;quot;dark theme&amp;quot; strategy to see if they could improve the engagement for the group of users that preferred dark.&lt;/p&gt;
&lt;h2 id=&quot;implementing-a-dark-theme&quot;&gt;Implementing a dark theme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#implementing-a-dark-theme&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Most websites implement a dark theme by using the simple strategy shown previously of listening to user&#39;s configuration changes via the &lt;a href=&quot;https://drafts.csswg.org/mediaqueries-5/#prefers-color-scheme&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;prefers-color-scheme&lt;/code&gt;&lt;/a&gt; media query and changing styles based on that.&lt;/p&gt;
&lt;p&gt;Terra decided to give more control to the user: when they detect that they have the &amp;quot;prefer dark&amp;quot; setting turned on in their devices (via the media query), they show them a prompt to ask them if they want to navigate in &amp;quot;night mode&amp;quot;. As long as the user doesn&#39;t deny the prompt (by clicking on the &amp;quot;Ignore&amp;quot; button), they honor the user&#39;s OS-setting, and apply a custom dark theme:&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Screenshot of Terra&amp;#x27;s light theme prompting the user to accept dark mode.&quot; decoding=&quot;async&quot; height=&quot;146&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 266px) 266px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/TRqfCAmBe025456JyX1b.png?auto=format&amp;w=532 532w&quot; style=&quot;max-width: 266px; margin: 0 auto;&quot; width=&quot;266&quot; /&gt;
  &lt;figcaption&gt;Terra shows a prompt to the user asking if they want to navigate in dark mode after detecting that they prefer dark in their devices.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;As a complement of this strategy they provide additional configuration options in the &amp;quot;settings&amp;quot; screen, where the user can decide if they explicitly prefer &amp;quot;light&amp;quot;, &amp;quot;dark&amp;quot;, or want to rely on the underlying device settings.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Screenshots of Terra&amp;#x27;s configuration screen to opt in and out of dark mode.&quot; decoding=&quot;async&quot; height=&quot;417&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 480px) 480px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/B7g0uvq2QB0eWVjnuMAl.png?auto=format&amp;w=960 960w&quot; style=&quot;max-width: 480px; margin: 0 auto;&quot; width=&quot;480&quot; /&gt;
  &lt;figcaption&gt;Terra&#39;s themes configurations allow users to choose between &quot;Dark&quot; and &quot;Light&quot; themes or rely on the device&#39;s settings.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This is how Terra&#39;s &amp;quot;Night Mode&amp;quot; looks like:&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Screenshot of Terra&amp;#x27;s dark theme.&quot; decoding=&quot;async&quot; height=&quot;468&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 286px) 286px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/26V1DWN36MZr3mUo8ChSBlCpzp43/QRW06FYeMghUI8obAQWC.png?auto=format&amp;w=572 572w&quot; style=&quot;max-width: 286px; margin: 0 auto;&quot; width=&quot;286&quot; /&gt;
  &lt;figcaption&gt;Terra&#39;s dark theme, &quot;Night Mode&quot;.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;We have used mobile screenshots for simplicity, but Terra has applied the same strategy across mobile and desktop devices.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;measuring-the-impact-of-terra&#39;s-dark-theme&quot;&gt;Measuring the impact of Terra&#39;s dark theme &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#measuring-the-impact-of-terra&#39;s-dark-theme&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To measure the impact of the dark theme, Terra took the group of users that have the &amp;quot;Prefer Dark&amp;quot; setting turned on in their devices and compared engagement metrics when showing a &amp;quot;Light&amp;quot; vs. a &amp;quot;DarK&amp;quot; theme.
Here are the results for mobile (Android) and desktop (Windows):&lt;/p&gt;
&lt;h3 id=&quot;mobile-(android)-2&quot;&gt;Mobile (Android) &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#mobile-(android)-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;While bounce rates remained similar, pages and sessions almost doubled (from 2.47 to 5.24) when users were exposed to a dark theme:&lt;/p&gt;
&lt;div class=&quot;table-wrapper scrollbar&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Display Mode&lt;/th&gt;
        &lt;th&gt;Bounce Rate&lt;/th&gt;
        &lt;th&gt;Pages Per Session&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;Prefers Light&lt;/td&gt;
        &lt;td&gt;26.91%&lt;/td&gt;
        &lt;td&gt;2.47&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Prefers Dark&lt;/td&gt;
        &lt;td&gt;23.91%&lt;/td&gt;
        &lt;td&gt;5.24&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;ul class=&quot;stats&quot;&gt;
  &lt;div class=&quot;stats__item&quot;&gt;
    &lt;p class=&quot;stats__figure&quot;&gt;2&lt;sub&gt;X&lt;/sub&gt;&lt;/p&gt;
    &lt;p&gt;More pages per session&lt;/p&gt;
  &lt;/div&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;desktop-(windows)-2&quot;&gt;Desktop (Windows) &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#desktop-(windows)-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Both metrics improved when showing a dark theme: bounce rates went from 27.25% to 10.82% and pages per session almost tripled (from 3.7 to 9.99).&lt;/p&gt;
&lt;div class=&quot;table-wrapper scrollbar&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Display Mode&lt;/th&gt;
        &lt;th&gt;Bounce Rate&lt;/th&gt;
        &lt;th&gt;Pages Per Session&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;Prefers Light&lt;/td&gt;
        &lt;td&gt;27.5%&lt;/td&gt;
        &lt;td&gt;3.7&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Prefers Dark&lt;/td&gt;
        &lt;td&gt;10.82%&lt;/td&gt;
        &lt;td&gt;9.99&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;ul class=&quot;stats&quot;&gt;
  &lt;div class=&quot;stats__item&quot;&gt;
    &lt;p class=&quot;stats__figure&quot;&gt;60&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p&gt;Reduction in Bounce Rates&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;stats__item&quot;&gt;
    &lt;p class=&quot;stats__figure&quot;&gt;170&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p&gt;More pages per session&lt;/p&gt;
  &lt;/div&gt;
&lt;/ul&gt;
&lt;p&gt;Based on this data, Terra could confirm the benefits for the users from implementing a dark theme, and has decided to continue maintaining it as a core feature of the site.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/terra-dark-mode/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Dark Mode is a preference that users can turn on in their devices  to change the style of the screens into dark themes. This technique has reported benefits from the user experience and for different aspects of the user&#39;s devices such as saving  battery life.&lt;/p&gt;
&lt;p&gt;In this article we saw how providing a custom dark theme improved engagement metrics for the group of Terra&#39;s users that have the preferred dark mode setting turned on in their devices.&lt;/p&gt;
&lt;p&gt;For companies with the resources to implement an alternative dark theme this is the recommended approach. For those that don&#39;t have the time to invest in such a feature, Chrome is starting to roll out an &lt;a href=&quot;https://developer.chrome.com/blog/auto-dark-theme/&quot; rel=&quot;noopener&quot;&gt;Auto Dark Mode feature&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Demian Renzulli</name>
        </author><author>
          <name>André Cipriani Bandarra</name>
        </author><author>
          <name>Guilherme Moser de Souza</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>State of CSS 2021</title>
      <link href="https://web.dev/docs/state-of-css-2021/"/>
      <updated>2021-12-17T00:00:00Z</updated>
      <id>https://web.dev/docs/state-of-css-2021/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;The &lt;a href=&quot;https://2021.stateofcss.com/en-US/&quot; rel=&quot;noopener&quot;&gt;State of CSS 2021&lt;/a&gt; survey ran for the third year in a row, and reached over 8,000 developers worldwide. Let&#39;s  look at some of the results and how they map to plans browsers have for adding CSS features in 2022.&lt;/p&gt;
&lt;h1&gt;Feature usage and awareness&lt;/h1&gt;
&lt;p&gt;For some features, there&#39;s a clear trend in usage and awareness year-over-year. &lt;a href=&quot;https://2021.stateofcss.com/en-US/features/layout/#grid&quot; rel=&quot;noopener&quot;&gt;CSS grid&lt;/a&gt; is an example of this.&lt;/p&gt;
&lt;img alt=&quot;Awareness of CSS Grid in State of CSS over time. The usage has grown from 55% to 83% between 2019 and 2021.&quot; decoding=&quot;async&quot; height=&quot;360&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/i1D3fea4SShlOWR9GvCYL83Xw822/JCCwRm9rKUZQikjZhiXj.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;This matches the trend for CSS Grid in the &lt;a href=&quot;https://almanac.httparchive.org/en/2021/css#flexbox-and-grid-adoption&quot; rel=&quot;noopener&quot;&gt;2021 Web Almanac&lt;/a&gt; and in Chrome&#39;s &lt;a href=&quot;https://www.chromestatus.com/metrics/feature/timeline/popularity/1693&quot; rel=&quot;noopener&quot;&gt;usage metrics&lt;/a&gt;.
If you haven&#39;t used CSS Grid, now is a great time to &lt;a href=&quot;https://web.dev/learn/css/grid/&quot;&gt;learn it&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;As more developers use grid, &lt;a href=&quot;https://2021.stateofcss.com/en-US/features/layout/#subgrid&quot; rel=&quot;noopener&quot;&gt;awareness of subgrid&lt;/a&gt; is also growing. Subgrid is already available in Firefox and will land in Chrome as part of the work by the Microsoft Team on &lt;a href=&quot;https://blogs.windows.com/msedgedev/2021/08/10/compat2021-css-grid-gridng/&quot; rel=&quot;noopener&quot;&gt;GridNG&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Other features with strong growth in usage and awareness are
&lt;a href=&quot;https://2021.stateofcss.com/en-US/features/layout/#aspect_ratio&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;aspect-ratio&lt;/code&gt;&lt;/a&gt;, &lt;a href=&quot;https://2021.stateofcss.com/en-US/features/interactions/#scroll_snap&quot; rel=&quot;noopener&quot;&gt;scroll snap&lt;/a&gt;, and &lt;a href=&quot;https://2021.stateofcss.com/en-US/features/other-features/#variables&quot; rel=&quot;noopener&quot;&gt;custom properties&lt;/a&gt;.&lt;/p&gt;
&lt;h1&gt;Browser compatibility&lt;/h1&gt;
&lt;p&gt;Browser compatibility is a common pain point for web developers and, to learn more about what CSS features cause the most issues, the survey asked, &amp;quot;Are there any CSS features you have difficulties using because of differences between browsers?&amp;quot;&lt;/p&gt;
&lt;img alt=&quot;Survey results for features with differences between browsers. The top three responses are grid, flexbox gap, and subgrid.&quot; decoding=&quot;async&quot; height=&quot;909&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/rjslQmdTEZr8lNz0EbHC.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt; 
&lt;p&gt;Survey results like these help guide prioritization for browser vendors. Many of the features are part of the &lt;a href=&quot;https://web.dev/compat2021-holiday-update/&quot;&gt;Compat 2021 effort&lt;/a&gt; based on the &lt;a href=&quot;https://insights.developer.mozilla.org/reports/mdn-browser-compatibility-report-2020.html&quot; rel=&quot;noopener&quot;&gt;MDN Browser Compatibility Report 2020&lt;/a&gt;, and others like subgrid are now being &lt;a href=&quot;https://github.com/web-platform-tests/interop-2022/issues/1&quot; rel=&quot;noopener&quot;&gt;proposed&lt;/a&gt; as focus areas for Interop 2022.&lt;/p&gt;
&lt;h1&gt;What&#39;s missing in CSS?&lt;/h1&gt;
&lt;p&gt;The survey also asked, &amp;quot;Which feature would you most like to be able to use in CSS today?&amp;quot;&lt;/p&gt;
&lt;img alt=&quot;Survey results for the question what&amp;#x27;s missing in CSS. The top three responses are container queries, parent selector, and browser support.&quot; decoding=&quot;async&quot; height=&quot;617&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/cZesmseagvBYouHVaRJO.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Container Queries was the overall &amp;quot;winner&amp;quot;, matching the &lt;a href=&quot;https://2020.stateofcss.com/en-US/opinions/#currently_missing_from_css&quot; rel=&quot;noopener&quot;&gt;2020 results&lt;/a&gt;. Container queries enable &lt;a href=&quot;https://web.dev/new-responsive/&quot;&gt;component-based responsive&lt;/a&gt; design by allowing elements to query their parent selector for style changes. This is a much more local, specified scope than is currently possible with media queries.&lt;/p&gt;
&lt;p&gt;Chrome is currently working on an experimental implementation, and funding the work of &lt;a href=&quot;https://twitter.com/TerribleMia/&quot; rel=&quot;noopener&quot;&gt;Miriam Suzanne&lt;/a&gt;, as she develops the &lt;a href=&quot;https://drafts.csswg.org/css-contain-3/&quot; rel=&quot;noopener&quot;&gt;specification&lt;/a&gt; in the CSS Working Group. You can try it out by going to &lt;code&gt;about:flags&lt;/code&gt;, searching for, and enabling, the &lt;strong&gt;Container Queries&lt;/strong&gt; flag in Canary, or by using the &lt;a href=&quot;https://www.npmjs.com/package/container-query-polyfill&quot; rel=&quot;noopener&quot;&gt;container query polyfill&lt;/a&gt;. You can learn more about container queries, as well as see some demos that use them in the latest series of &lt;a href=&quot;https://www.youtube.com/watch?v=gCNMyYr7F6w&amp;amp;list=PLNYkxOF6rcIDI0QtJvW6vKonTxn6azCsD&amp;amp;index=14&quot; rel=&quot;noopener&quot;&gt;Designing in the Browser&lt;/a&gt; or trying them yourself &lt;a href=&quot;https://codepen.io/web-dot-dev/pen/LYzxgxP&quot; rel=&quot;noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;youtube&quot;&gt;  &lt;lite-youtube videoid=&quot;gCNMyYr7F6w&quot;&gt;  &lt;/lite-youtube&gt;&lt;/div&gt;
&lt;h1&gt;Learn more&lt;/h1&gt;
&lt;p&gt;Please see the &lt;a href=&quot;https://2021.stateofcss.com/en-US/&quot; rel=&quot;noopener&quot;&gt;full report&lt;/a&gt; to learn more, see recommended resources, or dig into the data yourself.&lt;/p&gt;
&lt;p&gt;Thanks to &lt;a href=&quot;https://sachagreif.com/&quot; rel=&quot;noopener&quot;&gt;Sacha Greif&lt;/a&gt; for running the survey, and to the over 8,000 web developers who generously took the time to answer it.&lt;/p&gt;
</content>
      <author>
          <name>Philip Jägenstedt</name>
        </author><author>
          <name>Rachel Andrew</name>
        </author><author>
          <name>Una Kravets</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Deep-copying in JavaScript using structuredClone</title>
      <link href="https://web.dev/docs/structured-clone/"/>
      <updated>2021-12-16T00:00:00Z</updated>
      <id>https://web.dev/docs/structured-clone/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;For the longest time, you had to resort to workarounds and libraries to create a deep copy of a JavaScript value. The Platform now ships with &lt;code&gt;structuredClone()&lt;/code&gt;, a built-in function for deep-copying.&lt;/p&gt;
&lt;div class=&quot;browser-compat&quot;&gt;
      &lt;span&gt;Browser support:&lt;/span&gt;
      &lt;span class=&quot;browser-compat__icon browser-compat--chrome&quot;&gt;
          &lt;span class=&quot;w-visually-hidden&quot;&gt;chrome, Not supported&lt;/span&gt;
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__version browser-compat--false&quot;&gt;
        ×
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__icon browser-compat--firefox&quot;&gt;
          &lt;span class=&quot;w-visually-hidden&quot;&gt;firefox 94, Supported&lt;/span&gt;
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__version browser-compat--true&quot;&gt;
        94
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__icon browser-compat--edge&quot;&gt;
          &lt;span class=&quot;w-visually-hidden&quot;&gt;edge, Not supported&lt;/span&gt;
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__version browser-compat--false&quot;&gt;
        ×
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__icon browser-compat--safari&quot;&gt;
          &lt;span class=&quot;w-visually-hidden&quot;&gt;safari preview, Supported&lt;/span&gt;
      &lt;/span&gt;
      &lt;span class=&quot;browser-compat__version browser-compat--true&quot;&gt;
        preview
      &lt;/span&gt;
&lt;p&gt;&lt;span class=&quot;browser-compat__link&quot;&gt;
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/structuredClone#browser_compatibility&quot; target=&quot;_blank&quot;&gt;
Source
&lt;/a&gt;
&lt;/span&gt;
&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;At the time of writing, &lt;em&gt;all browsers&lt;/em&gt; have  implemented this API in their nightly releases, Firefox has shipped it to stable in Firefox 94. Additionally, Node 17 and Deno 1.14 have implemented this API. &lt;em&gt;You can start using this function right now&lt;/em&gt; and not feel bad about it.&lt;/p&gt;
&lt;h2 id=&quot;shallow-copies&quot;&gt;Shallow copies &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/structured-clone/#shallow-copies&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Copying a value in JavaScript is almost always &lt;em&gt;shallow&lt;/em&gt;, as opposed to &lt;em&gt;deep&lt;/em&gt;.  That means that changes to deeply nested values will be visible in the copy as well as the original.&lt;/p&gt;
&lt;p&gt;One way to create a shallow copy in JavaScript using the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/Spread_syntax&quot; rel=&quot;noopener&quot;&gt;object spread operator&lt;/a&gt; &lt;code&gt;...&lt;/code&gt;:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; myOriginal &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  someProp&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;with a string value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  anotherProp&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    withAnotherProp&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    andAnotherProp&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; myShallowCopy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;myOriginal&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Adding or changing a property directly on the shallow copy will only affect the copy, not the original:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;myShallowCopy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;aNewProp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;a new value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;myOriginal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;aNewProp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// ^ logs `undefined`&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;However, adding or changing a deeply nested property affects &lt;em&gt;both&lt;/em&gt; the copy and the original:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;myShallowCopy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;anotherProp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;aNewProp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;a new value&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;myOriginal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;anotherProp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;aNewProp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// ^ logs `a new value`&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The expression &lt;code&gt;{...myOriginal}&lt;/code&gt; iterates over the (enumerable) properties of &lt;code&gt;myOriginal&lt;/code&gt; using the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/Spread_syntax&quot; rel=&quot;noopener&quot;&gt;Spread Operator&lt;/a&gt;. It uses the property name and value, and assigns them one by one to a freshly created, empty object. As such, the resulting object is identical in shape, but with its own copy of the list of properties and values. The values are copied, too, but so-called primitive values are handled differently by the JavaScript value than non-primitive values. To quote &lt;a href=&quot;https://developer.mozilla.org/docs/Glossary/Primitive&quot; rel=&quot;noopener&quot;&gt;MDN&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In JavaScript, a primitive (primitive value, primitive data type) is data that is not an object and has no methods. There are seven primitive data types: string, number, bigint, boolean, undefined, symbol, and null.&lt;/p&gt;
&lt;p&gt;&lt;cite&gt;MDN — Primitive&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Non-primitive values are handled as &lt;em&gt;references&lt;/em&gt;, meaning that the act of copying the value is really just copying a reference to the same underlying object, resulting in the shallow copy behavior.&lt;/p&gt;
&lt;h2 id=&quot;deep-copies&quot;&gt;Deep copies &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/structured-clone/#deep-copies&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The opposite of a shallow copy is a deep copy. A deep copy algorithm also copies an object’s properties one by one, but invokes itself recursively when it finds a reference to another object, creating a copy of that object as well. This can be very important to make sure that two pieces of code don’t accidentally share an object and unknowingly manipulate each others’ state.&lt;/p&gt;
&lt;p&gt;There used to be no easy or nice way to create a deep-copy of a value in JavaScript. Many people relied on third-party libraries like &lt;a href=&quot;https://lodash.com/docs/#cloneDeep&quot; rel=&quot;noopener&quot;&gt;Lodash’s &lt;code&gt;cloneDeep()&lt;/code&gt;&lt;/a&gt;  function. Arguably the most common solution to this problem was a JSON-based hack:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; myDeepCopy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;myOriginal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;In fact, this was such a popular workaround, that &lt;a href=&quot;https://v8.dev/blog/cost-of-javascript-2019#json&quot; rel=&quot;noopener&quot;&gt;V8 aggressively optimized&lt;/a&gt; &lt;code&gt;JSON.parse()&lt;/code&gt; and specifically the pattern above to make it as fast as possible. And while it is fast, it comes with a couple of shortcomings and tripwires:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Recursive data structures&lt;/strong&gt;: &lt;code&gt;JSON.stringify()&lt;/code&gt; will throw when you give it a recursive data structure. This can happen quite easily when working with linked lists or trees.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Built-in types&lt;/strong&gt;: &lt;code&gt;JSON.stringify()&lt;/code&gt; will throw if the value contains other JS built-ins like &lt;code&gt;Map&lt;/code&gt;, &lt;code&gt;Set&lt;/code&gt;, &lt;code&gt;Date&lt;/code&gt;, &lt;code&gt;RegExp&lt;/code&gt; or &lt;code&gt;ArrayBuffer&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Functions&lt;/strong&gt;: &lt;code&gt;JSON.stringify()&lt;/code&gt; will quietly discard functions.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;structured-cloning&quot;&gt;Structured cloning &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/structured-clone/#structured-cloning&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The platform already needed the ability to create deep copies of JavaScript values in a couple of places: Storing a JS value in IndexedDB requires some form of serialization so it can be stored on disk and later deserialized to restore the JS value. Similarly, sending messages to a WebWorker via &lt;code&gt;postMessage()&lt;/code&gt; requires transferring a JS value from one JS realm to another. The algorithm that is used for this is called “Structured Clone”, and until recently, wasn’t easily accessible to developers.&lt;/p&gt;
&lt;p&gt;That has now changed! The HTML spec was amended to expose a function called &lt;code&gt;structuredClone()&lt;/code&gt; that runs exactly that algorithm as a means for developers to easily create deep copies of JavaScript values.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; myDeepCopy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;structuredClone&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;myOriginal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;That’s it! That’s the entire API. If you want to dive deeper into the details, take a look at the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/structuredClone&quot; rel=&quot;noopener&quot;&gt;MDN article&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;features-and-limitations&quot;&gt;Features and limitations &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/structured-clone/#features-and-limitations&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Structured cloning addresses many (although not all) shortcomings of the &lt;code&gt;JSON.stringify()&lt;/code&gt; technique. Structured cloning can handle cyclical data structures, support many built-in data types and is generally more robust and often faster.&lt;/p&gt;
&lt;p&gt;However, it still has some limitations that may catch you off-guard:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Prototypes&lt;/strong&gt;: If you use &lt;code&gt;structuredClone()&lt;/code&gt; with a class instance, you’ll get a plain object as the return
value, as structured cloning discards the object’s prototype chain.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Functions&lt;/strong&gt;: If your object contains functions, they will be &lt;em&gt;quietly&lt;/em&gt; discarded.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Non-cloneables&lt;/strong&gt;: Some values are not structured cloneable, most notably &lt;code&gt;Error&lt;/code&gt; and DOM nodes. It
will cause &lt;code&gt;structuredClone()&lt;/code&gt; to throw.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If any of these limitations are a deal-breaker for your use-case, libraries like Lodash still provide custom implementations of other deep-cloning algorithms that may or may not fit your use-case.&lt;/p&gt;
&lt;h3 id=&quot;performance&quot;&gt;Performance &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/structured-clone/#performance&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;While I haven’t done a new micro-benchmark comparison, &lt;a href=&quot;https://surma.dev/things/deep-copy/index.html&quot; rel=&quot;noopener&quot;&gt;I did a comparison in early 2018&lt;/a&gt;, before &lt;code&gt;structuredClone()&lt;/code&gt; was exposed. Back then, &lt;code&gt;JSON.parse()&lt;/code&gt; was the fastest option for very small objects. I expect that to remain the same. Techniques that relied on structured cloning were (significantly) faster for bigger objects. Considering that the new &lt;code&gt;structuredClone()&lt;/code&gt; comes without the overhead of abusing other APIs and is more robust  than &lt;code&gt;JSON.parse()&lt;/code&gt;, I recommend you make it your default approach for creating deep copies.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/structured-clone/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If you need to create a deep-copy of a value in JS—maybe that be because you use immutable data structures or you want to make sure a function can manipulate an object without affecting the original—you no longer need to reach for workarounds or libraries. The JS ecosystem now has &lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/structuredClone&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;structuredClone()&lt;/code&gt;&lt;/a&gt;. Huzzah.&lt;/p&gt;
</content>
      <author>
          <name>Surma</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Control how your app is launched</title>
      <link href="https://web.dev/docs/launch-handler/"/>
      <updated>2021-12-14T00:00:00Z</updated>
      <id>https://web.dev/docs/launch-handler/</id>
      <content type="text/html" mode="escaped">&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The Launch Handler API is part of the &lt;a href=&quot;https://web.dev/fugu-status/&quot;&gt;capabilities project&lt;/a&gt; and is
currently in development. This post will be updated as the implementation progresses.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;what&quot;&gt;What is the Launch Handler API? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#what&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There are many ways to launch a Progressive Web App. Probably the most common is via the icon on the
home screen or the app drawer of the device. But when you think about it, there are many other ways
a launch can happen:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A share action when the app is a
&lt;a href=&quot;https://web.dev/web-share-target/&quot;&gt;share target&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;A user click in the file explorer opening the PWA, which
acts as a &lt;a href=&quot;https://web.dev/file-handling/&quot;&gt;file handler&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;A registered &lt;a href=&quot;https://web.dev/protocol-handling/&quot;&gt;protocol handler&lt;/a&gt; that the PWA may launch as the
result of a matching protocol.&lt;/li&gt;
&lt;li&gt;A click on a
&lt;a href=&quot;https://web.dev/push-notifications-overview/&quot;&gt;push notification&lt;/a&gt; or an &lt;a href=&quot;https://web.dev/app-shortcuts/&quot;&gt;app icon shortcut&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There are even more ways, but you get the idea. Given the manifold possibilities for launching PWAs,
what has been missing is a way to let apps customize their launch behavior across all types of app
launch triggers. The &lt;code&gt;launch_handler&lt;/code&gt; manifest member together with the &lt;code&gt;window.launchQueue&lt;/code&gt;
interface enables PWAs to do just that.&lt;/p&gt;
&lt;h3 id=&quot;use-cases&quot;&gt;Suggested use cases for the Launch Handler API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#use-cases&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Examples of sites that may use this API include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Apps that prefer to only have a single instance of themselves open at any time, with new
navigations focusing the existing instance. Examples include apps like music players or games,
where it generally makes sense to only have one instance of the app open at any time.&lt;/li&gt;
&lt;li&gt;Apps that enable multi-document management, but within their own single instance, for example, an
HTML-implemented tab strip, floating sub-windows, or apps using
&lt;a href=&quot;https://web.dev/tabbed-application-mode/&quot;&gt;tabbed application mode&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;status&quot;&gt;Current status &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#status&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Step&lt;/th&gt;
&lt;th&gt;Status&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1. Create explainer&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/WICG/sw-launch/blob/main/launch_handler.md&quot; rel=&quot;noopener&quot;&gt;Complete&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2. Create initial draft of specification&lt;/td&gt;
&lt;td&gt;Not started&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3. Gather feedback &amp;amp; iterate on design&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://web.dev/docs/launch-handler/#feedback&quot;&gt;In progress&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4. &lt;strong&gt;Origin trial&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://developer.chrome.com/origintrials/#/view_trial/2978005253598740481&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;Started&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5. Launch&lt;/td&gt;
&lt;td&gt;Not started&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;use&quot;&gt;How to use the Launch Handler API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#use&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;enabling-via-about:flags&quot;&gt;Enabling via about://flags &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#enabling-via-about:flags&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To experiment with the Launch Handler API locally, without an origin trial token, enable the
&lt;code&gt;#enable-desktop-pwas-launch-handler&lt;/code&gt; flag in &lt;code&gt;about://flags&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;enabling-support-during-the-origin-trial-phase&quot;&gt;Enabling support during the origin trial phase &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#enabling-support-during-the-origin-trial-phase&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Starting in Chromium 98, the Launch Handler API will be available as an origin trial in
Chromium. The origin trial is expected to end in Chromium 102 (June 15, 2022).&lt;/p&gt;
&lt;p&gt;Origin trials allow you to try new features and give feedback on their
usability, practicality, and effectiveness to the web standards community. For
more information, see the &lt;a href=&quot;https://github.com/GoogleChrome/OriginTrials/blob/gh-pages/developer-guide.md&quot; rel=&quot;noopener&quot;&gt;Origin Trials Guide for Web Developers&lt;/a&gt;.
To sign up for this or another origin trial, visit the &lt;a href=&quot;https://developers.chrome.com/origintrials/#/trials/active&quot; rel=&quot;noopener&quot;&gt;registration page&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;register-for-ot&quot;&gt;Register for the origin trial &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#register-for-ot&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.chrome.com/origintrials/#/view_trial/2978005253598740481&quot; rel=&quot;noopener&quot;&gt;Request a token&lt;/a&gt; for your origin.&lt;/li&gt;
&lt;li&gt;Add the token to your pages. There are two ways to do that:
&lt;ul&gt;
&lt;li&gt;Add an &lt;code&gt;origin-trial&lt;/code&gt; &lt;code&gt;&amp;lt;meta&amp;gt;&lt;/code&gt; tag to the head of each page. For example,
this may look something like: &lt;br /&gt;
&lt;code&gt;&amp;lt;meta http-equiv=&amp;quot;origin-trial&amp;quot; content=&amp;quot;TOKEN_GOES_HERE&amp;quot;&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;If you can configure your server, you can also add the token
using an &lt;code&gt;Origin-Trial&lt;/code&gt; HTTP header. The resulting response header should
look something like:&lt;br /&gt;
&lt;code&gt;Origin-Trial: TOKEN_GOES_HERE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;feature-detection&quot;&gt;Feature detection &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#feature-detection&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To check if the Launch Handler API is supported, use:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;launchQueue&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; window &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;targetURL&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LaunchParams&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;prototype&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// The Launch Handler API is supported.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;the-launch_handler-manifest-member&quot;&gt;The &lt;code&gt;launch_handler&lt;/code&gt; manifest member &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#the-launch_handler-manifest-member&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To declaratively specify the launch behavior of your app, add the &lt;code&gt;launch_handler&lt;/code&gt; manifest member
to your manifest. It has two sub-fields, &lt;code&gt;route_to&lt;/code&gt; and &lt;code&gt;navigate_existing_client&lt;/code&gt;. The former lets
you control whether a new or an existing client should be launched, and the latter how and if this
client should be navigated. The Web App Manifest excerpt below shows a file with
exemplary values that would always route all launches to a new client.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;&quot;launch_handler&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;&quot;route_to&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;new-client&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;&quot;navigate_existing_client&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;always&quot;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;If unspecified, &lt;code&gt;launch_handler&lt;/code&gt; defaults to
&lt;code&gt;{&amp;quot;route_to&amp;quot;: &amp;quot;auto&amp;quot;, &amp;quot;navigate_existing_client&amp;quot;: &amp;quot;always&amp;quot;}&lt;/code&gt;. The allowed values for the sub-fields
are as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;route_to&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;new-client&lt;/code&gt;: A new browsing context is created in a web app window to load the launch&#39;s target
URL.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;existing-client&lt;/code&gt;: An existing browsing context is used, specifically the one most recently used. How the launch is handled within that
browsing context depends on &lt;code&gt;navigate_existing_client&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;auto&lt;/code&gt;: The behavior is up to the user agent to decide what works best for the platform. For
example, mobile devices only support single clients and would use &lt;code&gt;existing-client&lt;/code&gt;, while
desktop devices support multiple windows and would use &lt;code&gt;new-client&lt;/code&gt; to avoid data loss.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;navigate_existing_client&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;always&lt;/code&gt;: Existing browsing contexts chosen for launch will navigate the browsing context to the
launch&#39;s target URL.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;never&lt;/code&gt;: Existing browsing contexts chosen for launch will not be navigated and instead have
&lt;code&gt;targetURL&lt;/code&gt; in the enqueued &lt;code&gt;LaunchParams&lt;/code&gt; set to the launch&#39;s target URL.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&quot;aside flow bg-state-warn-bg color-core-text&quot;&gt;
&lt;p class=&quot;cluster &quot;&gt;
&lt;span class=&quot;aside__icon box-block color-state-warn-text&quot;&gt;&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;currentColor&quot; role=&quot;img&quot; aria-label=&quot;Warning sign&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
  &lt;path fill-rule=&quot;evenodd&quot; clip-rule=&quot;evenodd&quot; d=&quot;M23 21L12 2 1 21h22zm-12-3v-2h2v2h-2zm0-4h2v-4h-2v4z&quot;&gt;&lt;/path&gt;
&lt;/svg&gt;&lt;/span&gt;
&lt;strong&gt;Warning&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Careful, setting &lt;code&gt;navigate_existing_client&lt;/code&gt; to &lt;code&gt;always&lt;/code&gt; can cause data loss. Only use this
when it is safe to do so (for example, in a music player), or make sure the user&#39;s data gets
saved before navigating away from the previous location.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;Both &lt;code&gt;route_to&lt;/code&gt; and &lt;code&gt;navigate_existing_client&lt;/code&gt; also accept a list (array) of values, where the first
valid value will be used. This is to allow new values to be added to the spec without breaking
backwards compatibility with existing implementations.&lt;/p&gt;
&lt;p&gt;For example, if the hypothetical value &lt;code&gt;&amp;quot;matching-url-client&amp;quot;&lt;/code&gt; were added, sites would specify
&lt;code&gt;&amp;quot;route_to&amp;quot;: [&amp;quot;matching-url-client&amp;quot;, &amp;quot;existing-client&amp;quot;]&lt;/code&gt; to continue to control the behavior of
older browsers that did not support &lt;code&gt;&amp;quot;matching-url-client&amp;quot;&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;the-window.launchqueue-interface&quot;&gt;The &lt;code&gt;window.launchQueue&lt;/code&gt; interface &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#the-window.launchqueue-interface&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If the app has declared that it wants to handle launches in an existing client (by specifying
&lt;code&gt;&amp;quot;route_to&amp;quot;: &amp;quot;existing-client&amp;quot;&lt;/code&gt;), it can imperatively do something with incoming launch URLs.
This is where the &lt;code&gt;launchQueue&lt;/code&gt; comes into play. To access launch target URLs, a site needs to
specify a consumer for the &lt;code&gt;window.launchQueue&lt;/code&gt; object, which is then passed the target URL via the
&lt;code&gt;launchParams.targetURL&lt;/code&gt; field. Launches are queued until they are handled by the specified
consumer, which is invoked exactly once for each launch. In this manner, every launch is handled,
regardless of when the consumer was specified. The code snippet below shows a fictive audio player
PWA that extracts a song ID from a target URL that it is potentially passed on launch.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;launchQueue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setConsumer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;launchParams&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; songID &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;extractSongId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;launchParams&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;targetURL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;songID&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;playSong&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;songID&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;demo&quot;&gt;Demo &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#demo&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;You can see a demo of the Launch Handler API in action in the &lt;a href=&quot;https://launch-handler.glitch.me/&quot; rel=&quot;noopener&quot;&gt;PWA Launch Handler Demo&lt;/a&gt;. Be
sure to check out the &lt;a href=&quot;https://glitch.com/edit/#!/launch-handler&quot; rel=&quot;noopener&quot;&gt;source code&lt;/a&gt; of the application to see how it uses the Launch
Handler API.&lt;/p&gt;
&lt;!--lint disable no-literal-urls --&gt;
&lt;ol&gt;
&lt;li&gt;Install the &lt;em&gt;Musicr 2.0&lt;/em&gt; app on a Chrome OS device.&lt;/li&gt;
&lt;li&gt;Send yourself a link in a chat application of the form
&lt;code&gt;https://launch-handler.glitch.me?track=&lt;strong&gt;https://example.com/music.mp3&lt;/strong&gt;&lt;/code&gt;.
(You can customize
&lt;code&gt;&lt;strong&gt;https://example.com/music.mp3&lt;/strong&gt;&lt;/code&gt; for any URL pointing to an audio file, for example,
&lt;a href=&quot;https://launch-handler.glitch.me/?track=https://cdn.glitch.me/3e952c9c-4d6d-4de4-9873-23cf976b422e%2Ffile_example_MP3_700KB.mp3?v=1638795977190&quot;&gt;&lt;code&gt;https://launch-handler.glitch.me?track=https://cdn.glitch.me/3e952c9c-4d6d-4de4-9873-23cf976b422e%2Ffile_example_MP3_700KB.mp3?v=1638795977190&lt;/code&gt;&lt;/a&gt;).&lt;/li&gt;
&lt;li&gt;Click the link in your chat app and notice how &lt;em&gt;Musicr 2.0&lt;/em&gt; opens and plays the track.&lt;/li&gt;
&lt;li&gt;Click the link in your chat app again and notice that you will not get a second instance of &lt;em&gt;Musicr 2.0&lt;/em&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;!--lint enable no-literal-urls --&gt;
&lt;img alt=&quot;Musicr 2.0 web application launched and playing music it handled from the launch params.&quot; decoding=&quot;async&quot; height=&quot;235&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/nFgE69N5VTYBDon1DGmB.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;security-and-permissions&quot;&gt;Security and permissions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#security-and-permissions&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Chromium team designed and implemented the Launch Handler API using the core principles
defined in &lt;a href=&quot;https://chromium.googlesource.com/chromium/src/+/lkgr/docs/security/permissions-for-powerful-web-platform-features.md&quot; rel=&quot;noopener&quot;&gt;Controlling Access to Powerful Web Platform Features&lt;/a&gt;, including user
control, transparency, and ergonomics.&lt;/p&gt;
&lt;h2 id=&quot;feedback&quot;&gt;Feedback &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#feedback&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Chromium team wants to hear about your experiences with the Launch Handler API.&lt;/p&gt;
&lt;h3 id=&quot;tell-us-about-the-api-design&quot;&gt;Tell us about the API design &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#tell-us-about-the-api-design&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Is there something about the API that does not work like you expected? Or are there missing methods
or properties that you need to implement your idea? Have a question or comment on the security
model? File a spec issue on the corresponding &lt;a href=&quot;https://github.com/WICG/sw-launch/issues&quot; rel=&quot;noopener&quot;&gt;GitHub repo&lt;/a&gt;, or add your thoughts to an
existing issue.&lt;/p&gt;
&lt;h3 id=&quot;report-a-problem-with-the-implementation&quot;&gt;Report a problem with the implementation &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#report-a-problem-with-the-implementation&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Did you find a bug with Chromium&#39;s implementation? Or is the implementation different from the spec?
File a bug at &lt;a href=&quot;https://new.crbug.com/&quot; rel=&quot;noopener&quot;&gt;new.crbug.com&lt;/a&gt;. Be sure to include as much detail as you can,
simple instructions for reproducing, and enter &lt;code&gt;Blink&amp;gt;AppManifest&lt;/code&gt; in the &lt;strong&gt;Components&lt;/strong&gt; box.
&lt;a href=&quot;https://glitch.com/&quot; rel=&quot;noopener&quot;&gt;Glitch&lt;/a&gt; works great for sharing quick and easy repros.&lt;/p&gt;
&lt;h3 id=&quot;show-support-for-the-api&quot;&gt;Show support for the API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#show-support-for-the-api&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Are you planning to use the Launch Handler API? Your public support helps the Chromium team
prioritize features and shows other browser vendors how critical it is to support them.&lt;/p&gt;
&lt;p&gt;Send a tweet to &lt;a href=&quot;https://twitter.com/ChromiumDev&quot; rel=&quot;noopener&quot;&gt;@ChromiumDev&lt;/a&gt; using the hashtag
&lt;a href=&quot;https://twitter.com/search?q=%23LaunchHandler&amp;amp;src=recent_search_click&amp;amp;f=live&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;#LaunchHandler&lt;/code&gt;&lt;/a&gt; and
let us know where and how you are using it.&lt;/p&gt;
&lt;h2 id=&quot;helpful&quot;&gt;Helpful links &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#helpful&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/WICG/sw-launch/blob/main/launch_handler.md&quot; rel=&quot;noopener&quot;&gt;Public explainer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://launch-handler.glitch.me/&quot; rel=&quot;noopener&quot;&gt;Launch Handler API Demo&lt;/a&gt; | &lt;a href=&quot;https://glitch.com/edit/#!/launch-handler&quot; rel=&quot;noopener&quot;&gt;launch Handler API Demo source&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1231886&quot; rel=&quot;noopener&quot;&gt;Chromium tracking bug&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.chromestatus.com/feature/5722383233056768&quot; rel=&quot;noopener&quot;&gt;ChromeStatus.com entry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Blink Component: &lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/list?q=component:Blink%3EAppManifest&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;Blink&amp;gt;AppManifest&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/w3ctag/design-reviews/issues/683&quot; rel=&quot;noopener&quot;&gt;TAG Review&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://groups.google.com/a/chromium.org/g/blink-dev/c/8tNe2jrJ78A&quot; rel=&quot;noopener&quot;&gt;Intent to Prototype&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/launch-handler/#acknowledgements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Hero image by &lt;a href=&quot;https://unsplash.com/@spacex&quot; rel=&quot;noopener&quot;&gt;SpaceX&lt;/a&gt; on
&lt;a href=&quot;https://unsplash.com/photos/-p-KCm6xB9I&quot; rel=&quot;noopener&quot;&gt;Unsplash&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Thomas Steiner</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Compat 2021 Holiday Update: presents for developers before the end of the year</title>
      <link href="https://web.dev/docs/compat2021-holiday-update/"/>
      <updated>2021-12-13T00:00:00Z</updated>
      <id>https://web.dev/docs/compat2021-holiday-update/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;The end of the year is near, and it&#39;s time for a final update on Compat 2021—an effort to eliminate
browser compatibility problems in five key focus areas.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;This effort is also known as Interop 2021, matching the name of
&lt;a href=&quot;https://github.com/web-platform-tests/interop-2022&quot; rel=&quot;noopener&quot;&gt;Interop 2022&lt;/a&gt;, which is the continuation of
this effort.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;div class=&quot;stats&quot;&gt;
 &lt;div class=&quot;stats__item&quot;&gt;
   &lt;p class=&quot;stats__figure&quot;&gt;&gt;90&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
   &lt;p&gt;score in all browsers&lt;/p&gt;
 &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Since our &lt;a href=&quot;https://web.dev/compat2021-midyear/&quot;&gt;last update&lt;/a&gt;, we’ve continued to see improvements
in all browsers. All browsers started with much lower test scores at the beginning of the year, but
now all browsers have surpassed 90%! This means the web platform has significantly improved
interoperability of the five focus areas.&lt;/p&gt;
&lt;figure&gt;
&lt;img alt=&quot;A snapshot of Compat 2021 Dashboard (experimental browsers)&quot; decoding=&quot;async&quot; height=&quot;727&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/Wd2sVnt4VLho4jgp7UtIyWFceE02/Kaz3ye7gFfow8ia7lWYW.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    A snapshot of &lt;a href=&quot;https://wpt.fyi/compat2021&quot;&gt;Compat 2021 Dashboard&lt;/a&gt; (experimental
    browsers).
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;aside class=&quot;aside flow bg-state-bad-bg color-state-bad-text&quot;&gt;
&lt;p class=&quot;cluster color-state-bad-text&quot;&gt;
&lt;span class=&quot;aside__icon box-block &quot;&gt;&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;currentColor&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; role=&quot;img&quot; aria-label=&quot;Error sign&quot;&gt;
  &lt;path fill-rule=&quot;evenodd&quot; clip-rule=&quot;evenodd&quot; d=&quot;M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15v-2h2v2h-2zm0-10v6h2V7h-2z&quot;&gt;&lt;/path&gt;
&lt;/svg&gt;&lt;/span&gt;
&lt;strong&gt;Caution&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The graph does not correctly show the improvements in Safari Technology Preview between May and
November, as the version tested was &lt;a href=&quot;https://github.com/web-platform-tests/wpt/issues/31147&quot; rel=&quot;noopener&quot;&gt;stuck&lt;/a&gt;
at an older version. This is now resolved but the data between May and November remains incorrect.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;Contributions to browser engines are made not only by browser vendors, but also others in the web
community. For this project, we particularly want to thank Igalia for
&lt;a href=&quot;https://www.igalia.com/2021/11/12/New-Interoperability-Milestones.html&quot; rel=&quot;noopener&quot;&gt;their involvement&lt;/a&gt; and
continued work to improve the scores. Igalia has contributed to improving all five focus
areas of Compat 2021.&lt;/p&gt;
&lt;p&gt;On &lt;a href=&quot;https://wpt.fyi/&quot; rel=&quot;noopener&quot;&gt;wpt.fyi&lt;/a&gt;, the test results dashboard, there’s now a
&lt;a href=&quot;https://wpt.fyi/results/?label=master&amp;amp;label=experimental&amp;amp;product=chrome&amp;amp;product=firefox&amp;amp;product=safari&amp;amp;aligned&amp;amp;q=label%3Ainterop-2021&quot; rel=&quot;noopener&quot;&gt;filtered test results view&lt;/a&gt;
showing all of the tests included in Compat 2021, and also views for
&lt;a href=&quot;https://wpt.fyi/results/?diff&amp;amp;filter=ADC&amp;amp;q=label%3Ainterop-2021&amp;amp;run_id=5738932147847168&amp;amp;run_id=5682110523244544&quot; rel=&quot;noopener&quot;&gt;Chrome&lt;/a&gt;,
&lt;a href=&quot;https://wpt.fyi/results/?diff&amp;amp;filter=ADC&amp;amp;q=label%3Ainterop-2021&amp;amp;run_id=5644039006191616&amp;amp;run_id=5717852704210944&quot; rel=&quot;noopener&quot;&gt;Firefox&lt;/a&gt;,
and &lt;a href=&quot;https://wpt.fyi/results/?diff&amp;amp;filter=ADC&amp;amp;q=label%3Ainterop-2021&amp;amp;run_id=5739124314079232&amp;amp;run_id=5759777691926528&quot; rel=&quot;noopener&quot;&gt;Safari&lt;/a&gt;
comparing the results to our last update in July.&lt;/p&gt;
&lt;p&gt;Let’s take a look at the improvements in each area!&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;This post uses browser engine names when referencing specific improvements or bug fixes.
&lt;strong&gt;Chromium&lt;/strong&gt; is the engine used by Chrome and Edge, &lt;strong&gt;Gecko&lt;/strong&gt; is used by Firefox, and
&lt;strong&gt;WebKit&lt;/strong&gt; is used by Safari.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;css-flexbox&quot;&gt;CSS flexbox &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/compat2021-holiday-update/#css-flexbox&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;flex-basis: content&lt;/code&gt; is now on its way to all browsers, with implementations landing in
&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=470421&quot; rel=&quot;noopener&quot;&gt;Chromium&lt;/a&gt; and
&lt;a href=&quot;https://trac.webkit.org/changeset/284440/webkit&quot; rel=&quot;noopener&quot;&gt;WebKit&lt;/a&gt;. (The &lt;code&gt;content&lt;/code&gt; value was already
supported by Gecko.)&lt;/p&gt;
&lt;p&gt;In Chromium, an &lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=961902&quot; rel=&quot;noopener&quot;&gt;issue with flexbox sizing&lt;/a&gt;
is fixed, matching the spec and Gecko’s behavior. And in Gecko, several
&lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1700745&quot; rel=&quot;noopener&quot;&gt;issues affecting Compat 2021&lt;/a&gt; are fixed,
including an &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1611303&quot; rel=&quot;noopener&quot;&gt;issue with percentage height on flex items&lt;/a&gt;.
Finally, in WebKit, support for more alignment property values (&lt;a href=&quot;https://trac.webkit.org/changeset/282078/webkit&quot; rel=&quot;noopener&quot;&gt;left, right&lt;/a&gt;,
&lt;a href=&quot;https://trac.webkit.org/changeset/282267/webkit&quot; rel=&quot;noopener&quot;&gt;self-start, self-end&lt;/a&gt;, &lt;a href=&quot;https://trac.webkit.org/changeset/281840/webkit&quot; rel=&quot;noopener&quot;&gt;start, end&lt;/a&gt;)
is now added, and a lot of improvements were made for &lt;a href=&quot;https://trac.webkit.org/changeset/281995/webkit&quot; rel=&quot;noopener&quot;&gt;absolute positioning&lt;/a&gt;,
also improving the flexbox test results in Compat 2021.&lt;/p&gt;
&lt;h2 id=&quot;css-grid&quot;&gt;CSS Grid &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/compat2021-holiday-update/#css-grid&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The use of CSS Grid on the web continues to grow, as can be seen in both the
&lt;a href=&quot;https://almanac.httparchive.org/en/2021/css#flexbox-and-grid-adoption&quot; rel=&quot;noopener&quot;&gt;2021 Web Almanac&lt;/a&gt; and
Chrome’s &lt;a href=&quot;https://www.chromestatus.com/metrics/feature/timeline/popularity/1693&quot; rel=&quot;noopener&quot;&gt;usage metrics&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://blogs.windows.com/msedgedev/2021/08/10/compat2021-css-grid-gridng/&quot; rel=&quot;noopener&quot;&gt;launch of GridNG&lt;/a&gt;
in Chrome and Edge 93 resolved many long standing issues with Grid, closing an impressive 38 issues
in Chromium’s bug tracker. Together with many smaller improvements that followed, the Compat 2021
score for Grid in Chromium improved by 3% to 97%. This work was led by the Edge team at Microsoft.&lt;/p&gt;
&lt;p&gt;An &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1707643&quot; rel=&quot;noopener&quot;&gt;absolute positioning bug&lt;/a&gt; affecting Grid
was fixed in Gecko, and &lt;a href=&quot;https://bugs.webkit.org/buglist.cgi?bug_status=RESOLVED&amp;amp;chfield=resolution&amp;amp;chfieldfrom=2021-01-01&amp;amp;chfieldto=2021-12-31&amp;amp;component=Accessibility&amp;amp;component=CSS&amp;amp;component=Layout%20and%20Rendering&amp;amp;component=New%20Bugs&amp;amp;f1=short_desc&amp;amp;f2=short_desc&amp;amp;f3=short_desc&amp;amp;list_id=7744283&amp;amp;o1=notsubstring&amp;amp;o2=notsubstring&amp;amp;o3=substring&amp;amp;query_format=advanced&amp;amp;resolution=FIXED&amp;amp;v1=Web%20Inspector&amp;amp;v2=%5BLFC%5D&amp;amp;v3=grid&quot; rel=&quot;noopener&quot;&gt;many fixes&lt;/a&gt;
have landed in WebKit, leading to a 1% improvement for Firefox and 3% improvement for Safari on
the Grid tests.&lt;/p&gt;
&lt;h2 id=&quot;css-position:-sticky&quot;&gt;CSS &lt;code&gt;position: sticky&lt;/code&gt; &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/compat2021-holiday-update/#css-position:-sticky&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In our last update, we noted that &lt;code&gt;position: sticky&lt;/code&gt; was the first area where any browser (in this
case Chrome and Edge) reached 100% passing tests. Now, following a &lt;a href=&quot;https://bugs.webkit.org/buglist.cgi?bug_status=RESOLVED&amp;amp;chfield=resolution&amp;amp;chfieldfrom=2021-01-01&amp;amp;chfieldto=2021-12-31&amp;amp;f1=short_desc&amp;amp;f2=short_desc&amp;amp;f3=short_desc&amp;amp;list_id=7744291&amp;amp;o1=notsubstring&amp;amp;o2=notsubstring&amp;amp;o3=substring&amp;amp;query_format=advanced&amp;amp;resolution=FIXED&amp;amp;v1=Web%20Inspector&amp;amp;v2=%5BLFC%5D&amp;amp;v3=sticky&quot; rel=&quot;noopener&quot;&gt;number of fixes&lt;/a&gt;
in WebKit’s implementation, Safari also scores 100% for these tests.  Most of these improvements
were included in Safari 15.&lt;/p&gt;
&lt;h2 id=&quot;css-aspect-ratio-property&quot;&gt;CSS &lt;code&gt;aspect-ratio&lt;/code&gt; property &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/compat2021-holiday-update/#css-aspect-ratio-property&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Cross-browser support for defining the aspect ratio (width-to-height ratio) of elements has
continued to improve, with Compat 2021 scores reaching 99%, 97% and 95% for Chrome/Edge, Firefox
and Safari respectively. Most of the improvements are not with the &lt;code&gt;aspect-ratio&lt;/code&gt; property itself,
but rather with how &lt;code&gt;width&lt;/code&gt; and &lt;code&gt;height&lt;/code&gt; attributes are &lt;a href=&quot;https://developer.mozilla.org/docs/Web/Media/images/aspect_ratio_mapping&quot; rel=&quot;noopener&quot;&gt;mapped to a default &lt;code&gt;aspect-ratio&lt;/code&gt; value&lt;/a&gt;
for elements. This was implemented for multiple elements in &lt;a href=&quot;https://wpt.fyi/results/html/rendering/replaced-elements/attributes-for-embedded-content-and-images?diff&amp;amp;filter=ADC&amp;amp;q=label%3Ainterop-2021&amp;amp;run_id=5739124314079232&amp;amp;run_id=6290692121821184&quot; rel=&quot;noopener&quot;&gt;WebKit&lt;/a&gt;,
and &lt;code&gt;&amp;lt;canvas&amp;gt;&lt;/code&gt; for &lt;a href=&quot;https://chromium-review.googlesource.com/c/chromium/src/+/3109968&quot; rel=&quot;noopener&quot;&gt;Chromium&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;css-transforms&quot;&gt;CSS transforms &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/compat2021-holiday-update/#css-transforms&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Support for &lt;code&gt;transform: perspective(none)&lt;/code&gt; is now supported in
&lt;a href=&quot;https://chromestatus.com/feature/5687325523705856&quot; rel=&quot;noopener&quot;&gt;Chromium&lt;/a&gt;,
&lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1725207&quot; rel=&quot;noopener&quot;&gt;Gecko&lt;/a&gt; and
&lt;a href=&quot;https://trac.webkit.org/changeset/285255/webkit&quot; rel=&quot;noopener&quot;&gt;WebKit&lt;/a&gt;. This will make it easier to
animate between a perspective and no perspective.&lt;/p&gt;
&lt;p&gt;In Chromium, &lt;code&gt;transform-style: preserve-3d&lt;/code&gt; (which allows child elements to participate in the same
3D scene) and the &lt;code&gt;perspective&lt;/code&gt; property (which applies a perspective transform to child elements)
are now &lt;a href=&quot;https://chromestatus.com/feature/5640541339385856&quot; rel=&quot;noopener&quot;&gt;aligned with the spec&lt;/a&gt; by making them
apply only to child elements.&lt;/p&gt;
&lt;p&gt;The big increase in the &lt;a href=&quot;https://wpt.fyi/compat2021?feature=css-transforms&quot; rel=&quot;noopener&quot;&gt;scores&lt;/a&gt; for CSS
transforms for all browsers is mainly due to improvements to the test suite, where incorrect
tests have been fixed or removed. This makes it easier to understand the remaining interoperability
problems and avoid regressions in the future.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/compat2021-holiday-update/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We are grateful for the work that everyone has put in to end the year with many improvements to the
score as well as better testing infrastructure. &lt;code&gt;aspect-ratio&lt;/code&gt; was a long requested feature from
web developers and it is now supported in all browsers. Use of flexbox, grid and &lt;code&gt;position: sticky&lt;/code&gt;
are all growing, and these features are now better supported across browsers thanks to many
improvements made during 2021.&lt;/p&gt;
&lt;p&gt;What&#39;s next? We are excited to continue collaborating with other browser vendors and the wider
community in the next iteration of this effort. We have started to research and discuss the focus
areas for 2022. Please look out for an announcement coming soon.&lt;/p&gt;
&lt;p&gt;If you have any feedback or questions please reach out to us on Twitter at &lt;a href=&quot;https://twitter.com/ChromiumDev&quot; rel=&quot;noopener&quot;&gt;@ChromiumDev&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Philip Jägenstedt</name>
        </author><author>
          <name>Mariko Kosaka</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>How QuintoAndar increased conversion rates and pages per session by improving page performance</title>
      <link href="https://web.dev/docs/quintoandar/"/>
      <updated>2021-12-10T00:00:00Z</updated>
      <id>https://web.dev/docs/quintoandar/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;QuintoAndar is a Brazilian proptech company whose products offer digital end-to-end solutions for real estate. This year, we carried out a project focused on improving the performance of a content hub in our app, and had encouraging results in increasing user traffic and conversion metrics.&lt;/p&gt;
&lt;div class=&quot;stats&quot;&gt;
 &lt;div class=&quot;stats__item&quot;&gt;
   &lt;p class=&quot;stats__figure&quot;&gt;46&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
   &lt;p&gt;reduction in bounce rate&lt;/p&gt;
 &lt;/div&gt;
 &lt;div class=&quot;stats__item&quot;&gt;
   &lt;p class=&quot;stats__figure&quot;&gt;87&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
   &lt;p&gt;increase in pages per session&lt;/p&gt;
 &lt;/div&gt;
 &lt;div class=&quot;stats__item&quot;&gt;
   &lt;p class=&quot;stats__figure&quot;&gt;5&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
   &lt;p&gt;improvement in conversion during validation phase&lt;/p&gt;
 &lt;/div&gt;
&lt;/div&gt;
&lt;h2 id=&quot;challenges&quot;&gt;Challenges &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#challenges&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Our app has a condominium content hub with over 40,000 pages, where users can get information about their properties, check photos of the common areas, read about the neighborhood, and find available listings for rent or sale. These pages are very important for QuintoAndar:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;They are an important source of &lt;a href=&quot;https://en.wikipedia.org/wiki/Organic_search_results&quot; rel=&quot;noopener&quot;&gt;organic traffic&lt;/a&gt;, with a steadily increasing number of users coming from search engine results.&lt;/li&gt;
&lt;li&gt;They have high conversion rates in the medium to long-term compared to other pages.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;However, there were challenges when it came to the performance and user experience in these pages:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Their performance as measured by &lt;a href=&quot;https://web.dev/vitals/&quot;&gt;Core Web Vitals&lt;/a&gt; was not optimized, and there were known issues regarding slow page loads, slow responsiveness to user input, and layout instability.&lt;/li&gt;
&lt;li&gt;Their &lt;a href=&quot;https://en.wikipedia.org/wiki/Bounce_rate&quot; rel=&quot;noopener&quot;&gt;bounce rates&lt;/a&gt; were high, even if we expected them to be higher than in other parts of the app.&lt;/li&gt;
&lt;li&gt;The &lt;a href=&quot;https://developers.google.com/search/blog/2020/11/timing-for-page-experience&quot; rel=&quot;noopener&quot;&gt;page experience update in Google Search&lt;/a&gt;—which, at that time, was not yet released—would include Core Web Vitals into the ranking algorithm, which meant page performance could affect how search results were going to be displayed.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;At the same time, we identified some developer experience opportunities that could unlock gains in other projects across the company:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Our server-side rendering logic—which renders all high-traffic pages, including condominium pages—was created in-house, and became too complex to maintain and onboard new hires.&lt;/li&gt;
&lt;li&gt;Essential features to achieve good app performance, such as &lt;a href=&quot;https://developer.mozilla.org/docs/Glossary/Code_splitting&quot; rel=&quot;noopener&quot;&gt;code splitting&lt;/a&gt;, also required a custom setup plus manual work from the developers.&lt;/li&gt;
&lt;li&gt;QuintoAndar has over 30 &lt;a href=&quot;https://reactjs.org/&quot; rel=&quot;noopener&quot;&gt;React&lt;/a&gt; web applications. Delivering updates to these applications and maintaining them in accordance to best practices is an arduous task.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;approach&quot;&gt;Approach &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#approach&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We began a performance optimization project of the condominium content hub to improve its user experience, as these improvements could lead to conversion gains, better SEO, and better usability. This initiative was also a fitting opportunity to improve the developer experience as well.&lt;/p&gt;
&lt;h3 id=&quot;migrating-to-next.js&quot;&gt;Migrating to Next.js &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#migrating-to-next.js&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The new version of the condominium page was implemented with &lt;a href=&quot;http://nextjs.org/&quot; rel=&quot;noopener&quot;&gt;Next.js&lt;/a&gt;. Being largely independent from other parts of the app, the condominium content hub seemed like a good candidate for trying out a new framework. We would be able to understand the magnitude of migration efforts and evaluate how its features could help without affecting the other React apps in QuintoAndar.&lt;/p&gt;
&lt;p&gt;A hard requirement was to ensure pages remained crawlable by search engines. Next.js meets this requirement by supporting server-side rendering out-of-the-box, and removes the need for a custom setup. The documentation makes it much easier to share knowledge on how to do tasks such as &lt;a href=&quot;https://nextjs.org/docs/basic-features/data-fetching&quot; rel=&quot;noopener&quot;&gt;data fetching&lt;/a&gt; on the server and onboard new developers. Server-side rendering is also known to &lt;a href=&quot;https://developers.google.com/web/updates/2019/02/rendering-on-the-web#server-rendering&quot; rel=&quot;noopener&quot;&gt;improve performance&lt;/a&gt; metrics such as &lt;a href=&quot;https://web.dev/fcp/&quot;&gt;First Contentful Paint&lt;/a&gt; (FCP).&lt;/p&gt;
&lt;p&gt;The framework provides other performance-friendly features such as automatic &lt;a href=&quot;https://web.dev/reduce-javascript-payloads-with-code-splitting/&quot;&gt;code splitting&lt;/a&gt; and &lt;a href=&quot;https://web.dev/link-prefetch/&quot;&gt;prefetching&lt;/a&gt;. Even though the existing structure already provided such features, the additional work required from developers stalled their adoption. For example, code splitting at page or component-level had to be done manually.&lt;/p&gt;
&lt;h3 id=&quot;optimizing-javascript-resources&quot;&gt;Optimizing JavaScript resources &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#optimizing-javascript-resources&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The first step was to &lt;a href=&quot;https://web.dev/remove-unused-code/&quot;&gt;remove unused code&lt;/a&gt;. We looked at the &lt;a href=&quot;https://github.com/webpack-contrib/webpack-bundle-analyzer&quot; rel=&quot;noopener&quot;&gt;Webpack Bundle Analyzer&lt;/a&gt; reports, which shows the contents of each JS bundle, and carefully reviewed all third-party scripts. As a result, we were able to clean up some tracking libraries that were not used in this specific page.&lt;/p&gt;
&lt;p&gt;Our team went further and evaluated the performance cost of existing features. For instance, the &amp;quot;like&amp;quot; button required quite a lot of JS to work. However, in the condominium page, less than 0.5% of the users interacted with the button, which is available and used more frequently in other parts of our app. After a discussion involving both Engineering and Product, we decided to remove this feature.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; controls=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/jL3OLOhcWUQDnR4XjewLBx4e3PC3/2uEL2YxbuGGlmJDlvW9F.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption&gt;
    An animation showing the “like” button feature. There is a card about an apartment available for rent. In the bottom right corner of the card, there is a grey heart-shaped button that turns blue when clicked.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Other JS optimizations were already in place, such as &lt;a href=&quot;https://web.dev/reduce-network-payloads-using-text-compression/#static-compression&quot;&gt;static compression with Brotli&lt;/a&gt;, which was done at build time using &lt;a href=&quot;https://github.com/mynameiswhm/brotli-webpack-plugin&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;BrotliWebpackPlugin&lt;/code&gt;&lt;/a&gt;, and was also applied to other types of static resources. At first, we were relying on the compression provided by the CDN, and Brotli reduced JS size by 18% compared to gzip. But then, we switched to Brotli compression at build time, and were able to achieve a 24% reduction.&lt;/p&gt;
&lt;h3 id=&quot;optimizing-image-resources&quot;&gt;Optimizing image resources &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#optimizing-image-resources&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;There is a hero image occupying most of the area above the fold in the mobile version. It also happens to be the &lt;a href=&quot;https://web.dev/lcp/&quot;&gt;Largest Contentful Paint&lt;/a&gt; (LCP) of the page.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;The condominium page for Edifício Copan (São Paulo, Brazil). A photo taken from the ground level shows the curves of the building structure.&quot; decoding=&quot;async&quot; height=&quot;640&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 360px) 360px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/W7koRinBm3QXErIzwGP8.png?auto=format&amp;w=720 720w&quot; width=&quot;360&quot; /&gt;
  &lt;figcaption&gt;
    The hero image of a condominium page.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Previously, all images already had &lt;code&gt;srcset&lt;/code&gt; and &lt;code&gt;sizes&lt;/code&gt; attributes to &lt;a href=&quot;https://web.dev/serve-responsive-images/&quot;&gt;serve responsive images&lt;/a&gt;. We also used &lt;a href=&quot;https://github.com/thumbor/thumbor&quot; rel=&quot;noopener&quot;&gt;Thumbor&lt;/a&gt; to resize images on-demand and configured our CDN to cache them efficiently.&lt;/p&gt;
&lt;p&gt;Modern mobile devices have displays with very high pixel density, meaning the browser would render 3x or 4x versions of the image, if available. As resolution increases, it gets harder for the human eye to perceive the differences, but file sizes will increase regardless. &lt;a href=&quot;https://blog.twitter.com/engineering/en_us/topics/infrastructure/2019/capping-image-fidelity-on-ultra-high-resolution-devices&quot; rel=&quot;noopener&quot;&gt;Capping the maximum image resolution&lt;/a&gt; improved image size without compromising the user experience. We limited the hero image to serve its 2x version at most, which is approximately 35% smaller than the 3x version and 50% smaller than the 4x one.&lt;/p&gt;
&lt;p&gt;To finish, we used a &lt;a href=&quot;https://web.dev/preload-critical-assets/&quot;&gt;preloading&lt;/a&gt; strategy to download and display it as soon as possible, looking forward to improving the LCP metric.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;link&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;rel&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;preload&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/img/450x450/892847321-143.0038687080606IMG20180420WA0037.jpg&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;image&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The &lt;a href=&quot;https://nextjs.org/docs/basic-features/image-optimization&quot; rel=&quot;noopener&quot;&gt;Next.js built-in image component&lt;/a&gt; includes many of these optimizations such as responsive resizing and prioritized loading. During this project, we did not migrate the existing images to use this component, but we are planning to adopt it in new features.&lt;/p&gt;
&lt;h3 id=&quot;reducing-layout-shift&quot;&gt;Reducing layout shift &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#reducing-layout-shift&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The condominium page had a few issues with &lt;a href=&quot;https://web.dev/cls/&quot;&gt;Cumulative Layout Shift&lt;/a&gt; (CLS). The elements responsible for the layout shifts were rendered only in the client—for instance, hydrating server-side markup with client-rendered components, or images without defined &lt;code&gt;width&lt;/code&gt; and &lt;code&gt;height&lt;/code&gt; attributes.&lt;/p&gt;
&lt;p&gt;To solve these problems, we set exact dimensions for these elements when possible, or estimated values with &lt;code&gt;min-height&lt;/code&gt;. There are more options, such as using the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/aspect-ratio&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;aspect-ratio&lt;/code&gt; CSS property&lt;/a&gt;. We also created placeholders to prevent dynamically rendered components from causing layout shifts.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;An image showing an urban area in Google Maps with a red marker in the center.&quot; decoding=&quot;async&quot; height=&quot;174&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 397px) 397px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/VqFwUiJOtNmyNc14xljP.png?auto=format&amp;w=794 794w&quot; width=&quot;397&quot; /&gt;
  &lt;figcaption&gt;
    Defining dimensions for elements such as the map image reduced the CLS.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;progressively-rolling-out-changes&quot;&gt;Progressively rolling out changes &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#progressively-rolling-out-changes&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Our team wanted to validate that the optimized version of the condominium hub page to make sure the user experience would be better. To achieve this, we adopted a progressive rollout strategy:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;In the first phase, the new version was published for a few hand-picked URLs, so only a few hundreds of users per day would see them;&lt;/li&gt;
&lt;li&gt;In the second phase, it was published for more pages, accounting to a few thousand users per day;&lt;/li&gt;
&lt;li&gt;In the third and final phase, it was published for all pages, and the roll-out was completed for all users.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;During this period, the engineering team continuously measured page performance in production and kept working on improvements. Additionally, the team compared business metrics between the new and previous versions. The results in this validation period were promising.&lt;/p&gt;
&lt;h2 id=&quot;results&quot;&gt;Results &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#results&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The team used &lt;a href=&quot;https://speedcurve.com/&quot; rel=&quot;noopener&quot;&gt;SpeedCurve&lt;/a&gt; to continuously run &lt;a href=&quot;https://web.dev/user-centric-performance-metrics/#how-metrics-are-measured&quot;&gt;lab tests&lt;/a&gt; against the condominium page. These are the results for the mobile version:&lt;/p&gt;
&lt;div class=&quot;table-wrapper&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Lab metric&lt;/th&gt;
        &lt;th&gt;Before&lt;/th&gt;
        &lt;th&gt;After&lt;/th&gt;
        &lt;th&gt;Difference&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;Largest Contentful Paint (LCP)&lt;/td&gt;
        &lt;td&gt;2.41 seconds&lt;/td&gt;
        &lt;td&gt;1.48 seconds&lt;/td&gt;
        &lt;td&gt;-39%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Time to Interactive (TTI)&lt;/td&gt;
        &lt;td&gt;12.16 seconds&lt;/td&gt;
        &lt;td&gt;7.48 seconds&lt;/td&gt;
        &lt;td&gt;-39%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Total Blocking Time (TBT)&lt;/td&gt;
        &lt;td&gt;1124 milliseconds&lt;/td&gt;
        &lt;td&gt;1056 milliseconds&lt;/td&gt;
        &lt;td&gt;-4%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;Cumulative Layout Shift (CLS)&lt;/td&gt;
        &lt;td&gt;0.0402&lt;/td&gt;
        &lt;td&gt;0.0093&lt;/td&gt;
        &lt;td&gt;-77%&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;caption&gt;
      Lab metrics results collected with SpeedCurve.
    &lt;/caption&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;We also wanted to check the impact on our real users. Using field data collected with &lt;a href=&quot;https://www.instana.com/website-end-user-monitoring/&quot; rel=&quot;noopener&quot;&gt;Instana Website Monitoring&lt;/a&gt;, we looked at the 1-month period before and after the roll-out. Comparing the 75th percentile for mobile users, we found that LCP decreased by 26%, and FID decreased by 72%.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A line graph with LCP values comparing the new and previous versions during the current and past month. The curve for the new version floats between 2 and 4 seconds, staying below the curve for the previous version most of the time.&quot; decoding=&quot;async&quot; height=&quot;495&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/IAVpmg7O1Moxk8qA7zcq.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;/figure&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A line graph with FID values comparing the new and previous versions during the current and past month. The curve for the new version stays below 100ms most of the time, while in the curve for the previous version there are a few spikes crossing 250ms.&quot; decoding=&quot;async&quot; height=&quot;494&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/QWkHnGHi4YTdBR6q17sw.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    Field metrics results collected with Instana.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://pagespeed.web.dev/&quot; rel=&quot;noopener&quot;&gt;PageSpeed Insights&lt;/a&gt; provides a field data report for the last 28 days. &lt;a href=&quot;https://www.quintoandar.com.br/condominio/ed-copan-centro-historico-de-sao-paulo-sao-paulo-ndv7sq7j2d&quot; rel=&quot;noopener&quot;&gt;The most accessed condominium page&lt;/a&gt; alone had enough data to generate a report for mobile users. As of November 2021, all Core Web Vitals are in the &amp;quot;good&amp;quot; bucket.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A screenshot of the PageSpeed Insights report focusing on the Field Data section. All Core Web Vitals metrics (FCP, FID, LCP, CLS) are in the good bucket.&quot; decoding=&quot;async&quot; height=&quot;483&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/83nulYFqSAAWNLLPHXut.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    PageSpeed Insights shows that mobile users are having a good experience in the most accessed condominium page.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;During the progressive roll-out, we noticed a drop in bounce rates. By the time we had finished the release for all pages, &lt;a href=&quot;https://analytics.google.com/&quot; rel=&quot;noopener&quot;&gt;Google Analytics&lt;/a&gt; showed a 46% decrease in bounce rate, a 87% increase in pages per session, and a 49% increase in average session duration. The bounce rate reduction was even bigger for paid searches, reaching a 59% drop — a positive sign when it comes to the investments in &lt;a href=&quot;https://en.wikipedia.org/wiki/Pay-per-click&quot; rel=&quot;noopener&quot;&gt;pay-per click&lt;/a&gt; (PPC) ads.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A screenshot of a graph from Google Analytics. It compares the bounce rates between two distinct periods in March 2021. Starting from March 17th, there is a slight drop in the bounce rate. The drop is accentuated on March 24th.&quot; decoding=&quot;async&quot; height=&quot;169&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/f31hvBafirHtDBlKINwI.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    Google Analytics shows the bounce rate decreasing as we rolled-out the new version in more pages.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;As for the impact in business metrics, we analyzed conversion rates for transactions like scheduling a tour and applying to rent or buy an estate. While improvements were still being rolled out, our team compared the conversion between the previous and new versions. In the same week, the group of pages with the new version showed a 5% conversion increase, while the other pages had a slight decrease in the same metric.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Two line graphs side-by-side, each one comparing the conversion between the current and previous week. The left one is for the previous version of the page, showing the conversion curve for the current week is a bit below the one for the previous week. The right one is for the new version, and the conversion curve for the current week is a bit above the one for the previous week.&quot; decoding=&quot;async&quot; height=&quot;447&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/8duPNi2huaphIWCU7DBb.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;
    In the same week, the conversion for the new version increased, while the previous version had a small decrease.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/quintoandar/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This project is the first part of a long-term migration effort from framework-less React to Next.js. The teams who worked on the condominium page since then gave positive feedback about the improved developer experience. Other teams who had to bootstrap new web apps have already done so with Next.js. We believe Next.js will simplify maintenance efforts and establish a common ground between different apps.&lt;/p&gt;
&lt;p&gt;Overall, the condominium content hub has been continuously growing in terms of absolute number of users and transactions. In the long-term analysis, there are many factors contributing to this, like the expansion of QuintoAndar’s operation and SEO initiatives such as improved page indexing. During this project, we have seen that page performance is also one of these factors with great potential for positive conversion impact.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Special thanks to &lt;a href=&quot;https://www.linkedin.com/in/pasrcarmo/&quot; rel=&quot;noopener&quot;&gt;Pedro Carmo&lt;/a&gt;, Product Manager of the SEO team, for diving into the user data and creating all the conversion analysis seen in this case study.&lt;/em&gt;&lt;/p&gt;
</content>
      <author>
          <name>Daniela Sayuri Yassuda</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Community highlight: Chen Hui Jing</title>
      <link href="https://web.dev/docs/community-highlight-chen-hui-jing/"/>
      <updated>2021-12-10T00:00:00Z</updated>
      <id>https://web.dev/docs/community-highlight-chen-hui-jing/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;&lt;em&gt;This post is part of &lt;a href=&quot;https://designcember.com/&quot; rel=&quot;noopener&quot;&gt;Designcember&lt;/a&gt;. A celebration of web design, brought to you by web.dev.&lt;/em&gt;&lt;/p&gt;
&lt;img alt=&quot;Chen Hui Jing speaking on stage on front of a large screen showing slides.&quot; decoding=&quot;async&quot; height=&quot;533&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/8tTxEc4ZW29AKRkpwjoP.jpg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Chen Hui Jing is a self-taught designer and developer living in Singapore, with an inordinate love for CSS, as evidenced by her blog (which is mostly about CSS) and her tweets (which are largely about typography and the web). She used to play basketball full-time and launched her web career during downtime between training sessions, and hopes to be able to climb outdoors one day. I talked to her about CSS, and in particular non-English writing systems.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; What was your route into web design and development?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hui Jing:&lt;/strong&gt; When I was living in the dorms while playing basketball full-time, I had a bit more experience with computers than my peers, and my coach (bless him) thought that I could do something about our association website that hadn&#39;t been updated in years. I had zero idea what web development was, but I thought I had enough spare time to figure it out. It was more enjoyable than I expected and many years later, I&#39;m still here.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; And how did you get into CSS in particular?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hui Jing:&lt;/strong&gt; I&#39;m a very visual person by nature, and there&#39;s something about being able to give &amp;quot;instructions&amp;quot; to the browser and immediately see that reflected on the screen that really appealed to me. It felt much more intuitive to me than programming logic for applications. I got serious about the web at a time when developments in the world of CSS were starting to pick up speed, so there were a lot of experimental properties that were not widely used. It felt very exciting to discover new features that few people knew about.&lt;/p&gt;
&lt;h2 id=&quot;working-with-vertical-writing-modes&quot;&gt;Working with vertical writing modes &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/community-highlight-chen-hui-jing/#working-with-vertical-writing-modes&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; You&#39;ve written a lot about vertical writing modes in CSS, and the fun bugs you find when working with vertical writing. Do you have any favorite bugs we should all go and star?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hui Jing:&lt;/strong&gt; There were a few &lt;a href=&quot;https://chenhuijing.com/blog/debugging-vertical-layouts-in-2021/#%F0%9F%92%BB&quot; rel=&quot;noopener&quot;&gt;when I checked back in May this year&lt;/a&gt;, but, most of them have been resolved except one: Chromium has an issue with the &lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=1203251&amp;amp;q=devtools%20grid&amp;amp;can=2&quot; rel=&quot;noopener&quot;&gt;Devtools overlay in vertical writing mode&lt;/a&gt;. I think this is a testament to how this evergreen browser update cycle is really pushing web development forward.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; It’s great to hear that these issues are being fixed. Do you think playing with writing-mode has more use cases than simply typesetting vertical text?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hui Jing:&lt;/strong&gt; Oh yes, definitely. Even though typesetting East Asian scripts is the primary use-case of writing mode, I think other writing systems can make use of writing-mode to implement vertical layouts, like the style we often see in print magazines. To me, combinations of CSS properties are what makes CSS so powerful, so writing-mode together with flexbox and grid give us a fairly large number of permutations for layout directions, from a page level boxes down to individual characters in the text. I think this unlocks possibilities and more creativity as folks realize the scope of what is possible for web design moving forward. I hope to see layouts and designs on the web that I couldn&#39;t have imagined just a few years ago.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Hui Jing often speaks about typography and writing systems on the web. Watch her speak on &lt;a href=&quot;https://www.youtube.com/watch?v=yLQHDGRLOwQ&quot; rel=&quot;noopener&quot;&gt;Web Typography: a non-English perspective&lt;/a&gt; and &lt;a href=&quot;https://www.youtube.com/watch?v=yLQHDGRLOwQ&quot; rel=&quot;noopener&quot;&gt;The web is not just left to right&lt;/a&gt; to learn more&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; I&#39;m often asked whether I think everyone should use logical properties and values now, or if it will become the default. How would you answer that?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hui Jing:&lt;/strong&gt; Personally, I hope it would become the default, because from a practical perspective, it would make multi-script website development much easier. As to whether it WILL become the default, that&#39;s much harder to answer.&lt;/p&gt;
&lt;p&gt;A challenge for logical properties is that it is &amp;quot;replacing&amp;quot; an established syntax that has been in use for many years, plus the fact that support for scripts that are not the default, horizontal top-to-bottom only got much better in recent years. Content on the web is still predominantly in English, so the case for using logical properties is less strong in this context. I think a larger push for non-English speakers to create content in their respective languages for the web would forward this cause. Also, if supporting multiple languages becomes a greater priority, the value of using logical properties would become even more apparent.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Find out about logical properties and values in the Learn CSS module on &lt;a href=&quot;https://web.dev/learn/css/logical-properties/&quot;&gt;Logical Properties&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;new-features-in-css&quot;&gt;New features in CSS &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/community-highlight-chen-hui-jing/#new-features-in-css&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; What feature or functionality would you love to see added to CSS?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hui Jing:&lt;/strong&gt; I&#39;ve been following Miriam Suzanne&#39;s work on container queries for a while, and the parts of the specification that haven&#39;t been developed yet for Style and State container features are quite exciting, because they really expand the concept of responsive design. We can potentially get our designs and layouts to respond to more than just the size of our viewport. So I hope the containment module is something the different browser vendors can agree on and we can get wider support for this in the near future.&lt;/p&gt;
&lt;h2 id=&quot;inspiring-people-to-follow&quot;&gt;Inspiring people to follow &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/community-highlight-chen-hui-jing/#inspiring-people-to-follow&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; Who else is doing really interesting, fun, or creative work on the web right now?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hui Jing:&lt;/strong&gt; I&#39;m always drawn to people who do CSS art. And there are folks whom I have been a fan of for years, like &lt;a href=&quot;https://twitter.com/yuanchuan23&quot; rel=&quot;noopener&quot;&gt;Yuan Chuan&lt;/a&gt; and his generative CSS creations, &lt;a href=&quot;https://codepen.io/ivorjetski&quot; rel=&quot;noopener&quot;&gt;Ben Evans&lt;/a&gt; who does mind blowing CSS artwork and &lt;a href=&quot;https://www.patreon.com/anatudor&quot; rel=&quot;noopener&quot;&gt;Ana Tudor&lt;/a&gt; with her deep dives into really clever techniques.
Recently I&#39;ve come across Codepens by &lt;a href=&quot;https://codepen.io/miocene/pens/public&quot; rel=&quot;noopener&quot;&gt;Julia Miocene&lt;/a&gt; and &lt;a href=&quot;https://codepen.io/jackiezen&quot; rel=&quot;noopener&quot;&gt;Jackie Zen&lt;/a&gt; that have beautiful CSS animations as well.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; You can read more from Chen Hui Jing on her site at &lt;a href=&quot;https://chenhuijing.com/&quot; rel=&quot;noopener&quot;&gt;chenhuijing.com&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Rachel Andrew</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Building a toast component</title>
      <link href="https://web.dev/docs/building-a-toast-component/"/>
      <updated>2021-12-08T00:00:00Z</updated>
      <id>https://web.dev/docs/building-a-toast-component/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;In this post I want to share thinking on how to build a toast component. Try the
&lt;a href=&quot;https://gui-challenges.web.app/toast/dist/&quot; rel=&quot;noopener&quot;&gt;demo&lt;/a&gt;.&lt;/p&gt;
&lt;figure class=&quot;w-figure w-figure--fullbleed&quot;&gt;
  &lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/HuT5ZhOBd9ZPMcxR8W92.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    &lt;a href=&quot;https://gui-challenges.web.app/toast/dist/&quot;&gt;Demo&lt;/a&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;If you prefer video, here&#39;s a YouTube version of this post:&lt;/p&gt;
&lt;div class=&quot;youtube&quot;&gt;  &lt;lite-youtube videoid=&quot;R75ZVW4LW5o&quot;&gt;  &lt;/lite-youtube&gt;&lt;/div&gt;
&lt;h2 id=&quot;overview&quot;&gt;Overview &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#overview&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Toasts are non-interactive, passive, and asynchronous short messages for users.
Generally they are used as an interface feedback pattern for informing the user
about the results of an action.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.android.com/guide/topics/ui/notifiers/toasts&quot; rel=&quot;noopener&quot;&gt;Toast
component&lt;/a&gt; on
Android&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h3 id=&quot;interactions&quot;&gt;Interactions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#interactions&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Toasts are unlike notifications,
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Window/alert&quot; rel=&quot;noopener&quot;&gt;alerts&lt;/a&gt; and
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Window/prompt&quot; rel=&quot;noopener&quot;&gt;prompts&lt;/a&gt; because
they&#39;re not interactive; they&#39;re not meant to be dismissed or persist.
Notifications are for more important information, synchronous messaging that
requires interaction, or system level messages (as opposed to page level).
Toasts are more passive than other notice strategies.&lt;/p&gt;
&lt;h2 id=&quot;markup&quot;&gt;Markup &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#markup&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The
&lt;a href=&quot;https://html.spec.whatwg.org/multipage/form-elements.html#the-output-element&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;&amp;lt;output&amp;gt;&lt;/code&gt;&lt;/a&gt;
element is a good choice for the toast because it is announced to screen
readers. Correct HTML provides a safe base for us to enhance with JavaScript and
CSS, and there will be lots of JavaScript.&lt;/p&gt;
&lt;h3 id=&quot;a-toast&quot;&gt;A toast &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#a-toast&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;output&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;gui-toast&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Item added to cart&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;output&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;It can be &lt;a href=&quot;https://www.scottohara.me/blog/2019/07/08/a-toast-to-a11y-toasts.html#:~:text=WCAG%20success%20criteria.-,Inclusive%20UX%20of%20a%20toast,-A%20toast%20component&quot; rel=&quot;noopener&quot;&gt;more
inclusive&lt;/a&gt;
by adding &lt;a href=&quot;https://w3c.github.io/aria/#status&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;role=&amp;quot;status&amp;quot;&lt;/code&gt;&lt;/a&gt;. This provides a
fallback if the browser doesn&#39;t give &lt;code&gt;&amp;lt;output&amp;gt;&lt;/code&gt; elements the &lt;a href=&quot;https://developer.mozilla.org/docs/Web/HTML/Element/output#:~:text=accepts%20phrasing%20content.-,Implicit%20ARIA%20role,-status&quot; rel=&quot;noopener&quot;&gt;implicit
role&lt;/a&gt;
per the spec.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;output&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;gui-toast&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Item added to cart&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;output&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;a-toast-container&quot;&gt;A toast container &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#a-toast-container&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;More than one toast can be shown at a time. In order to orchestrate multiple
toasts, a container is used. This container also handles the position of the
toasts on the screen.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;section&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;gui-toast-group&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;output&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Wizard Rose added to cart&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;output&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;output&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Self Watering Pot added to cart&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;output&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;section&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;layouts&quot;&gt;Layouts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#layouts&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I chose to pin toasts to the
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/inset-block-end&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;inset-block-end&lt;/code&gt;&lt;/a&gt;
of the viewport, and if more toasts are added, they stack from that screen edge.&lt;/p&gt;
&lt;h3 id=&quot;gui-container&quot;&gt;GUI container &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#gui-container&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The toasts container does all the layout work for presenting toasts. It&#39;s
&lt;code&gt;fixed&lt;/code&gt; to the viewport and uses the logical property
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/inset&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;inset&lt;/code&gt;&lt;/a&gt; to specify which
edges to pin to, plus a little bit of &lt;code&gt;padding&lt;/code&gt; from the same &lt;code&gt;block-end&lt;/code&gt; edge.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.gui-toast-group&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; fixed&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;z-index&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;inset-block-end&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;inset-inline&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;padding-block-end&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 5vh&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;Screenshot with DevTools box size and padding overlayed on a .gui-toast-container element.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;248&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/yJfP9FLqpngoR9zIm35J.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;In addition to positioning itself within the viewport, the toast container is a
grid container that can align and distribute toasts. Items are centered as a
group with &lt;code&gt;justify-content&lt;/code&gt; and individually centered with &lt;code&gt;justify-items&lt;/code&gt;.
Throw in a little bit of &lt;code&gt;gap&lt;/code&gt; so toasts don&#39;t touch.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.gui-toast-group&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; grid&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;justify-items&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; center&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;justify-content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; center&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;gap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1vh&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;Screenshot with the CSS grid overlay on the toast group, this time highlighting the space and gaps between toast child elements.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;292&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/kaTSVr7KToPBYqDXKE4T.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;gui-toast&quot;&gt;GUI Toast &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#gui-toast&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;An individual toast has some &lt;code&gt;padding&lt;/code&gt;, some softer corners with
&lt;a href=&quot;https://developer.mozilla.org/edocs/Web/CSS/border-radius&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;border-radius&lt;/code&gt;&lt;/a&gt;,
and a &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/min()&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;min()&lt;/code&gt;&lt;/a&gt; function to
aid in mobile and desktop sizing. The responsive size in the following CSS
prevents toasts growing wider than 90% of the viewport or
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/length&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;25ch&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.gui-toast&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;max-inline-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;25ch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 90vw&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;padding-block&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .5ch&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;padding-inline&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1ch&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 3px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1rem&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;Screenshot of a single .gui-toast element, with the padding and border radius shown.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;223&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/fxZbpWDiuZCfpY2Cxq6A.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;styles&quot;&gt;Styles &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#styles&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;With layout and positioning set, add CSS that helps with adapting to user
settings and interactions.&lt;/p&gt;
&lt;h3 id=&quot;toast-container&quot;&gt;Toast container &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#toast-container&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Toasts are not interactive, tapping or swiping on them doesn&#39;t do anything, but
they do currently consume pointer events. Prevent the toasts from stealing
clicks with the following CSS.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.gui-toast-group&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;pointer-events&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/3uDub8eM8qYAepz6lbX0.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h3 id=&quot;gui-toast-2&quot;&gt;GUI Toast &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#gui-toast-2&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Give the toasts a light or dark adaptive theme with custom properties, HSL and a
preference media query.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.gui-toast&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_bg-lightness&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 90%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; black&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;0 0% &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_bg-lightness&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 90%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;prefers-color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.gui-toast&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; white&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--_bg-lightness&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 20%&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/AUzcAPLccQdvIL2bR3pd.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h3 id=&quot;animation&quot;&gt;Animation &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#animation&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A new toast should present itself with an animation as it enters the screen.
Accommodating reduced motion is done by setting &lt;code&gt;translate&lt;/code&gt; values to &lt;code&gt;0&lt;/code&gt; by
default, but updating the motion value to a length in a motion preference media
query . Everyone gets some animation, but only some users have the toast travel
a distance.&lt;/p&gt;
&lt;p&gt;Here are the keyframes used for the toast animation. CSS will be controlling the
entrance, the wait, and the exit of the toast, all in one animation.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@keyframes&lt;/span&gt; fade-in&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0 &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@keyframes&lt;/span&gt; fade-out&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0 &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@keyframes&lt;/span&gt; slide-in&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;translateY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_travel-distance&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 10px&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The toast element then sets up the variables and orchestrates the keyframes.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.gui-toast&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_duration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 3s&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_travel-distance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;will-change&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; transform&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;br /&gt;    fade-in .3s ease&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    slide-in .3s ease&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    fade-out .3s ease &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;prefers-reduced-motion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; no-preference&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.gui-toast&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--_travel-distance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 5vh&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/QeeF8vZ5gbXrxfp7EjRf.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h2 id=&quot;javascript&quot;&gt;JavaScript &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#javascript&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;With the styles and screen reader accessible HTML ready, JavaScript is needed to
orchestrate the creation, addition, and destruction of toasts based on user
events. The developer experience of the toast component should be minimal and
easy to get started with, like this:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Toast &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;./toast.js&#39;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;Toast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;My first toast&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;creating-the-toast-group-and-toasts&quot;&gt;Creating the toast group and toasts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#creating-the-toast-group-and-toasts&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;When the toast module loads from JavaScript, it must create a toast container
and add it to the page. I chose to add the element before &lt;code&gt;body&lt;/code&gt;, this will make
&lt;code&gt;z-index&lt;/code&gt; stacking issues unlikely as the container is above the container for
all the body elements.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; node &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;section&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  node&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;classList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;gui-toast-group&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;firstElementChild&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;insertBefore&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;node&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;body&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; node&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;Screenshot of the toast group between the head and body tags.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;308&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/3O34m8U5Z6BsLUwzcKDx.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;The &lt;code&gt;init()&lt;/code&gt; function is called internally to the module, stashing the element
as &lt;code&gt;Toaster&lt;/code&gt;:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; Toaster &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Toast HTML element creation is done with the &lt;code&gt;createToast()&lt;/code&gt; function. The
function requires some text for the toast, creates an &lt;code&gt;&amp;lt;output&amp;gt;&lt;/code&gt; element, adorns
it with some classes and attributes, sets the text, and returns the node.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;createToast&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; node &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;output&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;br /&gt;  node&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerText &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; text&lt;br /&gt;  node&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;classList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;gui-toast&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  node&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;role&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;status&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; node&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;managing-one-or-many-toasts&quot;&gt;Managing one or many toasts &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#managing-one-or-many-toasts&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/3slAqrQiWDmnBnEgSPYz.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;JavaScript now adds a container to the document for containing toasts and is
ready to add created toasts. The &lt;code&gt;addToast()&lt;/code&gt; function orchestrates handling one
or many toasts. First checking the number of toasts, and whether motion is ok,
then using this information to either append the toast or do some fancy
animation so the other toasts appear to &amp;quot;make room&amp;quot; for the new toast.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;addToast&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;toast&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; matches&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;motionOK &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;matchMedia&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;(prefers-reduced-motion: no-preference)&#39;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  Toaster&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; motionOK&lt;br /&gt;    &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;flipToast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;toast&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Toaster&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;toast&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;When adding the first toast, &lt;code&gt;Toaster.appendChild(toast)&lt;/code&gt; adds a toast to the
page triggering the CSS animations: animate in, wait &lt;code&gt;3s&lt;/code&gt;, animate out.
&lt;code&gt;flipToast()&lt;/code&gt; is called when there are existing toasts, employing a technique
called &lt;a href=&quot;https://aerotwist.com/blog/flip-your-animations/&quot; rel=&quot;noopener&quot;&gt;FLIP&lt;/a&gt; by &lt;a href=&quot;https://twitter.com/aerotwist&quot; rel=&quot;noopener&quot;&gt;Paul
Lewis&lt;/a&gt;. The idea is to calculate the difference
in positions of the container, before and after the new toast has been added.
Think of it like marking where the Toaster is now, where it&#39;s going to be, then
animating from where it was to where it is.&lt;/p&gt;
&lt;aside class=&quot;aside flow color-secondary-box-text bg-secondary-box-bg&quot;&gt;
&lt;p class=&quot;cluster &quot;&gt;
&lt;span class=&quot;aside__icon box-block &quot;&gt;&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;currentColor&quot; role=&quot;img&quot; aria-label=&quot;Highlighter pen&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
  &lt;path fill-rule=&quot;evenodd&quot; clip-rule=&quot;evenodd&quot; d=&quot;M10.22 9.49l-5.91 6c-.77.8-.7 2.05.08 2.85L.77 22h5.68l.74-.75c.78.81 1.95.86 2.73.05l5.96-6.05-5.66-5.76zm12.46-4l-2.82-2.87c-.78-.8-2.07-.84-2.84-.04l-5.75 5.85 5.66 5.75 5.69-5.78c.77-.81.83-2.11.06-2.91z&quot;&gt;&lt;/path&gt;
&lt;/svg&gt;&lt;/span&gt;
&lt;strong&gt;Key Term&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;FLIP stands for: First, Last, Invert, and Play. A handy acronym to assist in understanding the animation concept.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;flipToast&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;toast&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// FIRST&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; first &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Toaster&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;offsetHeight&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// add new child to change container size&lt;/span&gt;&lt;br /&gt;  Toaster&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;toast&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// LAST&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; last &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Toaster&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;offsetHeight&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// INVERT&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; invert &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; last &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; first&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// PLAY&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; animation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Toaster&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;animate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; transform&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;translateY(&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;invert&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;px)&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; transform&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;translateY(0)&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    duration&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;150&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    easing&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;ease-out&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;CSS grid does the lifting of the layout. When a new toast is added, grid puts it
at the start and spaces it with the others. Meanwhile, a &lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Web_Animations_API&quot; rel=&quot;noopener&quot;&gt;web
animation&lt;/a&gt; is
used to animate the container from the old position.&lt;/p&gt;
&lt;h3 id=&quot;putting-all-the-javascript-together&quot;&gt;Putting all the JavaScript together &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#putting-all-the-javascript-together&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;When &lt;code&gt;Toast(&#39;my first toast&#39;)&lt;/code&gt; is called, a toast is created, added to the page
(maybe even the container is animated to accommodate the new toast), a
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise&quot; rel=&quot;noopener&quot;&gt;promise&lt;/a&gt;
is returned and the created toast is
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Element/getAnimations&quot; rel=&quot;noopener&quot;&gt;watched&lt;/a&gt; for
CSS animation completion (the three keyframe animations) for promise resolution.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;Toast&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token parameter&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; toast &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;createToast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;addToast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;toast&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;resolve&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; reject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; Promise&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;allSettled&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;      toast&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAnimations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;animation&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;br /&gt;        animation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;finished&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    Toaster&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;removeChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;toast&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;I felt the confusing part of this code is in the &lt;code&gt;Promise.allSettled()&lt;/code&gt; function
and &lt;code&gt;toast.getAnimations()&lt;/code&gt; mapping. Since I used multiple keyframe animations
for the toast, to confidently know all of them have finished, each must be
requested from JavaScript and each of their
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Animation/finished&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;finished&lt;/code&gt;&lt;/a&gt;
promises observed for completion.
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;allSettled&lt;/code&gt;&lt;/a&gt;
does that work for us, resolving itself as complete once all of its promises
have been fulfilled. Using &lt;code&gt;await Promise.allSettled()&lt;/code&gt; means the next line of
code can confidently remove the element and assume the toast has completed its
lifecycle. Finally, calling &lt;code&gt;resolve()&lt;/code&gt; fulfills the high level Toast promise so
developers can clean up or do other work once the toast has shown.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; Toast&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Last, the &lt;code&gt;Toast&lt;/code&gt; function is exported from the module, for other scripts to
import and use.&lt;/p&gt;
&lt;h3 id=&quot;using-the-toast-component&quot;&gt;Using the Toast component &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#using-the-toast-component&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Using the toast, or the toast&#39;s developer experience, is done by importing the
&lt;code&gt;Toast&lt;/code&gt; function and calling it with a message string.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Toast &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;./toast.js&#39;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;Toast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Wizard Rose added to cart&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;If the developer wants to do clean up work or whatever, after the toast has
shown, they can use async and
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/await&quot; rel=&quot;noopener&quot;&gt;await&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Toast &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;./toast.js&#39;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;example&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Toast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Wizard Rose added to cart&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;toast finished&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now that you know how I did it, how would you‽ 🙂&lt;/p&gt;
&lt;p&gt;Let&#39;s diversify our approaches and learn all the ways to build on the web.
Create a demo, &lt;a href=&quot;https://twitter.com/argyleink&quot; rel=&quot;noopener&quot;&gt;tweet me&lt;/a&gt; links, and I&#39;ll add it
to the community remixes section below!&lt;/p&gt;
&lt;h2 id=&quot;community-remixes&quot;&gt;Community remixes &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-toast-component/#community-remixes&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://twitter.com/_developit&quot; rel=&quot;noopener&quot;&gt;@_developit&lt;/a&gt; with HTML/CSS/JS: &lt;a href=&quot;https://jsfiddle.net/developit/v293tnaj/&quot; rel=&quot;noopener&quot;&gt;demo &amp;amp; code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://twitter.com/jhvanderschee&quot; rel=&quot;noopener&quot;&gt;Joost van der Schee&lt;/a&gt; with HTML/CSS/JS: &lt;a href=&quot;https://codepen.io/joosts/pen/PoJzGpm&quot; rel=&quot;noopener&quot;&gt;demo &amp;amp; code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
      <author>
          <name>Adam Argyle</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>The UI fund</title>
      <link href="https://web.dev/docs/ui-fund/"/>
      <updated>2021-12-06T00:00:00Z</updated>
      <id>https://web.dev/docs/ui-fund/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;Chrome has launched a fund to support the UI ecosystem. We designed this fund to provide grants to people who work on design tools, CSS, and HTML.&lt;/p&gt;
&lt;p&gt;All of us who work on the web regularly benefit from the work of people who create specifications, tools, demos, tutorials, and polyfills. Many of these resources are side projects, made available and supported free of charge. They exist because someone saw a need, created something to meet it, then shared it with the rest of the ecosystem.&lt;/p&gt;
&lt;p&gt;We want to recognize and help support this work and invest in the CSS ecosystem. We&#39;re excited to enable people to spend time on these projects and create more value for the web.&lt;/p&gt;
&lt;h2 id=&quot;what-type-of-projects-can-apply&quot;&gt;What type of projects can apply? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#what-type-of-projects-can-apply&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The following ideas are examples of the types of projects that would be a candidate for this fund. However, we are keen to hear your ideas.&lt;/p&gt;
&lt;h3 id=&quot;open-ui-work&quot;&gt;Open UI work &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#open-ui-work&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Design research projects, for example researching the date range component or another component you care about, in order to create a &lt;a href=&quot;https://open-ui.org/proposal-guide&quot; rel=&quot;noopener&quot;&gt;new proposal&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;specification-writers&quot;&gt;Specification writers &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#specification-writers&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We are keen to help more people become involved in writing specifications. In addition to funding we can help you to make the right contacts and work with experienced specification editors.&lt;/p&gt;
&lt;h3 id=&quot;accessibility-work-and-research&quot;&gt;Accessibility work and research &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#accessibility-work-and-research&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Work on Open UI and new CSS layout techniques are raising accessibility issues that need research and testing before they can be resolved. For example, researching the impact of a pattern such as toggle.&lt;/p&gt;
&lt;p&gt;We&#39;d be interested in projects that involved the accessibility community in ensuring that new proposals are underpinned by solid research with real users.&lt;/p&gt;
&lt;h3 id=&quot;polyfills-tools-and-demos&quot;&gt;Polyfills, tools, and demos &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#polyfills-tools-and-demos&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Are you working on a polyfill that will enable the use of an API across more browsers? Are you involved in tooling such as Sass and PostCSS? Do you have an idea for an advanced demo that would clearly show the possibilities of some newer or experimental APIs? How about a plugin for Figma? All of these things and more could be a great candidate for a grant.&lt;/p&gt;
&lt;h3 id=&quot;solving-problems-in-key-areas&quot;&gt;Solving problems in key areas &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#solving-problems-in-key-areas&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;There are a number of key places where developers struggle to realize their UI goals. Some of these are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Scrolling&lt;/li&gt;
&lt;li&gt;Form elements&lt;/li&gt;
&lt;li&gt;Toggle&lt;/li&gt;
&lt;li&gt;Mobile layout and UI elements&lt;/li&gt;
&lt;li&gt;Layout in general-for example regions&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Projects around these key areas would be of interest. The shape of that project is up to you. It could be a pure research project, design ideas, specification development. We can provide funding and also connections for people with solid ideas in these spaces.&lt;/p&gt;
&lt;h2 id=&quot;who-can-apply&quot;&gt;Who can apply? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#who-can-apply&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;You need an Open Collective account. You can apply for a project you own or nominate a project that you think deserves support. If you don&#39;t own the project, you&#39;ll need a thumbs up from one of the core maintainers that they would accept a change such as the one you are proposing.&lt;/p&gt;
&lt;h2 id=&quot;how-will-the-submissions-be-judged&quot;&gt;How will the submissions be judged? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#how-will-the-submissions-be-judged&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The project is owned by &lt;a href=&quot;http://twitter.com/sarah_edo&quot; rel=&quot;noopener&quot;&gt;Sarah Drasner&lt;/a&gt; and &lt;a href=&quot;http://twitter.com/stubbornella&quot; rel=&quot;noopener&quot;&gt;Nicole Sullivan&lt;/a&gt;, in order to make decisions on the suitability of a project they will work with specialists in that area to assess the idea. They will be assessing ideas based on the potential impact of the work. Therefore, when making your proposal demonstrate how it will have an impact on standards, tooling, design, or accessibility.&lt;/p&gt;
&lt;h2 id=&quot;how-do-i-apply&quot;&gt;How do I apply? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ui-fund/#how-do-i-apply&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This is a rolling fund, therefore there is no deadline for submissions.&lt;/p&gt;
&lt;p&gt;Create a GitHub issue or document describing the project, if one doesn&#39;t already exist. If your proposal is an addition to an existing project, then an issue will allow you to demonstrate interest from the core maintainers.&lt;/p&gt;
&lt;p&gt;For new ideas and research proposals, create a document that explains the project, your interest and experience in the area, and the impact that you believe this project can have on the CSS ecosystem.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://forms.gle/7knaw5FvFtGVEthV7&quot; rel=&quot;noopener&quot;&gt;Complete the form&lt;/a&gt; to make your initial application.&lt;/p&gt;
&lt;p&gt;After applying we&#39;ll be in touch, perhaps initially to discuss the idea and find out more before making a decision. We are so excited to read your ideas, and to help you be a part of improving the CSS ecosystem.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Image credit &lt;a href=&quot;https://wocintechchat.com/&quot; rel=&quot;noopener&quot;&gt;#WOCinTech&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
</content>
      <author>
          <name>Nicole Sullivan</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Kapwing: Powerful video editing for the web</title>
      <link href="https://web.dev/docs/kapwing/"/>
      <updated>2021-12-06T00:00:00Z</updated>
      <id>https://web.dev/docs/kapwing/</id>
      <content type="text/html" mode="escaped">&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Joshua is the Chief Technology Officer at &lt;a href=&quot;https://www.kapwing.com/&quot; rel=&quot;noopener&quot;&gt;Kapwing&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;Online video consumption has grown rapidly since the start of the pandemic.
People are spending more time consuming endless high-quality video on
platforms such as TikTok, Instagram, and YouTube. Creatives and small business
owners all over the world need quick and easy-to-use tools to make video
content.&lt;/p&gt;
&lt;p&gt;Companies like Kapwing make it possible to create all this video content right
on the web, by using the latest in powerful APIs and performance tools.&lt;/p&gt;
&lt;div class=&quot;youtube&quot;&gt;  &lt;lite-youtube videoid=&quot;Df2U9-R-OJs&quot; videoStartAt=&quot;974&quot;&gt;  &lt;/lite-youtube&gt;&lt;/div&gt;
&lt;h2 id=&quot;about-kapwing&quot;&gt;About Kapwing &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/kapwing/#about-kapwing&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Kapwing is a web-based collaborative video editor designed mainly for casual
creatives like game-streamers, musicians, YouTube creators, and meme-rs. It&#39;s
also a go-to resource for business owners who need an easy way to produce
their own social content, such as Facebook and Instagram ads.&lt;/p&gt;
&lt;p&gt;People discover Kapwing by searching for a specific task, for example &amp;quot;how to
trim a video,&amp;quot; &amp;quot;add music to my video,&amp;quot; or &amp;quot;resize a video.&amp;quot; They can do what
they searched for with just one click—without the added friction of
navigating to an app store and downloading an app. The web makes it simple for
people to search for precisely what task they need help with, and then do it.&lt;/p&gt;
&lt;p&gt;After that first click, Kapwing users can do a whole lot more. They can
explore free templates, add new layers of free stock videos, insert
subtitles, transcribe videos, and upload background music.&lt;/p&gt;
&lt;h2 id=&quot;how-kapwing-brings-real-time-editing-and-collaboration-to-the-web&quot;&gt;How Kapwing brings real-time editing and collaboration to the web &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/kapwing/#how-kapwing-brings-real-time-editing-and-collaboration-to-the-web&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;While the web provides unique advantages, it also presents distinct
challenges. Kapwing needs to deliver smooth and precise playback of complex,
multi-layered projects across a wide range of devices and network conditions.
To achieve this, we use a variety of web APIs to achieve our performance and
feature goals.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Kapwing&#39;s work was featured at Chrome Developer Summit in November 2021.
&lt;a href=&quot;https://www.youtube.com/watch?v=Df2U9-R-OJs&amp;amp;t=974s&quot; rel=&quot;noopener&quot;&gt;Watch the keynote&lt;/a&gt; for
an overview of Kapwing&#39;s work, and keep reading to take a closer look at the
technical implementation.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h3 id=&quot;indexeddb&quot;&gt;IndexedDB &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/kapwing/#indexeddb&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;High performance editing requires that all of our users&#39; content live on the
client, avoiding the network whenever possible. Unlike a streaming service,
where users typically access a piece of content once, our customers reuse
their assets frequently, days and even months after upload.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://web.dev/storage-for-the-web/&quot;&gt;IndexedDB&lt;/a&gt; allows us to provide persistent file
system-like storage to our users. The result is that over 90% of media
requests in the app are fulfilled locally. Integrating IndexedDB into our
system was very straightforward.&lt;/p&gt;
&lt;p&gt;Here is some boiler plate initialization code that runs on app load:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;DBSchema&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; openDB&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; deleteDB&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; IDBPDatabase&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;idb&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; openIdb&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Promise &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;IDBPDatabase&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Schema&lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; db &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; openDB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;br /&gt;  Schema &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;kapwing&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;upgrade&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;db&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; oldVersion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;oldVersion &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;          &lt;span class=&quot;token comment&quot;&gt;// assets store schema changed, need to recreate&lt;/span&gt;&lt;br /&gt;          db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;deleteObjectStore&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;assets&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;        db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createObjectStore&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;assets&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;          keyPath&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;mediaLibraryID&#39;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;blocked&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;deleteDB&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;kapwing&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;blocking&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;deleteDB&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;kapwing&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;We pass a version and define an &lt;code&gt;upgrade&lt;/code&gt; function. This is used for
initialization or to update our schema when necessary. We pass error-handling
callbacks, &lt;code&gt;blocked&lt;/code&gt; and &lt;code&gt;blocking&lt;/code&gt;, which we&#39;ve found useful in
preventing issues for users with unstable systems.&lt;/p&gt;
&lt;p&gt;Finally, note our definition of a primary key &lt;code&gt;keyPath&lt;/code&gt;. In our case, this is a
unique ID we call &lt;code&gt;mediaLibraryID&lt;/code&gt;. When a user adds a piece of media to our system, whether via our uploader or a third party extension, we add the media
to our media library with the following code:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;addAsset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;mediaLibraryID&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; string&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; file&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; File&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;runWithAssetMutex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; assetAlreadyInStore &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; openIdb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&#39;assets&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      mediaLibraryID&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;    &lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;assetAlreadyInStore&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; idbVideo&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IdbVideo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      file&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; openIdb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;assets&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; idbVideo&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;runWithAssetMutex&lt;/code&gt; is our own internally defined function that serializes
IndexedDB access. This is required for any read-modify-write type operations,
as the IndexedDB API is asynchronous.&lt;/p&gt;
&lt;p&gt;Now let&#39;s take a look at how we access files. Below is our &lt;code&gt;getAsset&lt;/code&gt; function:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getAsset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token parameter&quot;&gt;mediaLibraryID&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; string&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  source&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; LayerSource &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;undefined&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  location&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; string&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Promise&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;IdbAsset &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;undefined&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; asset&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IdbAsset &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;undefined&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; idbCache &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; window&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; assetInCache &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; idbCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;assetInCache &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; assetInCache&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;complete&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    asset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; assetInCache&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asset&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;assetInCache &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; assetInCache&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;pending&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    asset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Promise&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      assetInCache&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;subscribers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;res&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    idbCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; subscribers&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; status&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;pending&#39;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    asset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; openIdb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;assets&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    idbCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asset&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    idbCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;subscribers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;res&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asset&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;idbCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; any&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;subscribers&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asset&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      idbCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;complete&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      idbCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;mediaLibraryID&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;failed&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; asset&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;We have our own data structure, &lt;code&gt;idbCache&lt;/code&gt;, that is used to minimize IndexedDB
accesses. While IndexedDB is fast, accessing local memory is faster. We
recommend this approach so long as you manage the size of the cache.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;subscribers&lt;/code&gt; array, which is used to prevent simultaneous access to
IndexedDB, would otherwise be common on load.&lt;/p&gt;
&lt;h3 id=&quot;web-audio-api&quot;&gt;Web Audio API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/kapwing/#web-audio-api&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Audio visualization is incredibly important for video editing. To understand
why, take a look at a screenshot from the editor:&lt;/p&gt;
&lt;img alt=&quot;Kapwing&amp;#x27;s editor has a menu for media, including several templates and custom elements, including some templates which are specific to certain platforms like LinkedIn; a timeline which separates video, audio, and animation; canvas editor with export quality options; a preview of the video; and more capabilities.&quot; decoding=&quot;async&quot; height=&quot;397&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/VbsHyyQopiec0718rMq2kTE1hke2/6MqSyhNqFl23wN3GWKbP.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;This is a YouTube style video, which is common in our app. The user doesn&#39;t
move very much throughout the clip, so the timelines visual thumbnails aren&#39;t
as useful for navigating between sections. On the other hand, the audio
&lt;a href=&quot;https://en.wikipedia.org/wiki/Waveform&quot; rel=&quot;noopener&quot;&gt;waveform&lt;/a&gt; shows peaks and valleys,
with the valleys typically corresponding to dead time in the recording. If you
zoom in on the timeline, you&#39;d see more fine grained audio information with
valleys corresponding to stutters and pauses.&lt;/p&gt;
&lt;p&gt;Our user research shows that creators are often guided by these waveforms as
they splice their content. The web audio API allows us to present this
information performantly and to update quickly on a zoom or pan of the
timeline.&lt;/p&gt;
&lt;p&gt;The snippet below demonstrates how we do this:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;getDownsampledBuffer&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;idbAsset&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; IdbAsset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt;&lt;br /&gt;  decodeMutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;runExclusive&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Promise&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Float32Array&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; arrayBuffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; idbAsset&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;arrayBuffer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; audioContext &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AudioContext&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; audioBuffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; audioContext&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;decodeAudioData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;arrayBuffer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; offline &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OfflineAudioContext&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;        audioBuffer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;numberOfChannels&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        audioBuffer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;duration &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MIN_BROWSER_SUPPORTED_SAMPLE_RATE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token constant&quot;&gt;MIN_BROWSER_SUPPORTED_SAMPLE_RATE&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; downsampleSource &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; offline&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createBufferSource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      downsampleSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; audioBuffer&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      downsampleSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      downsampleSource&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;offline&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;destination&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; downsampledBuffer22K &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; offline&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;startRendering&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; downsampledBuffer22KData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; downsampledBuffer22K&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; downsampledBuffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Float32Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;        Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;floor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;          downsampledBuffer22KData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;POST_BROWSER_SAMPLE_INTERVAL&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; j &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; downsampledBuffer22KData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        i &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;POST_BROWSER_SAMPLE_INTERVAL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; j &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; sum &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; k &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; k &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;POST_BROWSER_SAMPLE_INTERVAL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; k &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;          sum &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;downsampledBuffer22KData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; k&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; avg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sum &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;POST_BROWSER_SAMPLE_INTERVAL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        downsampledBuffer&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;j&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; avg&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; downsampledBuffer&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;We pass this helper the asset that is stored in IndexedDB. Upon completion we
will update the asset in IndexedDB as well as our own cache.&lt;/p&gt;
&lt;p&gt;We gather data about the &lt;code&gt;audioBuffer&lt;/code&gt; with the &lt;code&gt;AudioContext&lt;/code&gt; constructor,
but because we aren&#39;t rendering to the device hardware we use the
&lt;code&gt;OfflineAudioContext&lt;/code&gt; to render to an &lt;code&gt;ArrayBuffer&lt;/code&gt; where we will store
amplitude data.&lt;/p&gt;
&lt;p&gt;The API itself returns data at a sample rate much higher than needed for
effective visualization. That&#39;s why we manually downsample to 200 Hz, which we
found to be enough for useful, visually appealing waveforms.&lt;/p&gt;
&lt;h3 id=&quot;webcodecs&quot;&gt;WebCodecs &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/kapwing/#webcodecs&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;For certain videos the track thumbnails are more useful for timeline
navigation than the waveforms. However, generating thumbnails is more resource
intensive than generating waveforms.&lt;/p&gt;
&lt;p&gt;We can&#39;t cache every potential thumbnail on load, so quick decode on timeline
pan/zoom is critical to a performant and responsive application. The
bottleneck to achieving smooth frame drawing is decoding frames, which until
recently we did using an HTML5 video player. The performance of that approach
wasn&#39;t reliable and we often saw degraded app responsiveness during frame
rendering.&lt;/p&gt;
&lt;p&gt;Recently we have moved over to &lt;a href=&quot;https://web.dev/webcodecs/&quot;&gt;WebCodecs&lt;/a&gt;, which can be used in
web workers. This should enhance our ability to draw thumbnails for large
amounts of layers  without impacting main thread performance. While the web
worker implementation  is still in progress, we give an outline below of our
existing main thread implementation.&lt;/p&gt;
&lt;p&gt;A video file contains multiple streams: video, audio, subtitles and so on that
are &#39;muxed&#39; together. To use WebCodecs, we first need to have a demuxed video
stream. We demux mp4s with the mp4box library, as shown here:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;demuxer&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;file &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; MP4Box&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;onReady&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;info&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; info&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;_info_resolver&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;info&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;loadMetadata&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;loadMetadata&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; offset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; asset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getAsset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mediaLibraryId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; maxFetchOffset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asset&lt;span class=&quot;token operator&quot;&gt;?.&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;size &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; end &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; offset &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;FETCH_SIZE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    headers&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;bytes=&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;offset&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;end&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; reader &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;body&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getReader&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; done&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;done&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; done&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; reader&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;done&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; buf&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; ArrayBufferLike &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; fileStart&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; number &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;buffer&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    buf&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fileStart &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; offset&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    offset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendBuffer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;buf&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This snippet refers to a &lt;code&gt;demuxer&lt;/code&gt; class, which we use to encapsulate the
interface to &lt;code&gt;MP4Box&lt;/code&gt;. We once again access the asset from IndexedDB. These
segments aren&#39;t necessarily stored in byte order, and that the &lt;code&gt;appendBuffer&lt;/code&gt;
method returns the offset of the next chunk.&lt;/p&gt;
&lt;p&gt;Here&#39;s how we decode a video frame:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; getFrameFromVideoDecoder &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;demuxer&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; any&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Promise&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;any&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; desiredSampleIndex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getFrameIndexForTimestamp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;frameTime&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; timestampToMatch&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; number&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; decodedSample&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; VideoFrame &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;outputCallback&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;frame&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; VideoFrame&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;frame&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;timestamp &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; timestampToMatch&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; decodedSample &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; frame&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; frame&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; decoder &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;VideoDecoder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    output&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; outputCallback&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    codec&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    codecWidth&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    codecHeight&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getDecoderConfigurationInfo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  decoder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; codec&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; codecWidth&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; codecHeight&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; description &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* begin demuxer interface */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; preceedingKeyFrameIndex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getPreceedingKeyFrameIndex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    desiredSampleIndex&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; trak_id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;trak_id&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; trak &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;moov&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;traks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;find&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;trak&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; any&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; trak&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tkhd&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;track_id &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; trak_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; demuxer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getFrameDataRange&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    preceedingKeyFrameIndex&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    desiredSampleIndex&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* end demuxer interface */&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; preceedingKeyFrameIndex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;=&lt;/span&gt; desiredSampleIndex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; sample &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; trak&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;samples&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; sampleData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;readNBytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;      sample&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;offset&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      sample&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;size&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; sampleType &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sample&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;is_sync &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;key&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;delta&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; encodedFrame &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EncodedVideoChunk&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      sampleType&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      timestamp&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; sample&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cts&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      duration&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; sample&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;duration&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      samapleData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; desiredSampleIndex&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;      timestampToMatch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; encodedFrame&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;timestamp&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    decoder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;decodeEncodedFrame&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;encodedFrame&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; decoder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;flush&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; type&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;value&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; decodedSample &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The structure of the demuxer is quite complex and beyond the scope of this
article. It stores each frame in an array titled &lt;code&gt;samples&lt;/code&gt;. We use the demuxer
to find the closest preceding key frame to our desired timestamp, which is
where we must begin video decode.&lt;/p&gt;
&lt;p&gt;Videos are composed of full frames, known as key or i-frames, as well as much
smaller delta frames, often referred to as p- or b-frames. Decode must always
begin at a key frame.&lt;/p&gt;
&lt;p&gt;The application decodes frames by:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Instantiating the decoder with a frame output callback.&lt;/li&gt;
&lt;li&gt;Configuring the decoder for the specific codec and input resolution.&lt;/li&gt;
&lt;li&gt;Creating an &lt;code&gt;encodedVideoChunk&lt;/code&gt; using data from the demuxer.&lt;/li&gt;
&lt;li&gt;Calling the &lt;code&gt;decodeEncodedFrame&lt;/code&gt; method.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We do this until we reach the frame with the desired timestamp.&lt;/p&gt;
&lt;h2 id=&quot;what&#39;s-next&quot;&gt;What&#39;s next? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/kapwing/#what&#39;s-next&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We define scale on our frontend as the ability to maintain precise and
performant playback as projects get larger and more complex. One way to scale
performance is to mount as few videos as possible at once, however when we do
this, we risk slow and choppy transitions. While we&#39;ve developed internal
systems to cache video components for reuse, there are limitations to how much
control HTML5 video tags can provide.&lt;/p&gt;
&lt;p&gt;In the future, we may attempt to play all media using WebCodecs. This could
allow us to be very precise about what data we buffer which should help scale
performance.&lt;/p&gt;
&lt;p&gt;We can also do a better job of offloading large trackpad computations to
&lt;a href=&quot;https://web.dev/off-main-thread/&quot;&gt;web workers&lt;/a&gt;, and we can be smarter about pre-fetching
files and pre-generating frames. We see large opportunities to optimize our
overall application performance and to extend functionality with tools like
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/WebGL_API&quot; rel=&quot;noopener&quot;&gt;WebGL&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We would like to continue our investment in
&lt;a href=&quot;https://www.tensorflow.org/js&quot; rel=&quot;noopener&quot;&gt;TensorFlow.js&lt;/a&gt;, which we currently use for
intelligent background removal. We plan to leverage TensorFlow.js for other
sophisticated tasks such as object detection, feature extraction, style transfer, and so on.&lt;/p&gt;
&lt;p&gt;Ultimately, we&#39;re excited to continue builing our product with native-like
performance and functionality on a free and open web.&lt;/p&gt;
</content>
      <author>
          <name>Joshua Grossberg</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Community highlight: Bramus Van Damme</title>
      <link href="https://web.dev/docs/community-highlight-bramus/"/>
      <updated>2021-12-04T00:00:00Z</updated>
      <id>https://web.dev/docs/community-highlight-bramus/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;&lt;em&gt;This post is part of &lt;a href=&quot;https://designcember.com/&quot; rel=&quot;noopener&quot;&gt;Designcember&lt;/a&gt;. A celebration of web design, brought to you by web.dev.&lt;/em&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img alt=&quot;Bramus on stage in from of a large screen showing slides.&quot; decoding=&quot;async&quot; height=&quot;533&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/kheDArv5csY6rvQUJDbWRscckLr1/6tkSbZYOqxtgJM9s5ovw.jpg?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
    &lt;figcaption&gt;Bramus speaking at Frontend United.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Read some recent articles by Bramus on &lt;a href=&quot;https://www.bram.us/2021/09/15/the-future-of-css-cascade-layers-css-at-layer/&quot; rel=&quot;noopener&quot;&gt;Cascade Layers&lt;/a&gt;,
&lt;a href=&quot;https://css-tricks.com/scroll-linked-animations-with-the-web-animations-api-waapi-and-scrolltimeline/&quot; rel=&quot;noopener&quot;&gt;Scroll-Linked Animations&lt;/a&gt;,
and &lt;a href=&quot;https://www.bram.us/2021/09/21/css-container-queries-container-relative-lengths/&quot; rel=&quot;noopener&quot;&gt;Container Relative Lengths&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; What was your route into web development?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bramus:&lt;/strong&gt; As a kid, I always liked to tinker with things. I would spend days playing with my LEGO® bricks, building my own fantasy world and objects from scratch.&lt;/p&gt;
&lt;p&gt;When we got a computer at home—an unusual device to own in the 1990s—I soon traded in the physical toys with computer games. I wasn&#39;t an avid gamer though; I don&#39;t think I ever finished a game entirely. Instead of finishing the games, I found myself modding them.&lt;/p&gt;
&lt;p&gt;In 1997, while looking up information about those games and tools, I also discovered &lt;a href=&quot;https://www.bram.us/#view-source&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;view-source&lt;/code&gt;&lt;/a&gt;. Curious to know how things were built, I started collecting HTML-snippets of the sites that I visited. Combining those snippets with Frontpage Express (an application that came with Internet Explorer 4 and 5), I soon created my very first web pages with info about myself. Those pages never got published, they only existed on one of the floppy disks I carried around.&lt;/p&gt;
&lt;p&gt;From that time on I continued to become more interested in computers and the web. This interest led me to flunk a year in high school on purpose, so that I could switch major from economics to IT—I knew I wanted to pursue a career in IT. By 2002 I was in college, where I properly learned HTML and took my first steps into CSS and JavaScript. During those three years I realized that the web was my true passion, and in 2005, fresh out of college, I took on my first job as a professional web developer.&lt;/p&gt;
&lt;h2 id=&quot;on-being-a-front-and-backend-developer&quot;&gt;On being a front and backend developer &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/community-highlight-bramus/#on-being-a-front-and-backend-developer&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; I spotted on your site that you are both a front and backend developer, I followed a similar path being originally a Perl, then a PHP and MySQL developer. Do you feel more excited by one side or the other? Do you think the possibility of being a hybrid developer is vanishing given the complexity of learning just one part of the stack?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bramus:&lt;/strong&gt; Throughout my career I&#39;ve constantly been floating between backend and frontend. One year I would find myself elbow-deep into JavaScript and React (and even React Native), only to be creating Terraform scripts and Docker containers the year after. I like mixing the two, yet my passion always lay with the frontend, and CSS specifically.&lt;/p&gt;
&lt;p&gt;In the early days of tinkering with the web, one simply was the &amp;quot;webmaster&amp;quot; and did it all. As the scope of the work was pretty limited back then, it was quite easy to keep up. Having seen both frontend and backend explode over the past 20 years, it became harder and harder to maintain expertise across the field. That&#39;s why I decided to mainly focus on frontend again in 2020.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; Why did you start writing about CSS in particular?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bramus&lt;/strong&gt; The content on my blog has always been a reflection of the projects that I&#39;m working on. Therefore a mix of front and backend posts.&lt;/p&gt;
&lt;p&gt;Attending conferences such as &lt;a href=&quot;https://fronteers.nl/congres&quot; rel=&quot;noopener&quot;&gt;Fronteers Conference&lt;/a&gt; and &lt;a href=&quot;https://cssday.nl/&quot; rel=&quot;noopener&quot;&gt;CSS Day&lt;/a&gt; helped me to write in-depth frontend posts. For example, seeing &lt;a href=&quot;https://vimeo.com/69531455&quot; rel=&quot;noopener&quot;&gt;Tab Atkins-Bittner talk about CSS Custom Properties in 2013&lt;/a&gt;—years before they even were an official thing—or &lt;a href=&quot;https://rachelandrew.co.uk/archives/2015/07/17/css-grid-layout-at-css-day/&quot; rel=&quot;noopener&quot;&gt;you (Rachel Andrew) explaining Grid to us in 2015&lt;/a&gt; were events that directly led me to write about them. At the time, I was a lecturer in web and mobile development at a technical university, so I had a very good reason to pay attention, as later on I&#39;d be teaching my own students about those subjects.&lt;/p&gt;
&lt;p&gt;In 2019, I started to closely monitor the CSSWG and &lt;a href=&quot;https://github.com/w3c/csswg-drafts/issues&quot; rel=&quot;noopener&quot;&gt;participate in discussions&lt;/a&gt;. Browsers working on features behind feature flags meant that I was able to experiment with the things I read about, even before they shipped. This was then reflected through the contents of my blog.&lt;/p&gt;
&lt;h2 id=&quot;advice-for-new-writers&quot;&gt;Advice for new writers &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/community-highlight-bramus/#advice-for-new-writers&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; What would be your advice to someone who wants to start writing about tech?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bramus:&lt;/strong&gt; Don&#39;t hesitate and simply do it. Even when it&#39;s about a single line of CSS, or if it&#39;s 1 post per year, or if you &amp;quot;only&amp;quot; have 5 subscribers: do it. Scratch your own itch, and write the article you wanted to find yourself. Through writing on my blog I not only challenged myself to learn about technologies in finer detail, but also opened doors along the way—both personally and professionally.&lt;/p&gt;
&lt;p&gt;Don&#39;t overly rely on external services such as Medium or Twitter, but try and have your own place on the web. In the long run it&#39;ll pay off. You don&#39;t need any fancy CMS, build pipelines, or comments system, to get started. All you need is a text editor and some time to spare. HTML, combined with a simple stylesheet, can get you a long way.&lt;/p&gt;
&lt;h2 id=&quot;new-features-in-css&quot;&gt;New features in CSS &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/community-highlight-bramus/#new-features-in-css&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; You have written about lots of the new features that are being developed in the CSSWG and in browsers, what do you think is the most exciting for the future of the web? Which do you think will have the most immediate impact in your own professional work?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bramus:&lt;/strong&gt; Along with many developers I&#39;m pretty excited about CSS Container Queries. Other upcoming features—such as &lt;a href=&quot;https://www.bram.us/2021/09/15/the-future-of-css-cascade-layers-css-at-layer/&quot; rel=&quot;noopener&quot;&gt;Cascade Layers&lt;/a&gt; and &lt;a href=&quot;https://www.bram.us/2021/02/23/the-future-of-css-scroll-linked-animations-part-1/&quot; rel=&quot;noopener&quot;&gt;Scroll-linked Animations&lt;/a&gt;—also excite me, but Container Queries will definitely have the biggest impact. They will allow us to transition from responsive pages to responsive components.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Learn about container queries in this &lt;a href=&quot;https://www.youtube.com/watch?v=gCNMyYr7F6w&quot; rel=&quot;noopener&quot;&gt;Designing in the Browser&lt;/a&gt; episode.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; What feature or functionality would you love to see added to CSS?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bramus:&lt;/strong&gt; Scroll-linked Animations is one of the features that I would like to see move forward. Right now it&#39;s only an Editor&#39;s Draft. Being able to define hardware-accelerated scrolling without relying on JavaScript is something that totally fits into my mental model of progressive enhancement and the &lt;a href=&quot;https://en.wikipedia.org/wiki/Rule_of_least_power&quot; rel=&quot;noopener&quot;&gt;rule of least power&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;CSS Nesting is also my radar. It took more than two years since its first Editor&#39;s Draft, but I was very glad to see its First Public Working Draft get released last summer.&lt;/p&gt;
&lt;p&gt;Apart from these bigger features, I can definitely appreciate smaller tweaks and additions. Things like &lt;a href=&quot;https://web.dev/accent-color/&quot;&gt;accent-color&lt;/a&gt; definitely put a smile on my face, as they make my life as a developer easier.&lt;/p&gt;
&lt;h2 id=&quot;recommendations-for-inspiring-web-people-to-follow&quot;&gt;Recommendations for inspiring web people to follow &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/community-highlight-bramus/#recommendations-for-inspiring-web-people-to-follow&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; Who else is doing really interesting, fun, or creative work on the web right now?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bramus:&lt;/strong&gt; That&#39;s a very difficult question to answer, so many people are producing content that amazes and inspires me. For example, &lt;a href=&quot;https://twitter.com/argyleink&quot; rel=&quot;noopener&quot;&gt;Adam Argyle&lt;/a&gt; and his GUI challenges, the projects from &lt;a href=&quot;https://twitter.com/5t3ph&quot; rel=&quot;noopener&quot;&gt;Stephanie Eckles&lt;/a&gt;, blog posts by &lt;a href=&quot;https://twitter.com/michebarks&quot; rel=&quot;noopener&quot;&gt;Michelle Barker&lt;/a&gt;, videos from &lt;a href=&quot;https://twitter.com/KevinJPowell&quot; rel=&quot;noopener&quot;&gt;Kevin J. Powell&lt;/a&gt;, the work &lt;a href=&quot;https://twitter.com/TerribleMia&quot; rel=&quot;noopener&quot;&gt;Miriam Suzanne&lt;/a&gt; is doing in the CSS Working Group, podcasts from &lt;a href=&quot;https://twitter.com/Una&quot; rel=&quot;noopener&quot;&gt;Una Kravets&lt;/a&gt;, articles by &lt;a href=&quot;https://twitter.com/jaffathecake&quot; rel=&quot;noopener&quot;&gt;Jake Archibald&lt;/a&gt;, Jake and Surma&#39;s &lt;a href=&quot;https://http203.libsyn.com/&quot; rel=&quot;noopener&quot;&gt;HTTP 203&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/georgedoescode&quot; rel=&quot;noopener&quot;&gt;George Francis&lt;/a&gt;&#39; Houdini work, and &lt;a href=&quot;https://twitter.com/ChallengesCss&quot; rel=&quot;noopener&quot;&gt;Temani Afif&lt;/a&gt;&#39;s posts. These people and their projects, and the many others that I&#39;m forgetting right now, have my respect and admiration.&lt;/p&gt;
&lt;p&gt;I think the most influential person throughout my career was &lt;a href=&quot;https://adactio.com/&quot; rel=&quot;noopener&quot;&gt;Jeremy Keith&lt;/a&gt;. His teaching us about semantic HTML, progressive enhancement, and resilience were eye-opening moments to me. It&#39;s a message I gave to my own students, and still like to spread today. In times where JavaScript is eating the world and junior developers somehow seem to have skipped out on the fundamentals of the web, his posts and talks are more relevant than they ever were before.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Jeremy Keith has created our new &lt;a href=&quot;https://web.dev/learn/design/&quot;&gt;responsive design course&lt;/a&gt; here on web.dev.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;&lt;strong&gt;Rachel:&lt;/strong&gt; You can &lt;a href=&quot;https://twitter.com/bramus&quot; rel=&quot;noopener&quot;&gt;follow Bramus on Twitter&lt;/a&gt;, and on his blog at &lt;a href=&quot;https://www.bram.us/&quot; rel=&quot;noopener&quot;&gt;bram.us&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Rachel Andrew</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>SVGcode: a PWA to convert raster images to SVG vector graphics</title>
      <link href="https://web.dev/docs/svgcode/"/>
      <updated>2021-11-19T00:00:00Z</updated>
      <id>https://web.dev/docs/svgcode/</id>
      <content type="text/html" mode="escaped">&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;In a hurry? Go &lt;a href=&quot;https://svgco.de/&quot; rel=&quot;noopener&quot;&gt;straight to the SVGcode app&lt;/a&gt;
and read the article later.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;div class=&quot;youtube&quot;&gt;  &lt;lite-youtube videoid=&quot;kcvfyQh6J-0&quot;&gt;  &lt;/lite-youtube&gt;&lt;/div&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    (If you prefer watching over reading, this article is also available as a &lt;a href=&quot;https://youtu.be/kcvfyQh6J-0&quot;&gt;video&lt;/a&gt;.)
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;from-raster-to-vector&quot;&gt;From raster to vector &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#from-raster-to-vector&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Have you ever scaled an image and the result was pixelated and unsatisfactory? If
so, you have probably dealt with a raster image format such as WebP, PNG, or JPG.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/bIiC6vyZLqgGWPuFF9od.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Scaling up a raster image makes it look pixelated.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;In contrast, vector graphics are images that are defined by points in a coordinate system. These
points are connected by lines and curves to form polygons and other shapes. Vector graphics have an
advantage over raster graphics in that they may be scaled up or down to any resolution
without pixelation.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/yM32DfKFp8ooBAshjlUE.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Scaling up a vector image with no loss of quality.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;introducing-svgcode&quot;&gt;Introducing SVGcode &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#introducing-svgcode&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have built a PWA called &lt;a href=&quot;https://svgco.de/&quot; rel=&quot;noopener&quot;&gt;SVGcode&lt;/a&gt; that can help you convert raster images to
vectors. Credit where credit is due: I didn&#39;t invent this. With SVGcode, I just stand on the
shoulders of a command line tool called &lt;a href=&quot;http://potrace.sourceforge.net/&quot; rel=&quot;noopener&quot;&gt;Potrace&lt;/a&gt; by
&lt;a href=&quot;https://www.mathstat.dal.ca/~selinger/&quot; rel=&quot;noopener&quot;&gt;Peter Selinger&lt;/a&gt; that I have
&lt;a href=&quot;https://www.npmjs.com/package/esm-potrace-wasm&quot; rel=&quot;noopener&quot;&gt;converted to Web Assembly&lt;/a&gt;, so it can be used in a
Web app.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;SVGcode application screenshot.&quot; decoding=&quot;async&quot; height=&quot;483&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/xMosQFxacBsz116CcFwy.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    The &lt;a href=&quot;https://svgco.de/&quot;&gt;SVGcode&lt;/a&gt; app.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;using-svgcode&quot;&gt;Using SVGcode &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#using-svgcode&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;First, I want to show you how to use the app. I start with the teaser image for Chrome Dev Summit
that I downloaded from the ChromiumDev Twitter channel. This is a PNG raster image that I then
drag onto the SVGcode app. When I drop the file, the app traces the image color by color,
until a vectorized version of the input appears. I can now zoom into the image, and as you can see,
the edges stay sharp. But zooming in on the Chrome logo, you can see that the tracing wasn&#39;t
perfect, and especially the outlines of the logo look a bit speckled. I can improve the result by
de-speckling the tracing by suppressing speckles of up to, say, five pixels.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/WvmYtNTHAbINP3ec1h1w.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Converting a dropped image to SVG.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;posterization-in-svgcode&quot;&gt;Posterization in SVGcode &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#posterization-in-svgcode&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;An important step for vectorization, especially for photographic images, is posterizing the input
image to reduce the number of colors. SVGcode allows me to do this per color channel, and see the
resulting SVG as I make changes. When I&#39;m happy with the result, I can save the SVG to my hard disk
and use it wherever I like.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/BzcR6yPyuQ0TIgzwYbLy.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Posterizing an image to reduce the number of colors.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;apis-used-in-svgcode&quot;&gt;APIs used in SVGcode &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#apis-used-in-svgcode&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now that you have seen what the app is capable of, let me show you some of the APIs that help make
the magic happen.&lt;/p&gt;
&lt;h3 id=&quot;progressive-web-app&quot;&gt;Progressive Web App &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#progressive-web-app&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;SVGcode is an installable Progressive Web App and therefore fully offline enabled. The app is based
on the
&lt;a href=&quot;https://github.com/vitejs/vite/tree/main/packages/create-vite/template-vanilla&quot; rel=&quot;noopener&quot;&gt;Vanilla JS template&lt;/a&gt;
for &lt;a href=&quot;https://github.com/vitejs/vite&quot; rel=&quot;noopener&quot;&gt;Vite.js&lt;/a&gt; and uses the popular
&lt;a href=&quot;https://github.com/antfu/vite-plugin-pwa&quot; rel=&quot;noopener&quot;&gt;Vite plugin PWA&lt;/a&gt;, which creates a service worker that
uses &lt;a href=&quot;https://developers.google.com/web/tools/workbox&quot; rel=&quot;noopener&quot;&gt;Workbox.js&lt;/a&gt; under the hood. Workbox is a set
of libraries that can power a production-ready service worker for Progressive Web Apps, This pattern
may not necessarily work for all apps, but for SVGcode&#39;s use case it&#39;s great.&lt;/p&gt;
&lt;h4 id=&quot;window-controls-overlay&quot;&gt;Window Controls Overlay &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#window-controls-overlay&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;To maximize the available screen real estate, SVGcode uses
&lt;a href=&quot;https://web.dev/window-controls-overlay/&quot;&gt;Window Controls Overlay&lt;/a&gt; customization by moving its main menu up into
the titlebar area. You can see this get activated at the end of the install flow.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/aDk3LFxexL6g2NbH4RCA.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Installing SVGcode and activating the Window Controls Overlay customization.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;file-system-access-api&quot;&gt;File System Access API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#file-system-access-api&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To open input image files and save the resulting SVGs, I use the
&lt;a href=&quot;https://web.dev/file-system-access/&quot;&gt;File System Access API&lt;/a&gt;. This allows me to keep a reference to previously
opened files and to continue where I left off, even after an app reload. Whenever an image gets
saved, it is optimized via the &lt;a href=&quot;https://github.com/svg/svgo&quot; rel=&quot;noopener&quot;&gt;svgo&lt;/a&gt; library, which may take a moment,
depending on the complexity of the SVG. Showing the file save dialog requires a user gesture. It is
therefore important to obtain the file handle before the SVG optimization happens, so the user
gesture is not invalidated by the time the optimized SVG is ready.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; svg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; svgOutput&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerHTML&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; handle &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// To not consume the user gesture obtain the handle before preparing the&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// blob, which may take longer.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;supported&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    handle &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;showSaveFilePicker&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      types&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;description&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;SVG file&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; accept&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;image/svg+xml&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.svg&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;showToast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i18n&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;optimizingSVG&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  svg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;optimizeSVG&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;svg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;showToast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i18n&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;savedSVG&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; blob &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Blob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;svg&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;type&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;image/svg+xml&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fileSave&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blob&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;description&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;SVG file&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; err&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;showToast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h4 id=&quot;drag-an-drop&quot;&gt;Drag an drop &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#drag-an-drop&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;For opening an input image, I can either use the file open feature, or, as you have seen above, just
drag and drop an image file onto the app. The file open feature is pretty straightforward, more
interesting is the drag and drop case. What&#39;s particularly nice about this is that you can
get a file system handle from the data transfer item via the
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/DataTransferItem/getAsFileSystemHandle&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;getAsFileSystemHandle()&lt;/code&gt;&lt;/a&gt;
method. As mentioned before, I can persist this handle, so it&#39;s ready when the app gets reloaded.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;drop&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;preventDefault&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  dropContainer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;classList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;dropenter&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; item &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dataTransfer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;items&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;kind &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;file&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    inputImage&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token string&quot;&gt;&#39;load&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token constant&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;revokeObjectURL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blobURL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;once&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; handle &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAsFileSystemHandle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;kind &lt;span class=&quot;token operator&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;file&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; file &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; handle&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; blobURL &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createObjectURL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    inputImage&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;src &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; blobURL&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;FILE_HANDLE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;For more details, check out the article on the &lt;a href=&quot;https://web.dev/file-system-access/&quot;&gt;File System Access API&lt;/a&gt; and,
if you&#39;re interested, study the SVGcode source code in
&lt;a href=&quot;https://github.com/tomayac/SVGcode/blob/main/src/js/filesystem.js&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;src/js/filesystem.js&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;async-clipboard-api&quot;&gt;Async Clipboard API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#async-clipboard-api&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;SVGcode is also fully integrated with the operating system&#39;s clipboard via the Async Clipboard API.
You can paste images from the operating system&#39;s file explorer into the app either by clicking the
paste image button or by pressing command or control plus v on your keyboard.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/9wHL0Uc7eHFEFF99anaB.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Pasting an image from the file explorer into SVGcode.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The Async Clipboard API has recently gained the ability to deal with SVG images as well, so you can
also copy an SVG image and paste it into another application for further processing.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/KiGt5UHOvZZEvPhtwIny.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Copying an image from SVGcode into SVGOMG.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;copyButton&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;click&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; svg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; svgOutput&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;innerHTML&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;showToast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i18n&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;optimizingSVG&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;Infinity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  svg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;optimizeSVG&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;svg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; textBlob &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Blob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;svg&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;type&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;text/plain&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; svgBlob &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Blob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;svg&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;type&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;image/svg+xml&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  navigator&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;clipboard&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ClipboardItem&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;svgBlob&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; svgBlob&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;textBlob&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; textBlob&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;showToast&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i18n&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;copiedSVG&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;To learn more, read the &lt;a href=&quot;https://web.dev/async-clipboard/&quot;&gt;Async Clipboard&lt;/a&gt; article, or see the file
&lt;a href=&quot;https://github.com/tomayac/SVGcode/blob/main/src/js/clipboard.js&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;src/js/clipboard.js&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;file-handling&quot;&gt;File Handling &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#file-handling&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;One of my favorite features of SVGcode is how well it blends in with the operating system. As an
installed PWA, it can become a file handler, or even the default file handler, for image files. This
means that when I&#39;m in the Finder on my macOS machine, I can right-click an image and open it with
SVGcode. This feature is called File Handling and works based on the file_handlers property in the
Web App Manifest and the launch queue, which allows the app to consume the passed file.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video autoplay=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot; playsinline=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/8WbTDNrhLsU0El80frMBGE4eMCD3/DEQLkm1vrt226xsAoysI.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Opening a file from the desktop with installed SVGcode app.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;launchQueue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setConsumer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;launchParams&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;launchParams&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;files&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; handle &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; launchParams&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;files&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; file &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; handle&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;startsWith&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;image/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; blobURL &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createObjectURL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      inputImage&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token string&quot;&gt;&#39;load&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;          &lt;span class=&quot;token constant&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;revokeObjectURL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blobURL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;once&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      inputImage&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;src &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; blobURL&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;FILE_HANDLE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;For more information, see &lt;a href=&quot;https://web.dev/file-handling/&quot;&gt;Let installed web applications be file handlers&lt;/a&gt;, and view the source code in
&lt;a href=&quot;https://github.com/tomayac/SVGcode/blob/main/src/js/filehandling.js&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;src/js/filehandling.js&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Alright, this was a quick tour through some of the advanced app features in SVGcode. I hope this app
can become an essential tool for your image processing needs alongside other amazing apps like
&lt;a href=&quot;https://squoosh.app/&quot; rel=&quot;noopener&quot;&gt;Squoosh&lt;/a&gt; or &lt;a href=&quot;https://jakearchibald.github.io/svgomg/&quot; rel=&quot;noopener&quot;&gt;SVGOMG&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;SVGcode is available at &lt;a href=&quot;https://svgco.de/&quot; rel=&quot;noopener&quot;&gt;svgco.de&lt;/a&gt;. See what I did there? You can
&lt;a href=&quot;https://github.com/tomayac/SVGcode&quot; rel=&quot;noopener&quot;&gt;review its source code on GitHub&lt;/a&gt;. Note that since Potrace is
GPL-licensed, so is SVGcode. And with that, happy vectorizing! I hope SVGcode will be useful, and
some of its features can inspire your next app.&lt;/p&gt;
&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/svgcode/#acknowledgements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This article was reviewed by &lt;a href=&quot;https://github.com/jpmedley&quot; rel=&quot;noopener&quot;&gt;Joe Medley&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Thomas Steiner</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Improving Core Web Vitals on the Mail.ru home page resulted in an average 10% increase in conversion rates</title>
      <link href="https://web.dev/docs/mailru-cwv/"/>
      <updated>2021-11-15T00:00:00Z</updated>
      <id>https://web.dev/docs/mailru-cwv/</id>
      <content type="text/html" mode="escaped">&lt;h2 id=&quot;where-we-started&quot;&gt;Where we started &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/mailru-cwv/#where-we-started&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Mail.ru is one of the leading e-mail services on the Russian-speaking Internet and is &lt;a href=&quot;https://www.alexa.com/topsites/countries/RU&quot; rel=&quot;noopener&quot;&gt;in the top 5 sites in Russia in terms of traffic&lt;/a&gt;. Mail.ru is an important resource for many people. It receives several hundred million visits per month, and is a portal from where people can access email, news, social media, performance internet searches and more.&lt;/p&gt;
&lt;p&gt;Mail.ru wanted to provide its visitors with a high quality user experience, so work began to improve Core Web Vitals. Before discussing our optimization strategy, a few technical details of the Mail.ru home page should first be noted.&lt;/p&gt;
&lt;p&gt;Though the project had long been developed using our in-house templating engine &lt;a href=&quot;https://github.com/mailru/fest&quot; rel=&quot;noopener&quot;&gt;Fest&lt;/a&gt;, we began to migrate to &lt;a href=&quot;https://svelte.dev/&quot; rel=&quot;noopener&quot;&gt;Svelte 3&lt;/a&gt; in 2019.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;You can find out more about Fest and our reasons for changing the technology stack to Svelte in &lt;a href=&quot;https://youtu.be/H2l3pK42f38?t=2913&quot; rel=&quot;noopener&quot;&gt;our team&#39;s presentation&lt;/a&gt; at Svelte Russia Meetup #1.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;Svelte implements reactivity in a way that &lt;a href=&quot;https://svelte.dev/blog/virtual-dom-is-pure-overhead&quot; rel=&quot;noopener&quot;&gt;doesn&#39;t use Virtual DOM&lt;/a&gt;, which makes it less resource-intensive. &lt;a href=&quot;https://svelte.dev/blog/frameworks-without-the-framework&quot; rel=&quot;noopener&quot;&gt;Svelte&#39;s approach removes unused functions from production bundles&lt;/a&gt; because the code implementing them isn&#39;t generated by the compiler if the functions aren&#39;t used. Unused code is removed during compilation, resulting in smaller bundles. This may help reduce &lt;a href=&quot;https://web.dev/tbt/&quot;&gt;Total Blocking Time (TBT)&lt;/a&gt; during page startup.&lt;/p&gt;
&lt;h2 id=&quot;tracking-performance-metrics&quot;&gt;Tracking performance metrics &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/mailru-cwv/#tracking-performance-metrics&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Before optimizing Core Web Vitals, it&#39;s helpful to &lt;a href=&quot;https://web.dev/vitals-field-measurement-best-practices/&quot;&gt;evaluate performance in the field&lt;/a&gt;. Before Core Web Vitals, we tracked other metrics, such as &lt;a href=&quot;https://web.dev/fcp/&quot;&gt;First Contentful Paint (FCP)&lt;/a&gt;, in our internal performance dashboard.&lt;/p&gt;
&lt;p&gt;Our metrics collection script was modified to collect Core Web Vitals and transmit them to our performance dashboard for visualization. In line with Google&#39;s recommendations, our script uses &lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/PerformanceObserver&quot; rel=&quot;noopener&quot;&gt;PerformanceObserver API&lt;/a&gt; to obtain metrics, which is part of &lt;a href=&quot;https://github.com/mail-core&quot; rel=&quot;noopener&quot;&gt;the universal frontend &amp;quot;Platform&amp;quot;&lt;/a&gt; inside Mail.ru.&lt;/p&gt;
&lt;p&gt;The dashboard displayed the following metrics for users (mean values for the week of 15-21 March 2021):&lt;/p&gt;
&lt;div class=&quot;table-wrapper&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th colspan=&quot;2&quot; width=&quot;40%&quot;&gt;Metrics group name&lt;/th&gt;
        &lt;th colspan=&quot;3&quot; width=&quot;30%&quot;&gt;Core Web Vitals&lt;/th&gt;
        &lt;th colspan=&quot;3&quot; width=&quot;30%&quot;&gt;Other Web Vitals&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td colspan=&quot;2&quot;&gt;Metric name&lt;/td&gt;
        &lt;td&gt;LCP&lt;/td&gt;
        &lt;td&gt;FID&lt;/td&gt;
        &lt;td&gt;CLS&lt;/td&gt;
        &lt;td&gt;FCP&lt;/td&gt;
        &lt;td&gt;TBT&lt;/td&gt;
        &lt;td&gt;TTI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td rowspan=&quot;3&quot;&gt;Share of users in accordance with Core Web Vitals thresholds&lt;/td&gt;
        &lt;td&gt;good&lt;/td&gt;
        &lt;td&gt;52%&lt;/td&gt;
        &lt;td&gt;92%&lt;/td&gt;
        &lt;td&gt;33%&lt;/td&gt;
        &lt;td&gt;35%&lt;/td&gt;
        &lt;td&gt;42%&lt;/td&gt;
        &lt;td&gt;43%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;needs-improvement&lt;/td&gt;
        &lt;td&gt;19%&lt;/td&gt;
        &lt;td&gt;5%&lt;/td&gt;
        &lt;td&gt;23%&lt;/td&gt;
        &lt;td&gt;38%&lt;/td&gt;
        &lt;td&gt;16%&lt;/td&gt;
        &lt;td&gt;25%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;poor&lt;/td&gt;
        &lt;td&gt;29%&lt;/td&gt;
        &lt;td&gt;3%&lt;/td&gt;
        &lt;td&gt;44%&lt;/td&gt;
        &lt;td&gt;27%&lt;/td&gt;
        &lt;td&gt;42%&lt;/td&gt;
        &lt;td&gt;32%&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;caption&gt;Metrics for the week of 15-21 March 2021&lt;/caption&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Core Web Vitals before optimization show roughly 1/3 of users in the poor bucket.&quot; decoding=&quot;async&quot; height=&quot;479&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ZL7y3ZCpbMcqlOv9mLpV.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;Web Vitals values before the improvements.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;improving-core-web-vitals&quot;&gt;Improving Core Web Vitals &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/mailru-cwv/#improving-core-web-vitals&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;While plenty of guidance exists for improving Core Web Vitals, every project has unique challenges. For the Mail.ru home page, the following opportunities were identified:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Implementing placeholders for ad banners to reduce &lt;a href=&quot;https://web.dev/cls/&quot;&gt;CLS&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Using server-side rendering (SSR) to reduce &lt;a href=&quot;https://web.dev/lcp/&quot;&gt;Largest Contentful Paint (LCP)&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Code splitting to reduce LCP and &lt;a href=&quot;https://web.dev/fid/&quot;&gt;First Input Delay (FID)&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;skeletons-for-cls-improvement&quot;&gt;Skeletons for CLS improvement &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/mailru-cwv/#skeletons-for-cls-improvement&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;CLS was one of the worst performing field metrics for the Mail.ru home page. Subsequent profiling of this page in the &lt;a href=&quot;https://developer.chrome.com/docs/devtools/evaluate-performance/&quot; rel=&quot;noopener&quot;&gt;&lt;strong&gt;Performance&lt;/strong&gt; panel&lt;/a&gt; of Chrome&#39;s DevTools revealed that ads were the source of the problem. To improve layout stability, our team decided to use placeholders to reserve space for ads before they load.&lt;/p&gt;
&lt;p&gt;When implementing placeholders, the first step is to determine the dimensions of the content that will replace them. Luckily, the desktop version of Mail.ru home page has strictly documented sizes for ads. After talking with the design team, SVG-animated UI skeletons were used as placeholders as &lt;a href=&quot;https://uxdesign.cc/what-you-should-know-about-skeleton-screens-a820c45a571a&quot; rel=&quot;noopener&quot;&gt;they reduce the perceived load time of the content&lt;/a&gt;.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-bad-bg color-state-bad-text&quot;&gt;
&lt;p class=&quot;cluster color-state-bad-text&quot;&gt;
&lt;span class=&quot;aside__icon box-block &quot;&gt;&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;currentColor&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; role=&quot;img&quot; aria-label=&quot;Error sign&quot;&gt;
  &lt;path fill-rule=&quot;evenodd&quot; clip-rule=&quot;evenodd&quot; d=&quot;M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15v-2h2v2h-2zm0-10v6h2V7h-2z&quot;&gt;&lt;/path&gt;
&lt;/svg&gt;&lt;/span&gt;
&lt;strong&gt;Caution&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;SVG animations are not supported in Internet Explorer 11, consider using CSS if legacy browser support is essential to your application.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;the-return-of-ssr&quot;&gt;The return of SSR &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/mailru-cwv/#the-return-of-ssr&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To ease the transition from Fest to Svelte, we incrementally rewrote the existing project rather than start over. By March 2021, we had migrated most of the frontend to Svelte, and eventually brought SSR to our production application after triaging and fixing backend performance issues.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;SSR was not used for the entire application, as &lt;a href=&quot;https://malloc.fi/performance-cost-of-server-side-rendered-react-node-js&quot; rel=&quot;noopener&quot;&gt;it can be an expensive process&lt;/a&gt; that can delay &lt;a href=&quot;https://web.dev/ttfb/&quot;&gt;Time to First Byte (TTFB)&lt;/a&gt;, which &lt;a href=&quot;https://web.dev/optimize-lcp/#optimize-your-server&quot;&gt;may affect LCP&lt;/a&gt;. We decided to use SSR for crucial content that the user will see on initial render, and offload rendering of hidden content on the client. At the moment, Mail.ru is experimenting with &lt;a href=&quot;https://jasonformat.com/islands-architecture/&quot; rel=&quot;noopener&quot;&gt;Islands Architecture&lt;/a&gt; to see if further performance gains can be had.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;After implementing SSR, the team discovered the cause of CLS regression that initially went unnoticed: the news section was not inserted at the moment of rendering the first content on the page. There was a delay between the initial painting of the page markup provided by the server and the insertion of news section on the client. This behaviour resulted in an ad skeleton shift, which worsened CLS.&lt;/p&gt;
&lt;p&gt;Although Chrome&#39;s DevTools showed Layout Shift events, we couldn&#39;t find the reason for it at first. Though SSR itself wasn&#39;t the problem, it helped in discovering the solution later on. Fixing the code responsible for the painting delay improved layout stability of the news component.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Active JavaScript just shows an empty page in the news section, hidding the layout jumps.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;443&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/X5ZgXiNPGEqz6oOlvY5v.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;Finding the news painting problem with JavaScript disabled.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
  &lt;img alt=&quot;Disabling JavaScript revealed layout shifts, previously hidden from human eyes.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;448&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/aXnxfjZCk4oZN8s6ag5o.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;Fixing the news painting problem with JavaScript disabled.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Another effect SSR can have on CLS is the movement of components before and after hydration, which can lead to further layout shifts. We encountered this on the mobile version in particular and it required paying special attention to the hydrated component markup. A good solution to this problem was transferring as much display logic from JavaScript to CSS when possible.&lt;/p&gt;
&lt;h2 id=&quot;code-splitting-and-unused-polyfills&quot;&gt;Code splitting and unused polyfills &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/mailru-cwv/#code-splitting-and-unused-polyfills&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To improve the perceived page load speed, work was required to decrease LCP and FID values. One way to achieve this is through &lt;a href=&quot;https://web.dev/codelab-code-splitting/&quot;&gt;code splitting&lt;/a&gt;. In addition to the Mail.ru home page itself, our team is developing a widget for portal navigation. It is currently embedded in &lt;a href=&quot;https://vk.company/en/projects/&quot; rel=&quot;noopener&quot;&gt;many of our company&#39;s projects&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For historical reasons, the widget is inserted at the very beginning of the page as a synchronously loading script. The share of polyfills in this script grew over time. To limit the negative performance effects of loading these polyfills, we implemented code splitting for both modern and legacy browsers.&lt;/p&gt;
&lt;p&gt;We decided against the &lt;a href=&quot;https://philipwalton.com/articles/deploying-es2015-code-in-production-today/&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;module&lt;/code&gt;/&lt;code&gt;nomodule&lt;/code&gt; pattern&lt;/a&gt; for loading JavaScript bundles for modern or legacy browsers, as the &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; element&#39;s &lt;a href=&quot;https://developer.mozilla.org/docs/Web/JavaScript/Guide/Modules&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;type=&amp;quot;module&amp;quot;&lt;/code&gt; attribute&lt;/a&gt; didn&#39;t target browsers that were modern enough for our needs. To address this, Mail.ru uses an in-house tool for identifying modern browser versions on the backend, and can adapt to those browsers accordingly.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The &lt;a href=&quot;https://github.com/browserslist/browserslist-useragent&quot; rel=&quot;noopener&quot;&gt;Browserslist Useragent&lt;/a&gt; package is a publicly available alternative to custom tooling for comparing a project&#39;s &lt;code&gt;.browserslistrc&lt;/code&gt; to the User-Agent string in an application backend. However, our team strongly recommends considering using &lt;a href=&quot;https://github.com/WICG/ua-client-hints#differential-serving&quot; rel=&quot;noopener&quot;&gt;User-Agent Client Hints&lt;/a&gt; (for example, &lt;a href=&quot;https://web.dev/user-agent-client-hints/#user-agent-response-and-request-headers&quot;&gt;Sec-CH-UA header&lt;/a&gt;, as Mail.ru does in our in-house tool.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;Once browsers could be identified in the backend, we implemented code splitting for modern and legacy browsers. The result was a 43.3% reduction in size of the synchronously-loaded JavaScript widget for modern browsers. This practice has been applied to some other portal scripts as well.&lt;/p&gt;
&lt;p&gt;In addition to bundle size reduction and positive effects on Core Web Vitals, code splitting improves the developer experience as well. Only 3.5% of our users use legacy browsers and that share is on a downward trend, so implementing code-splitting allowed our developers to use the latest browser APIs without introducing the polyfill bloat necessary for legacy browsers to all users.&lt;/p&gt;
&lt;h2 id=&quot;results&quot;&gt;Results &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/mailru-cwv/#results&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;After the optimization effort, we observed the mean values for the week of 24-30 May 2021 in our field data:&lt;/p&gt;
&lt;div&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th colspan=&quot;2&quot; width=&quot;40%&quot;&gt;Metrics group name&lt;/th&gt;
        &lt;th colspan=&quot;3&quot; width=&quot;30%&quot;&gt;Core Web Vitals&lt;/th&gt;
        &lt;th colspan=&quot;3&quot; width=&quot;30%&quot;&gt;Other Web Vitals&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td colspan=&quot;2&quot;&gt;Metric name&lt;/td&gt;
        &lt;td&gt;LCP&lt;/td&gt;
        &lt;td&gt;FID&lt;/td&gt;
        &lt;td&gt;CLS&lt;/td&gt;
        &lt;td&gt;FCP&lt;/td&gt;
        &lt;td&gt;TBT&lt;/td&gt;
        &lt;td&gt;TTI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td rowspan=&quot;3&quot;&gt;Share of users in accordance with Core Web Vitals thresholds&lt;/td&gt;
        &lt;td&gt;good&lt;/td&gt;
        &lt;td&gt;58% (+6%)&lt;/td&gt;
        &lt;td&gt;93% (+1%)&lt;/td&gt;
        &lt;td&gt;93% (+60%)&lt;/td&gt;
        &lt;td&gt;43% (+8%)&lt;/td&gt;
        &lt;td&gt;49% (+7%)&lt;/td&gt;
        &lt;td&gt;51% (+8%)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;needs-improvement&lt;/td&gt;
        &lt;td&gt;18%&lt;/td&gt;
        &lt;td&gt;4%&lt;/td&gt;
        &lt;td&gt;3%&lt;/td&gt;
        &lt;td&gt;34%&lt;/td&gt;
        &lt;td&gt;17%&lt;/td&gt;
        &lt;td&gt;24%&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
        &lt;td&gt;poor&lt;/td&gt;
        &lt;td&gt;24%&lt;/td&gt;
        &lt;td&gt;3%&lt;/td&gt;
        &lt;td&gt;4%&lt;/td&gt;
        &lt;td&gt;23%&lt;/td&gt;
        &lt;td&gt;34%&lt;/td&gt;
        &lt;td&gt;25%&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;caption&gt;Metrics for the week of 24-30 March 2021&lt;/caption&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;figure&gt;
  &lt;img alt=&quot;All metrics in the good bucket improved by at least 1%. CLS even by 60%.&quot; decoding=&quot;async&quot; height=&quot;376&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7FIE2St8w6EEowUIqV9K.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;Comparison of Web Vitals before and after (change in &#39;good&#39; group is shown in brackets).&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The graphs below show changes in web page performance metrics values according to the &amp;quot;Platform&amp;quot;. Note the two important dates on the graphs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;23 March 2021: the release of iteration with the last page sections migrated to Svelte;&lt;/li&gt;
&lt;li&gt;19 April 2021: the release of iteration with returned SSR and layout modified to correct CLS regressions.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The decrease in values from May 1 to May 10 is due to May holidays in Russia.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;LCP from March to 1 June 2021 showing small improvments over time.&quot; decoding=&quot;async&quot; height=&quot;344&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/8wq9d0uj3EJp5vK6kI49.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;LCP graph in &#39;Platform&#39;: 16 March to 1 June 2021.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
  &lt;img alt=&quot;FID from 16 March to 1 June 2021 showing tiny improvements on a high level.&quot; decoding=&quot;async&quot; height=&quot;345&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/bxANzHIw78TvdS1RFyWG.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;FID graph in &#39;Platform&#39;: 16 March to 1 June 2021.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
  &lt;img alt=&quot;CLS from 16 March to 1 June 2021 showing huge improvements starting at April 23rd.&quot; decoding=&quot;async&quot; height=&quot;344&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/7woJXpiHLZU3l7PCdspi.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;CLS graph in &#39;Platform&#39;: 16 March to 1 June 2021.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Results obtained using the &amp;quot;Platform&amp;quot; are in line with the growth of metric values in &lt;a href=&quot;https://developers.google.com/web/tools/chrome-user-experience-report&quot; rel=&quot;noopener&quot;&gt;Chrome UX Report (CrUX)&lt;/a&gt;.&lt;/p&gt;
&lt;figure&gt;
  &lt;img alt=&quot;LCP metric from CrUX showing increase from 51% to 58% in the good bucket.&quot; decoding=&quot;async&quot; height=&quot;499&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/41Czys52EyEMyYv3fI2w.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;LCP metric change in CrUX in 2021.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
  &lt;img alt=&quot;FID metric from CrUX showing slight improvment in FID from 91% to 93% in good bucket.&quot; decoding=&quot;async&quot; height=&quot;498&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/c8LWvsC52Q58uvKOIZXc.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;FID metric change in CrUX in 2021.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
  &lt;img alt=&quot;CLS metric in CrUX showing hugh improvements from 46% to 98% in the good bucket.&quot; decoding=&quot;async&quot; height=&quot;492&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/dB6B4Sr8kaaT0KZujRBFC303oFR2/ilAn6vKt93uh4ioqGKj1.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption&gt;CLS metric change in CrUX in 2021.&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;A comparison of mean user session duration values a week before the roll-out of initial improvements and a week after the roll-out shows 2.7% growth. Moreover, there is an overall significant increase in conversion in most sections of the page. In particular, conversions to the Mail.ru email app increased by 11.6%, the conversion of the news section increased by 13.5%.&lt;/p&gt;
&lt;div class=&quot;stats&quot;&gt;
  &lt;div class=&quot;stats__item&quot;&gt;
    &lt;p class=&quot;stats__figure&quot;&gt;181&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p&gt;Boost of share of good CLS threshold&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;stats__item&quot;&gt;
    &lt;p class=&quot;stats__figure&quot;&gt;2.7&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p&gt;Higher mean session duration&lt;/p&gt;
  &lt;/div&gt;
  &lt;div class=&quot;stats__item&quot;&gt;
    &lt;p class=&quot;stats__figure&quot;&gt;13.5&lt;sub&gt;%&lt;/sub&gt;&lt;/p&gt;
    &lt;p&gt;Increase of news section conversion rate&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;The most unexpected result we got was a 17.4% increase in the Click-Through Rate (CTR) of the marketing banner (its rendering time was significantly reduced by the introduction of SSR and preload tags).&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;An unintended consequence of our work was that we saw a decrease in the conversion rate of some sections on the page. The search section in particular saw a decrease of 6.7%. Our team associates this with a change in the rendering of the page, as earlier on, this component was one of the first to render. We were able to reverse this decrease by introducing new product features into this section.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;After analyzing the rest of the sections on the page, we noticed significant performance improvement in the vast majority of them. Even for sections such as Weather and Coronavirus—which are not key on our page—we see an increase in conversion by 9.6% and 9.5%, respectively.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/mailru-cwv/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Improving performance is challenging in that the work involved may be prolonged. You should regularly monitor changes in metrics over time and ensure that all new product features don&#39;t cause regressions in Core Web Vitals. To achieve this, we monitor changes in Core Web Vitals in our &lt;a href=&quot;https://web.dev/performance-budgets-101/&quot;&gt;performance budget&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Most importantly, we stressed the importance of Core Web Vitals to all members of our product team, from managers and designers to testers and QA. Each team member should be aware of performance metrics and be empowered to improve them. We also incorporate performance optimization objectives into our business processes on a regular cadence. Successfully providing a high-quality user experience is only possible through a joint effort by all team members.&lt;/p&gt;
</content>
      <author>
          <name>Denis Stasyev</name>
        </author><author>
          <name>Sven May</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Building a 3D game menu component</title>
      <link href="https://web.dev/docs/building-a-3d-game-menu-component/"/>
      <updated>2021-11-10T00:00:00Z</updated>
      <id>https://web.dev/docs/building-a-3d-game-menu-component/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;In this post I want to share thinking on a way to build a 3D game menu component. Try the
&lt;a href=&quot;https://gui-challenges.web.app/game-menu/dist/&quot; rel=&quot;noopener&quot;&gt;demo&lt;/a&gt;.&lt;/p&gt;
&lt;figure class=&quot;w-figure w-figure--fullbleed&quot;&gt;
  &lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/q9gIXMmP2CcfutwyaK5F.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    &lt;a href=&quot;https://gui-challenges.web.app/game-menu/dist/&quot;&gt;Demo&lt;/a&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;If you prefer video, here&#39;s a YouTube version of this post:&lt;/p&gt;
&lt;div class=&quot;youtube&quot;&gt;  &lt;lite-youtube videoid=&quot;HCsV8u-KYUw&quot;&gt;  &lt;/lite-youtube&gt;&lt;/div&gt;
&lt;h2 id=&quot;overview&quot;&gt;Overview &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#overview&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Video games often present users with a creative and unusual menu, animated
and in 3D space. It&#39;s popular in new AR/VR games to make the menu appear to be
floating in space. Today we&#39;ll be recreating the essentials of this effect but
with the added flair of an adaptive color scheme and accommodations for users
who prefer reduced motion.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;This guide uses experimental CSS
&lt;a href=&quot;https://www.w3.org/TR/mediaqueries-5/#custom-mq&quot; rel=&quot;noopener&quot;&gt;@custom-media&lt;/a&gt; and
&lt;a href=&quot;https://www.w3.org/TR/css-nesting-1/&quot; rel=&quot;noopener&quot;&gt;@nest&lt;/a&gt; to prevent repeating media queries
and to colocate media queries within component style blocks. The syntax proposed
in those specs is enabled with PostCSS and these two plugins:
&lt;a href=&quot;https://github.com/postcss/postcss-custom-media&quot; rel=&quot;noopener&quot;&gt;postcss-custom-media&lt;/a&gt; and
&lt;a href=&quot;https://github.com/csstools/postcss-nesting&quot; rel=&quot;noopener&quot;&gt;postcss-nesting&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;html&quot;&gt;HTML &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#html&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A game menu is a list of buttons. The best way to represent this in HTML is as
follows:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;ul&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;threeD-button-set&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;New Game&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Continue&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Online&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Settings&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Quit&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;button&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;li&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;ul&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;A list of buttons will announce itself well to screen reader technologies and
works without JavaScript or CSS.&lt;/p&gt;
&lt;img alt=&quot;a very generic looking bullet list with regular buttons as items.&quot; decoding=&quot;async&quot; height=&quot;437&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/jYu9ioALV3d9jalDWSY1.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;css&quot;&gt;CSS &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#css&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Styling the button list breaks down into the following high level steps:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Setting up custom properties.&lt;/li&gt;
&lt;li&gt;A flexbox layout.&lt;/li&gt;
&lt;li&gt;A custom button with decorative pseudo-elements.&lt;/li&gt;
&lt;li&gt;Placing elements into 3D space.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;overview-of-custom-properties&quot;&gt;Overview of custom properties &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#overview-of-custom-properties&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Custom properties help disambiguate values by giving meaningful
names to otherwise random-looking values, avoiding repeated code and sharing
values amongst children.&lt;/p&gt;
&lt;p&gt;Below are media queries saved as CSS variables, also known as &lt;a href=&quot;https://www.w3.org/TR/mediaqueries-5/#custom-mq&quot; rel=&quot;noopener&quot;&gt;custom
media&lt;/a&gt;. These are global and
will be used throughout various selectors to keep code concise and legible. The
game menu component uses &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/@media/prefers-reduced-motion&quot; rel=&quot;noopener&quot;&gt;motion
preferences&lt;/a&gt;,
system &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/@media/prefers-color-scheme&quot; rel=&quot;noopener&quot;&gt;color
scheme&lt;/a&gt;,
and &lt;a href=&quot;https://www.w3.org/TR/mediaqueries-5/#dynamic-range&quot; rel=&quot;noopener&quot;&gt;color range
capabilities&lt;/a&gt; of the
display.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@custom-media&lt;/span&gt; --motionOK &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;prefers-reduced-motion&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; no-preference&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@custom-media&lt;/span&gt; --dark &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;prefers-color-scheme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@custom-media&lt;/span&gt; --HDcolor &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;dynamic-range&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; high&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The following custom properties manage the color scheme and hold mouse
positional values for making the game menu interactive to hover. Naming custom
properties helps code legibility as it reveals the use case for the value or a
friendly name for the result of the value.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The following variable naming convention uses strategies described in
&lt;a href=&quot;https://lea.verou.me/2021/10/custom-properties-with-defaults/&quot; rel=&quot;noopener&quot;&gt;this post&lt;/a&gt; by
&lt;a href=&quot;https://twitter.com/LeaVerou&quot; rel=&quot;noopener&quot;&gt;Lea Verou&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button-set&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--y&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--x&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--distance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--theme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;180 100% 50%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--theme-bg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;180 100% 50% / 25%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--theme-bg-hover&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;180 100% 50% / 40%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--theme-text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; white&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--theme-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;180 100% 10% / 25%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_max-rotateY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 10deg&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_max-rotateX&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 15deg&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_btn-bg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--theme-bg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_btn-bg-hover&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--theme-bg-hover&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_btn-text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--theme-text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_btn-text-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--theme-shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;--_bounce-ease&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;cubic-bezier&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;.5&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 1.75&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; .75&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 1.25&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--theme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;255 53% 50%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--theme-bg&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;255 53% 71% / 25%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--theme-bg-hover&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;255 53% 50% / 40%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--theme-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hsl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;255 53% 10% / 25%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--HDcolor&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@supports&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;display-p3 0 0 0&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;--theme&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;display-p3 .4 0 .9&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h3 id=&quot;light-and-dark-theme-background-conic-backgrounds&quot;&gt;Light and dark theme background conic backgrounds &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#light-and-dark-theme-background-conic-backgrounds&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The light theme has a vibrant &lt;code&gt;cyan&lt;/code&gt; to &lt;code&gt;deeppink&lt;/code&gt; &lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/gradient/conic-gradient()&quot; rel=&quot;noopener&quot;&gt;conic
gradient&lt;/a&gt;
while the dark theme has a dark subtle conic gradient. To see more about what
can be done with conic gradients, see &lt;a href=&quot;https://www.conic.style/&quot; rel=&quot;noopener&quot;&gt;conic.style&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;conic-gradient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;at -10% 50%&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; deeppink&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cyan&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;conic-gradient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;at -10% 50%&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; #212529&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 50%&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; #495057&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; #212529&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;figure class=&quot;w-figure w-figure--fullbleed&quot;&gt;
  &lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/7k1iwE7OaEKSpq4rDCBw.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figure&quot;&gt;
    Demonstration of background changing between light and dark color preferences.
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;enabling-3d-perspective&quot;&gt;Enabling 3D perspective &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#enabling-3d-perspective&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;For elements to exist in the 3D space of a web page, a viewport with
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/perspective&quot; rel=&quot;noopener&quot;&gt;perspective&lt;/a&gt;
needs to be initialized. I chose to put the perspective on the &lt;code&gt;body&lt;/code&gt; element
and used viewport units to create the style I liked.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;perspective&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 40vw&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This is the type of impact perspective can have.&lt;/p&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/qDDlbrxpp7vNBkwv5gI7.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h3 id=&quot;styling-the-lessulgreater-button-list&quot;&gt;Styling the &lt;code&gt;&amp;lt;ul&amp;gt;&lt;/code&gt; button list &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#styling-the-lessulgreater-button-list&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This element is responsible for the overall button list macro layout as well as
being an interactive and 3D floating card. Here&#39;s a way to achieve that.&lt;/p&gt;
&lt;h4 id=&quot;button-group-layout&quot;&gt;Button group layout &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#button-group-layout&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Flexbox can manage the container layout. Change the default direction of flex
from rows to columns with &lt;code&gt;flex-direction&lt;/code&gt; and ensure each item is the size of
its contents by changing from &lt;code&gt;stretch&lt;/code&gt; to &lt;code&gt;start&lt;/code&gt; for &lt;code&gt;align-items&lt;/code&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button-set&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* remove &amp;lt;ul&gt; margins */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;margin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* vertical rag-right layout */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;flex-direction&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;align-items&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; flex-start&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;gap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 2.5vh&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/Y63ZFy5AEA4VS4yVirgv.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;Next, establish the container as a 3D space context and set up CSS &lt;code&gt;clamp()&lt;/code&gt;
functions to ensure the card doesn&#39;t rotate beyond legible rotations. Notice
that the middle value for the clamp is a custom property, these &lt;code&gt;--x&lt;/code&gt; and &lt;code&gt;--y&lt;/code&gt;
values will be &lt;a href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#mouse-parallax-interaction&quot;&gt;set from JavaScript&lt;/a&gt; upon mouse
interaction later.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button-set&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  …&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* create 3D space context */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;transform-style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; preserve-3d&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* clamped menu rotation to not be too extreme */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;rotateY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;clamp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_max-rotateY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; * -1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_max-rotateY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token function&quot;&gt;rotateX&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token function&quot;&gt;clamp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_max-rotateX&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; * -1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_max-rotateX&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Next, if motion is OK with the visiting user, add a hint to the browser that
this item&#39;s transform will be constantly changing with
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/will-change&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;will-change&lt;/code&gt;&lt;/a&gt;.
Additionally, enable interpolation by setting a &lt;code&gt;transition&lt;/code&gt; on transforms. This
transition will occur when the mouse interacts with the card, enabling smooth
transitions to rotation changes. The animation is a constant running animation
that demonstrates the 3D space the card is within, even if a mouse can&#39;t or
isn&#39;t interacting with the component.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--motionOK&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;.threeD-button-set&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* browser hint so it can be prepared and optimized */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;will-change&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; transform&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* transition transform style changes and run an infinite animation */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; transform .1s ease&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;animation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; rotate-y 5s ease-in-out infinite&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The &lt;code&gt;rotate-y&lt;/code&gt; animation only sets the middle keyframe at &lt;code&gt;50%&lt;/code&gt; since the
browser will default &lt;code&gt;0%&lt;/code&gt; and &lt;code&gt;100%&lt;/code&gt; to the default style of the element. This
is shorthand for animations that alternate, needing to begin and end at the same
position. It&#39;s a great way to articulate infinite alternating animations.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@keyframes&lt;/span&gt; rotate-y&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;50%&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rotateY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;15deg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rotateX&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;-6deg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/EYqJVUyybb3VV4AX9dNE.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h3 id=&quot;styling-the-lessligreater-elements&quot;&gt;Styling the &lt;code&gt;&amp;lt;li&amp;gt;&lt;/code&gt; elements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#styling-the-lessligreater-elements&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Each list item (&lt;code&gt;&amp;lt;li&amp;gt;&lt;/code&gt;) contains the button and its border elements. The
&lt;code&gt;display&lt;/code&gt; style is changed so the item doesn&#39;t show a
&lt;a href=&quot;https://web.dev/css-marker-pseudo-element/&quot;&gt;&lt;code&gt;::marker&lt;/code&gt;&lt;/a&gt;. The &lt;code&gt;position&lt;/code&gt; style
is set to &lt;code&gt;relative&lt;/code&gt; so the upcoming button pseudo-elements can position
themselves within the full area the button consumes.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button-set &gt; li&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* change display type from list-item */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; inline-flex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* create context for button pseudos */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; relative&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* create 3D space context */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;transform-style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; preserve-3d&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;Screenshot of the list rotated in 3D space to show the perspective, and each list item no longer has a bullet.&quot; decoding=&quot;async&quot; height=&quot;691&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/6KtslsfnZEhk4liXAlW7.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;styling-the-lessbuttongreater-elements&quot;&gt;Styling the &lt;code&gt;&amp;lt;button&amp;gt;&lt;/code&gt; elements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#styling-the-lessbuttongreater-elements&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Styling buttons can be tough work, there&#39;s a lot of states and interaction types
to account for. These buttons get complex quickly due to balancing
pseudo-elements, animations and interactions.&lt;/p&gt;
&lt;h4 id=&quot;initial-lessbuttongreater-styles&quot;&gt;Initial &lt;code&gt;&amp;lt;button&amp;gt;&lt;/code&gt; styles &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#initial-lessbuttongreater-styles&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Below are the foundational styles that will support the other states.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button-set button&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* strip out default button styles */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;appearance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;outline&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* bring in brand styles via props */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_btn-bg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_btn-text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;text-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0 1px 1px &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_btn-text-shadow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* large text rounded corner and padded*/&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 5vmin&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;font-family&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Audiowide&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;padding-block&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .75ch&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;padding-inline&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 2ch&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 5px 20px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;img alt=&quot;Screenshot of the button list in 3D perspective, this time with styled buttons.&quot; decoding=&quot;async&quot; height=&quot;495&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/mfv2DarGZ9woqmV2avMH.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h4 id=&quot;button-pseudo-elements&quot;&gt;Button pseudo-elements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#button-pseudo-elements&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The borders of the button aren&#39;t traditional borders, they&#39;re absolute position
pseudo-elements with borders.&lt;/p&gt;
&lt;img alt=&quot;Screenshot of Chrome Devtools Elements panel with a button shown having ::before and ::after elements.&quot; decoding=&quot;async&quot; height=&quot;304&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/vS06HQ1YTsbMKSFTIPl2iogUQP73/iNeDRVIv7UK1hRxx8r2z.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;These elements are crucial in showcasing the 3D perspective that&#39;s been
established. One of these pseudo-elements will be pushed away from the button,
and one will be pulled closer to the user. The effect is most noticeable in the
top and bottom buttons.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button button&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;…&lt;br /&gt;&lt;br /&gt;  &amp;amp;::after,&lt;br /&gt;  &amp;amp;::before&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* create empty element */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;opacity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .8&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* cover the parent (button) */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; absolute&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;inset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* style the element for border accents */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1px solid &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--theme&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 5px 20px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* exceptions for one of the pseudo elements */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;/* this will be pushed back (3x) and have a thicker border */&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;&amp;amp;::before&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;border-width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 3px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* in dark mode, it glows! */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--dark&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;box-shadow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;br /&gt;        0 0 25px &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--theme&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        inset 0 0 25px &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--theme&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h4 id=&quot;3d-transform-styles&quot;&gt;3D transform styles &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#3d-transform-styles&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Below &lt;code&gt;transform-style&lt;/code&gt; is set to &lt;code&gt;preserve-3d&lt;/code&gt; so the children can space
themselves out on the &lt;code&gt;z&lt;/code&gt; axis. The &lt;code&gt;transform&lt;/code&gt; is set to the &lt;code&gt;--distance&lt;/code&gt;
custom property, which will be increased on &lt;a href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#hover-and-focus-interaction-styles&quot;&gt;hover and
focus&lt;/a&gt;.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button-set button&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  …&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;translateZ&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--distance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token property&quot;&gt;transform-style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; preserve-3d&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;&amp;amp;::after&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* pull forward in Z space with a 3x multiplier */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;translateZ&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--distance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 3&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;&amp;amp;::before&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* push back in Z space with a 3x multiplier */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;translateZ&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;calc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--distance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; / 3 * -1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/WQQvNTk8gy0dC7w54Q7w.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h4 id=&quot;conditional-animation-styles&quot;&gt;Conditional animation styles &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#conditional-animation-styles&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;If the user is OK with motion, the button hints to the browser that the
transform property should be ready for change and a transition is set for
&lt;code&gt;transform&lt;/code&gt; and &lt;code&gt;background-color&lt;/code&gt; properties. Notice the difference in
duration, I felt it made for a nice subtle staggered effect.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button-set button&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  …&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--motionOK&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;will-change&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; transform&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;transition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;br /&gt;      transform .2s ease&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      background-color .5s ease&lt;br /&gt;    &lt;span class=&quot;token selector&quot;&gt;;&lt;br /&gt;&lt;br /&gt;    &amp;amp;::before,&lt;br /&gt;    &amp;amp;::after&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;transition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; transform .1s ease-out&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token selector&quot;&gt;&amp;amp;::after&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;transition-duration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .5s &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token selector&quot;&gt;&amp;amp;::before&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;transition-duration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .3s &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h4 id=&quot;hover-and-focus-interaction-styles&quot;&gt;Hover and focus interaction styles &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#hover-and-focus-interaction-styles&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The goal of the interaction animation is to spread the layers that made up the
flat appearing button. Accomplish this by setting the &lt;code&gt;--distance&lt;/code&gt; variable,
initially to &lt;code&gt;1px&lt;/code&gt;. The selector shown in the following code example checks to
see if the button is being hovered or focused by a device that should see a
focus indicator, and not being activated. If so it applies CSS to do the
following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Apply the hover background color.&lt;/li&gt;
&lt;li&gt;Increase the distance .&lt;/li&gt;
&lt;li&gt;Add a bounce ease effect.&lt;/li&gt;
&lt;li&gt;Stagger the pseudo-element transitions.&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The varying &lt;code&gt;transition-duration&lt;/code&gt; values are only on hover,
staggering the animation only for hover. When hover or focus are removed, each
layer transitions in unison to the resting place.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;div&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.threeD-button-set button&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token selector&quot;&gt;…&lt;br /&gt;&lt;br /&gt;  &amp;amp;:is(:hover, :focus-visible):not(:active)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* subtle distance plus bg color change on hover/focus */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;--distance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 15px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_btn-bg-hover&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;/* if motion is OK, setup transitions and increase distance */&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token atrule&quot;&gt;&lt;span class=&quot;token rule&quot;&gt;@media&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--motionOK&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;--distance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 3vmax&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;transition-timing-function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;--_bounce-ease&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token property&quot;&gt;transition-duration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .4s&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token selector&quot;&gt;&amp;amp;::after&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;transition-duration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .5s &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token selector&quot;&gt;&amp;amp;::before&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;transition-duration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; .3s &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/ZR3M0MTBzBU3m0RoHpxp.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;The 3D perspective was still really neat for the &lt;code&gt;reduced&lt;/code&gt; motion preference.
The top and bottom elements show the effect in a nice subtle way.&lt;/p&gt;
&lt;h3 id=&quot;small-enhancements-with-javascript&quot;&gt;Small enhancements with JavaScript &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#small-enhancements-with-javascript&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The interface is usable from keyboards, screen readers, gamepads, touch and a
mouse already, but we can add some light touches of JavaScript to ease a couple
of scenarios.&lt;/p&gt;
&lt;h4 id=&quot;supporting-arrow-keys&quot;&gt;Supporting arrow keys &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#supporting-arrow-keys&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The tab key is a fine way to navigate the menu but I&#39;d expect the directional
pad or joysticks to move focus on a gamepad. The
&lt;a href=&quot;https://github.com/argyleink/roving-ux&quot; rel=&quot;noopener&quot;&gt;roving-ux&lt;/a&gt; library often used for GUI
Challenge interfaces will handle arrow keys for us. The below code tells the
library to trap focus within &lt;code&gt;.threeD-button-set&lt;/code&gt; and forward the focus to the
button children.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;rovingIndex&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;roving-ux&#39;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;rovingIndex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  element&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.threeD-button-set&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  target&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;button&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/PSF8lpd2tcmj35WIQlKT.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;h3 id=&quot;mouse-parallax-interaction&quot;&gt;Mouse parallax interaction &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#mouse-parallax-interaction&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Tracking the mouse and having it tilt the menu is intended to mimic AR and VR
video game interfaces, where instead of a mouse you may have a virtual pointer.
It can be fun when elements are hyper aware of the pointer.&lt;/p&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/mNtHI14zZMoX250VIIZF.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;Since this is a small extra feature, we&#39;ll put the interaction behind a query of
the user&#39;s motion preference. Also, as part of setup, store the button list
component into memory with &lt;code&gt;querySelector&lt;/code&gt; and cache the element&#39;s bounds into
&lt;code&gt;menuRect&lt;/code&gt;. Use these bounds to determine the rotate offset applied to the card
based on mouse position.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; menu &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;querySelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;.threeD-button-set&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; menuRect &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; menu&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getBoundingClientRect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; matches&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;motionOK &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;matchMedia&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token string&quot;&gt;&#39;(prefers-reduced-motion: no-preference)&#39;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Next, we need a function that accepts the mouse &lt;code&gt;x&lt;/code&gt; and &lt;code&gt;y&lt;/code&gt; positions and return
a value we can use to rotate the card. The following function uses the mouse
position to detemine which side of the box it&#39;s inside of and by how much. The
delta is returned from the function.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;getAngles&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;clientX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clientY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; menuRect&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; dx &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; clientX &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; dy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; clientY &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; height&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;dx&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;dy&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Lastly, watch the mouse move, pass the position to our &lt;code&gt;getAngles()&lt;/code&gt; function
and use the delta values as custom property styles. I divided by 20 to pad the
delta and make it less twitchy, there may be a better way to do that. If you
remember from the beginning, we put the &lt;code&gt;--x&lt;/code&gt; and &lt;code&gt;--y&lt;/code&gt; props in the middle of a
&lt;code&gt;clamp()&lt;/code&gt; function, this prevents the mouse position from overly rotating the
card into an illegible position.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;motionOK&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;mousemove&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clientX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clientY&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;dx&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;dy&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getAngles&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;clientX&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clientY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    menu&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;attributeStyleMap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;--x&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;dy &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;deg&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;    menu&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;attributeStyleMap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;--y&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;dx &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;deg&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;translations-and-directions&quot;&gt;Translations and directions &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#translations-and-directions&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There was one gotcha when testing out the game menu in other writing modes and
languages.&lt;/p&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/vS06HQ1YTsbMKSFTIPl2iogUQP73/BtBRYNIILR1iirytTZP3.mp4&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;button&amp;gt;&lt;/code&gt; elements have an &lt;code&gt;!important&lt;/code&gt; style for &lt;code&gt;writing-mode&lt;/code&gt; in the user
agent stylesheet. This meant the game menu HTML needed to change to accommodate
the desired design. Changing the button list to a list of links enables logical
properties to change the menu direction, as &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; elements don&#39;t have a browser
supplied &lt;code&gt;!important&lt;/code&gt; style.&lt;/p&gt;
&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#conclusion&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Now that you know how I did it, how would you‽ 🙂 Can you add accelerometer
interaction to the menu, so tiling your phone rotates the menu? Can we improve
the no motion experience?&lt;/p&gt;
&lt;p&gt;Let&#39;s diversify our approaches and learn all the ways to build on the web.
Create a demo, &lt;a href=&quot;https://twitter.com/argyleink&quot; rel=&quot;noopener&quot;&gt;tweet me&lt;/a&gt; links, and I&#39;ll add it
to the community remixes section below!&lt;/p&gt;
&lt;h2 id=&quot;community-remixes&quot;&gt;Community remixes &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/building-a-3d-game-menu-component/#community-remixes&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Nothing to see here yet!&lt;/em&gt;&lt;/p&gt;
</content>
      <author>
          <name>Adam Argyle</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>What&#39;s new in PageSpeed Insights</title>
      <link href="https://web.dev/docs/whats-new-pagespeed-insights/"/>
      <updated>2021-11-03T00:00:00Z</updated>
      <id>https://web.dev/docs/whats-new-pagespeed-insights/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;Over the years, &lt;a href=&quot;https://developers.google.com/speed/pagespeed/insights/&quot; rel=&quot;noopener&quot;&gt;PageSpeed
Insights&lt;/a&gt; (PSI) has
evolved into a one-stop source for both
&lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/speed-tools#field_data&quot; rel=&quot;noopener&quot;&gt;field&lt;/a&gt;
and
&lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/speed-tools#lab_data&quot; rel=&quot;noopener&quot;&gt;lab data&lt;/a&gt;.
It integrates information from the
&lt;a href=&quot;https://developers.google.com/web/tools/chrome-user-experience-report&quot; rel=&quot;noopener&quot;&gt;Chrome UX Report&lt;/a&gt;
(CrUX) and &lt;a href=&quot;https://developers.google.com/web/tools/lighthouse&quot; rel=&quot;noopener&quot;&gt;Lighthouse&lt;/a&gt;
diagnostics to provide insights that help improve the performance of your
website.&lt;/p&gt;
&lt;p&gt;Today, we are excited to announce an updated version of PSI! While it is a
critical element in our &lt;a href=&quot;https://web.dev/vitals-tools/&quot;&gt;speed tooling suite&lt;/a&gt;,
the PSI code base was ten years old, contained a lot of legacy code, and was due
for a redesign. We used this as an opportunity to address interface-related
issues in PSI which have sometimes made it difficult for users to navigate the
report. Our primary goals were to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Make the UI more intuitive by clearly differentiating between data
derived from a synthetic environment and data collected from users in the
field.&lt;/li&gt;
&lt;li&gt;Clearly communicate how the &lt;a href=&quot;https://web.dev/vitals/&quot;&gt;Core Web Vitals&lt;/a&gt; assessment is calculated in the UI.&lt;/li&gt;
&lt;li&gt;Modernize the look and feel of PSI, leveraging &lt;a href=&quot;https://material.io/design&quot; rel=&quot;noopener&quot;&gt;Material Design&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This post introduces the new features in PSI which will be released later this
year.&lt;/p&gt;
&lt;h2 id=&quot;what&#39;s-new&quot;&gt;What&#39;s new? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#what&#39;s-new&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The PSI UI redesign aims to improve the presentation of the report data and add
clarity and granularity to the data available in the report. The new UI is aimed
to be more intuitive and helps developers quickly discover lab and field
performance insights for their pages. The fundamental changes to the UI
include:&lt;/p&gt;
&lt;h3 id=&quot;clear-separation-of-field-and-lab-data&quot;&gt;Clear separation of field and lab data &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#clear-separation-of-field-and-lab-data&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We have changed the UI to distinctly separate field data from lab data. Labels
for &amp;quot;Field Data&amp;quot; and &amp;quot;Lab data&amp;quot; have been replaced with text that indicates what
the data means and how it can help. We have also brought the Field data section
to the top. The traditional lab-based performance score, which is currently
shown at the top, has been moved down to the Lab data section to avoid ambiguity
about the origin of the score.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;If you don&#39;t know the difference between lab and field data, check
out the &lt;a href=&quot;https://web.dev/how-to-measure-speed/&quot;&gt;explainer on web.dev&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;discover what your real users are experiencing&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;436&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jM0GYMrQZcPymVXdLOLP.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Section for field data
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;Diagnose performance issues&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;355&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/wQ9RGcJAcBBc4SUDK7Dz.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    Section for lab data
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;core-web-vitals-assessment&quot;&gt;Core Web Vitals assessment &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#core-web-vitals-assessment&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The Core Web Vitals assessment result, which earlier appeared as a single word
&amp;quot;passed&amp;quot; or &amp;quot;failed&amp;quot; in Field Data, now stands out as a separate subsection with
a distinct icon.&lt;/p&gt;
&lt;p&gt;Note that there is no change in the assessment process for Core Web Vitals. The
Core Web Vitals metrics FID, LCP, and CLS, may be aggregated at either the page
or origin level. For aggregations with sufficient data in all three metrics, the
aggregation passes the Core Web Vitals assessment if the 75th percentiles of all
three metrics are Good. Otherwise, the aggregation does not pass the assessment.
If the aggregation has insufficient FID data, it will pass the assessment if
both the 75th percentiles of LCP and CLS are Good. If either LCP or CLS has
insufficient data, the page or origin-level aggregation cannot be assessed.&lt;/p&gt;
&lt;h3 id=&quot;labels-for-mobile-and-desktop-performance&quot;&gt;Labels for mobile and desktop performance &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#labels-for-mobile-and-desktop-performance&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We changed the navigation menu at the top and included links for mobile and
desktop centrally on the report page. The links are now easily visible and
distinctly indicate the platform for which the data is being shown. Doing this
also helped make the navigation bar cleaner.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Older (at the time of writing) version of PageSpeed Insights&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;97&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/hEv5XuTeVV98Z3AS59bQ.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    PSI mobile and desktop labels before
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;Newer version of the navigation bar&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;149&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/vi5j7ouZtmWwqN9BRsUD.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
        PSI mobile and desktop labels after
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h3 id=&quot;origin-summary&quot;&gt;Origin Summary &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#origin-summary&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The Origin Summary, which provides the aggregated CrUX score for all pages from
the origin, currently appears on click of a checkbox. We have moved this report
section to a new tab, &amp;quot;Origin&amp;quot;, under the Field Data section.&lt;/p&gt;
&lt;img alt=&quot;Origin summary for the new PageSpeed Insights refresh.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;381&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/5Kn5meWq0sWwCLT69lMb.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;additional-helpful-information&quot;&gt;Additional helpful information &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#additional-helpful-information&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The report now includes a new information section at the bottom of each field
and lab card sharing the following details about the sampled data:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Data collection period&lt;/li&gt;
&lt;li&gt;Visit durations&lt;/li&gt;
&lt;li&gt;Devices&lt;/li&gt;
&lt;li&gt;Network connections&lt;/li&gt;
&lt;li&gt;Sample size&lt;/li&gt;
&lt;li&gt;Chrome versions&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This information should enhance the distinction between lab and field data and
help users who have previously been uncertain how the two data sources (lab and
field) might differ.&lt;/p&gt;
&lt;img alt=&quot;Enhanced section of information sharing data about field and lab sampling and configuration data&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;368&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/jVxqisC0x6I5viUGgjAD.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;expand-view&quot;&gt;Expand view &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#expand-view&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We have a new &amp;quot;Expand view&amp;quot; feature that adds a drill-down function to the field
data section and allows you to view granular details for the Core Web Vitals
metrics.&lt;/p&gt;
&lt;img alt=&quot;Newly expanded view with a drill-down for field data metrics.&quot; decoding=&quot;async&quot; height=&quot;515&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/UFVgoK1gJBYk5DLhFwIn.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;page-image&quot;&gt;Page image &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#page-image&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We have removed the image of the loaded page, which appears right next to the
field data. The image and thumbnails of the page displaying the loading sequence
will both be available in the lab data section.&lt;/p&gt;
&lt;img alt=&quot;Loaded page image next to the lab data.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;444&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/dnIsJA35tj7vs6qgybRM.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;For up to date product documentation, visit
&lt;a href=&quot;https://developers.google.com/speed/docs/insights/v5/about&quot; rel=&quot;noopener&quot;&gt;https://developers.google.com/speed/docs/insights/.&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;updates-to-web.devmeasure&quot;&gt;Updates to web.dev/measure &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#updates-to-web.devmeasure&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To reduce inconsistency between the different tools in our performance toolbox,
we are also updating &lt;a href=&quot;https://web.dev/measure&quot;&gt;web.dev/measure&lt;/a&gt; to be directly powered by the &lt;a href=&quot;https://developers.google.com/speed/docs/insights/v5/get-started&quot; rel=&quot;noopener&quot;&gt;PageSpeed Insights API&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Previously, developers would run reports via both the PSI tool and /measure
and see different Lighthouse numbers. One of the main reasons for differences
was because /measure originated all tests from the U.S. (due to it previously
having a cloud backend that was US-based).&lt;/p&gt;
&lt;p&gt;With /measure calling the same API directly as the PSI UI, developers will get
a more consistent experience when using PSI and /measure. We have also made
a few tweaks to /measure based on how users use the tool. This means that the
signed-in experience for /measure will be going away, but the most used
functionality—seeing multiple categories—will still be available for use.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;The old version of the measure page.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;377&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/KFZmLMU2iSxkPDph7FTV.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    web.dev/measure before
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;The refreshed version of the measure tool focusing on offering page quality measurement.&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;696&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/C04zQEkxtSQqPEQedNN7.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;
    web.dev/measure after
  &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;psi-today&quot;&gt;PSI today &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#psi-today&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Taking a step back, let&#39;s look at what the current PageSpeed Insights report
offers. The PSI report includes performance data for both mobile and desktop
devices in individual tabs and suggests how you may improve a page. The key
components of the report in each case are similar and consist of the
following:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Performance Score:&lt;/strong&gt; The performance score appears at the top of the PSI
report and summarizes the overall page performance. This score is determined by
running &lt;a href=&quot;https://developers.google.com/web/tools/lighthouse&quot; rel=&quot;noopener&quot;&gt;Lighthouse&lt;/a&gt; to
collect and analyze &lt;a href=&quot;https://developers.google.com/speed/docs/insights/v5/about#lab&quot; rel=&quot;noopener&quot;&gt;lab
data&lt;/a&gt; about the
page. A score of 90 or above is considered good, 50-90 needs improvement, and
below 50 is poor.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Field Data:&lt;/strong&gt; Field data, sourced from the
&lt;a href=&quot;https://developers.google.com/web/tools/chrome-user-experience-report&quot; rel=&quot;noopener&quot;&gt;CrUX report&lt;/a&gt;
dataset, provides insights into the real-world user experience. The data
includes metrics such as &lt;a href=&quot;https://web.dev/fcp/&quot;&gt;First Contentful Paint&lt;/a&gt; (FCP),
and measures Core Web Vitals  (&lt;a href=&quot;https://web.dev/fid/&quot;&gt;First Input Delay&lt;/a&gt; (FID),
&lt;a href=&quot;https://web.dev/lcp/&quot;&gt;Largest Contentful Paint&lt;/a&gt; (LCP), and &lt;a href=&quot;https://web.dev/cls/&quot;&gt;Cumulative Layout
Shift&lt;/a&gt; (CLS). Along with the metric values, you can also
see the distribution of pages where the value of a particular metric was Good,
Needs Improvement, or Poor, indicated by green, amber, and red bars,
respectively. The distribution and scores are shown based on page loads for
users in the CrUX dataset. Scores are calculated for the last 28 days and are
not available for new pages where sufficient real-user data may not be
available.&lt;/p&gt;
&lt;img alt=&quot;breakdown of different sections of data in the current PageSpeed Insight report&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;497&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/1L2RBhCLSnXjCnSlevaDjy3vba73/A7xrSBFuqf9puSgBJH4l.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;&lt;strong&gt;Origin Summary:&lt;/strong&gt; Users can click on the &lt;em&gt;Show Origin Summary&lt;/em&gt; checkbox to
view the aggregated score for the metrics for all pages served from the same
origin over the last 28 days.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Lab Data:&lt;/strong&gt; Lab performance score, calculated using Lighthouse, helps debug
performance issues, as it is collected in a controlled environment. The report
shows the performance using metrics like&lt;a href=&quot;https://web.dev/fcp/&quot;&gt;First Contentful
Paint&lt;/a&gt;, &lt;a href=&quot;https://web.dev/lcp/&quot;&gt;Largest Contentful Paint&lt;/a&gt;,
&lt;a href=&quot;https://web.dev/speed-index/&quot;&gt;Speed Index&lt;/a&gt;, &lt;a href=&quot;https://web.dev/cls/&quot;&gt;Cumulative Layout
Shift&lt;/a&gt;, &lt;a href=&quot;https://web.dev/interactive/&quot;&gt;Time to
Interactive&lt;/a&gt;, and &lt;a href=&quot;https://web.dev/tbt/&quot;&gt;Total Blocking
Time&lt;/a&gt;. Each metric is
&lt;a href=&quot;https://web.dev/performance-scoring/&quot;&gt;scored&lt;/a&gt; and labeled with an icon
indicating Good, Needs improvement, or Poor. This section provides a good
indication of performance bottlenecks pre-release and can help to diagnose
problems, but may not capture real-world issues.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Audits:&lt;/strong&gt; This section lists all the audits run by Lighthouse and lists down
the passed audits along with opportunities for improvement and additional
diagnostic information.&lt;/p&gt;
&lt;h3 id=&quot;challenges-with-the-current-psi-design&quot;&gt;Challenges with the current PSI design &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#challenges-with-the-current-psi-design&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;As seen in the screenshot above, the different data points from lab and field
data are not isolated clearly, and developers who are new to PSI may not easily
understand the context of the data and what to do next. This confusion has
resulted in many &amp;quot;How to&amp;quot; blog posts on deciphering the PSI report.&lt;/p&gt;
&lt;p&gt;With the redesign, we hope to make interpreting the report easier for developers
so that they move quickly from generating the PSI report to acting upon the
insights included in it.&lt;/p&gt;
&lt;h2 id=&quot;learn-more&quot;&gt;Learn more &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/whats-new-pagespeed-insights/#learn-more&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;For more details on performance tooling updates, watch the keynote for &lt;a href=&quot;https://developer.chrome.com/devsummit/schedule/keynote/&quot; rel=&quot;noopener&quot;&gt;Chrome
Dev Summit 2021&lt;/a&gt;.
We will keep you posted on the release date for PSI and the changes to web.dev/measure.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;With thanks to Milica Mihajlija, Philip Walton, Brendan Kenny and
Ewa Gasperowicz for their feedback on this article&lt;/em&gt;&lt;/p&gt;
</content>
      <author>
          <name>Leena Sohoni</name>
        </author><author>
          <name>Addy Osmani</name>
        </author><author>
          <name>Elizabeth Sweeny</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Towards an animation smoothness metric</title>
      <link href="https://web.dev/docs/smoothness/"/>
      <updated>2021-11-03T00:00:00Z</updated>
      <id>https://web.dev/docs/smoothness/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;You&#39;ve probably experienced pages that &amp;quot;stutter&amp;quot; or &amp;quot;freeze&amp;quot; during scrolling or
animations. We like to say that these experiences are not &lt;em&gt;smooth&lt;/em&gt;. To address
these types of issues, the Chrome team has been working on adding more support
to our lab tooling for animation detection, as well as making steady improvements
to the rendering pipeline diagnostics within Chromium.&lt;/p&gt;
&lt;p&gt;We&#39;d like to share some recent progress, offer concrete tooling guidance, and
discuss ideas for future animation smoothness metrics. As always, we would love
to hear your &lt;a href=&quot;https://web.dev/docs/smoothness/#feedback&quot;&gt;feedback&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This post will cover three main topics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A quick look at animations and animation frames.&lt;/li&gt;
&lt;li&gt;Our current thoughts on measuring overall animation smoothness.&lt;/li&gt;
&lt;li&gt;A few practical suggestions for you to leverage in lab tooling today.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;what-are-animations&quot;&gt;What are animations? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#what-are-animations&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Animations bring content to life! By making content move, especially in response
to user interactions, animations can make an experience feel more natural,
understandable, and fun.&lt;/p&gt;
&lt;p&gt;But poorly implemented animations, or just adding too many animations, can
degrade the experience and make it decidedly not fun at all. We&#39;ve probably all
interacted with an interface which just added too many &amp;quot;helpful&amp;quot; transition
effects, which actually become hostile to experience when they perform poorly.
Some users therefore actually might
&lt;a href=&quot;https://web.dev/prefers-reduced-motion/&quot;&gt;prefer reduced motion&lt;/a&gt;, a user preference
that you should honor.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Learn more about &lt;a href=&quot;https://web.dev/animations/&quot;&gt;animations&lt;/a&gt;, including how to
&lt;a href=&quot;https://web.dev/animations-guide/&quot;&gt;create performant animations&lt;/a&gt; and how to &lt;a href=&quot;https://developer.chrome.com/docs/devtools/css/animations/&quot; rel=&quot;noopener&quot;&gt;inspect
animations using developer
tooling&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h3 id=&quot;how-do-animations-work&quot;&gt;How do animations work? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#how-do-animations-work&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;As a quick recap, the &lt;a href=&quot;https://web.dev/animations-overview/#pipeline&quot;&gt;rendering pipeline&lt;/a&gt;
consists of a few, &lt;strong&gt;sequential&lt;/strong&gt; stages:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong style=&quot;font-weight:700;color:#6251A2&quot;&gt;Style:&lt;/strong&gt; Calculate the
styles that apply to the elements.&lt;/li&gt;
&lt;li&gt;&lt;strong style=&quot;font-weight:700;color:#6251A2&quot;&gt;Layout:&lt;/strong&gt; Generate the
geometry and position for each element.&lt;/li&gt;
&lt;li&gt;&lt;strong style=&quot;font-weight:700;color:#78A55A&quot;&gt;Paint:&lt;/strong&gt; Fill out the
pixels for each element into layers.&lt;/li&gt;
&lt;li&gt;&lt;strong style=&quot;font-weight:700;color:#78A55A&quot;&gt;Composite:&lt;/strong&gt; Draw the
layers to the screen.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;While there are many ways to define animations, they all fundamentally work via
one of the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Adjusting &lt;strong style=&quot;font-weight:700;color:#6251A2&quot;&gt;layout&lt;/strong&gt;
properties.&lt;/li&gt;
&lt;li&gt;Adjusting &lt;strong style=&quot;font-weight:700;color:#78A55A&quot;&gt;paint&lt;/strong&gt;
properties.&lt;/li&gt;
&lt;li&gt;Adjusting &lt;strong style=&quot;font-weight:700;color:#78A55A&quot;&gt;composite&lt;/strong&gt;
properties.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Because these stages are sequential, it is important to define animations in
terms of properties that are further down the pipeline. The earlier the update
happens in the process, the greater are the costs and it&#39;s less likely to be
smooth. (See &lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/rendering&quot; rel=&quot;noopener&quot;&gt;Rendering
performance&lt;/a&gt;
for more details.)&lt;/p&gt;
&lt;p&gt;While it can be convenient to animate layout properties, there are costs to
doing so, even if those costs aren&#39;t immediately apparent. Animations should be
defined in terms of composite property changes wherever possible.&lt;/p&gt;
&lt;p&gt;Defining &lt;a href=&quot;https://developers.google.com/web/fundamentals/design-and-ux/animations/css-vs-javascript&quot; rel=&quot;noopener&quot;&gt;declarative CSS animations or using Web
Animations&lt;/a&gt;,
and ensuring you &lt;a href=&quot;https://developer.chrome.com/blog/hardware-accelerated-animations/&quot; rel=&quot;noopener&quot;&gt;animate composite
properties&lt;/a&gt;,
is a great first step to ensuring smooth and efficient animations. But still,
this alone does not guarantee smoothness because even efficient web animations
have performance limits. That&#39;s why it is always important to measure!&lt;/p&gt;
&lt;h2 id=&quot;what-are-animation-frames&quot;&gt;What are animation frames? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#what-are-animation-frames&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Updates to the visual representation of a page take time to appear. A visual
change will lead to a new animation frame, which is eventually rendered on the
user&#39;s display.&lt;/p&gt;
&lt;p&gt;Displays update on some interval, so visual updates are batched. Many displays
update on a fixed interval of time, such as 60 times a second (that is
60 Hz). Some more modern displays can offer higher refresh rates
(90–120 Hz are becoming common). Often these displays can actively adapt
between refresh rates as needed, or even offer fully variable frame rates.&lt;/p&gt;
&lt;p&gt;The goal for any application, like a game or a browser, is to process all these
batched visual updates and produce a visually complete animation frame within
the deadline, every time. Note that this goal is entirely distinct from other
important browser tasks such as loading content from the network quickly or
executing JavaScript tasks efficiently.&lt;/p&gt;
&lt;p&gt;At some point, it can become too difficult to complete all visual updates within
the allotted deadline assigned by the display. When this happens, the browser
&lt;strong&gt;drops a frame&lt;/strong&gt;. Your screen doesn&#39;t go black, it just repeats itself. You see
the same visual update for a bit longer—the same animation frame that was
presented at the previous frame opportunity.&lt;/p&gt;
&lt;p&gt;This actually happens often! It is not necessarily even perceptible, especially
for static or document-like content, which is common on the web platform in
particular. Dropped frames only become apparent when there are important visual
updates, such as animations, for which we need a steady stream of animation
updates to show smooth motion.&lt;/p&gt;
&lt;h2 id=&quot;what-impacts-animation-frames&quot;&gt;What impacts animation frames? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#what-impacts-animation-frames&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Web developers can greatly impact the ability of a browser to quickly and
efficiently render and present visual updates!&lt;/p&gt;
&lt;p&gt;Some examples:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Using content that is too large or resource-intensive to decode quickly on the
target device.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/rendering/stick-to-compositor-only-properties-and-manage-layer-count&quot; rel=&quot;noopener&quot;&gt;Using too many
layers&lt;/a&gt;
requiring too much GPU memory.&lt;/li&gt;
&lt;li&gt;Defining overly complex CSS styles or web animations.&lt;/li&gt;
&lt;li&gt;Using design anti-patterns that disable fast rendering optimizations.&lt;/li&gt;
&lt;li&gt;Too much JS work on the main thread, leading to long tasks that block visual
updates.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;But how can you know when an animation frame has missed its deadline and caused
a dropped frame?&lt;/p&gt;
&lt;p&gt;One possible method is using
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;requestAnimationFrame()&lt;/code&gt;&lt;/a&gt;
polling, however it has several downsides. &lt;code&gt;requestAnimationFrame()&lt;/code&gt;, or &amp;quot;rAF&amp;quot;,
tells the browser that you wish to perform an animation and asks for an
opportunity to do so before the next paint stage of the rendering pipeline. If
your callback function isn&#39;t called at the time you expect it, that means a
paint wasn&#39;t executed, and one or more frames were skipped. By polling and
counting how often rAF is called, you can compute a sort of &amp;quot;frames per second&amp;quot;
(FPS) metric.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-warn-bg color-core-text&quot;&gt;
&lt;p class=&quot;cluster &quot;&gt;
&lt;span class=&quot;aside__icon box-block color-state-warn-text&quot;&gt;&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;currentColor&quot; role=&quot;img&quot; aria-label=&quot;Warning sign&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
  &lt;path fill-rule=&quot;evenodd&quot; clip-rule=&quot;evenodd&quot; d=&quot;M23 21L12 2 1 21h22zm-12-3v-2h2v2h-2zm0-4h2v-4h-2v4z&quot;&gt;&lt;/path&gt;
&lt;/svg&gt;&lt;/span&gt;
&lt;strong&gt;Warning&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The following code is an anti-pattern and is strongly discouraged!&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; frameTimes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;pollFramesPerSecond&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  frameTimes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;frameTimes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; t &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; now&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pollFramesPerSecond&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Frames per second:&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; frameTimes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;requestAnimationFrame&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pollFramesPerSecond&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Using &lt;code&gt;requestAnimationFrame()&lt;/code&gt; polling is not a good idea for several reasons:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Every script has to set up its own polling loop.&lt;/li&gt;
&lt;li&gt;It can block the critical path.&lt;/li&gt;
&lt;li&gt;Even if the rAF polling is fast, it can prevent
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/window/requestIdleCallback&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;requestIdleCallback()&lt;/code&gt;&lt;/a&gt;
from being able to schedule long idle blocks when used continuously (blocks that
exceed a single frame).&lt;/li&gt;
&lt;li&gt;Similarly, lack of long idle blocks prevents the browser from scheduling other
long-running tasks (such as longer garbage collection and other background or
speculative work).&lt;/li&gt;
&lt;li&gt;If polling is toggled on and off, then you&#39;ll miss cases where frame budget
has been exceeded.&lt;/li&gt;
&lt;li&gt;Polling will report false-positives in cases where the browser is using
variable update frequency (for example, due to power or visibility status).&lt;/li&gt;
&lt;li&gt;And most importantly, it doesn&#39;t actually capture all types of animation
updates!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Too much work on the main thread can impact the ability to see animation frames.
Check out the &lt;a href=&quot;https://googlechrome.github.io/devtools-samples/jank/&quot; rel=&quot;noopener&quot;&gt;Jank
Sample&lt;/a&gt; to see how a
rAF-driven animation, once there is too much work on the main thread (such as
layout), will lead to dropped frames and fewer rAF callbacks, and lower FPS.&lt;/p&gt;
&lt;p&gt;When the main thread becomes bogged down, visual updates begin to stutter.
That&#39;s jank!&lt;/p&gt;
&lt;p&gt;Many measurement tools have focused extensively on the ability for the main
thread to yield in a timely manner, and for animation frames to run smoothly.
But this is not the whole story! Consider the following example:&lt;/p&gt;
&lt;p&gt;&lt;video autoplay=&quot;&quot; class=&quot;w-screenshot&quot; controls=&quot;&quot; loop=&quot;&quot; muted=&quot;&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/nM10iAStORWg0YlDbPc2czmpRRr2/xkdE00Gizsks9ytPkP6r.mov&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;&lt;/p&gt;
&lt;p&gt;The video above shows a page that periodically injects long tasks onto the main
thread. These long tasks completely ruin the ability of the page to provide
certain types of visual updates, and you can see in the top-left corner a
corresponding drop of &lt;code&gt;requestAnimationFrame()&lt;/code&gt; reported FPS to 0.&lt;/p&gt;
&lt;p&gt;And yet, despite these long tasks, the page continues to scroll smoothly. This
is because on modern browsers, &lt;a href=&quot;https://blogs.windows.com/msedgedev/2017/03/08/scrolling-on-the-web/#:~:text=The%20multithreaded%20web&quot; rel=&quot;noopener&quot;&gt;scrolling is often
threaded&lt;/a&gt;,
driven entirely by the compositor.&lt;/p&gt;
&lt;p&gt;This is an example that simultaneously contains many dropped frames on the main
thread, yet still has many successfully-delivered frames of scrolling on the
compositor thread. Once the long task is complete, the main thread paint update
has no visual change to offer anyway. rAF polling suggested a frame drop to 0,
but &lt;em&gt;visually&lt;/em&gt;, a user wouldn&#39;t be able to notice a difference!&lt;/p&gt;
&lt;p&gt;For animation frames, the story is not that simple.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;There are many reasons why long tasks are bad—and these are captured
with &lt;a href=&quot;https://web.dev/custom-metrics/&quot;&gt;dedicated performance APIs&lt;/a&gt;, such as the Long Tasks
API or the Event Timing API. Yet, there are also features, such as
&lt;a href=&quot;https://web.dev/isinputpending/&quot;&gt;&lt;code&gt;isInputPending()&lt;/code&gt;&lt;/a&gt;, where long tasks during idle periods
may be added entirely by design and be a good thing.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;animation-frames:-updates-that-matter&quot;&gt;Animation frames: Updates that matter &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#animation-frames:-updates-that-matter&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The above example showcases that there is more to the story than just
&lt;code&gt;requestAnimationFrame()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;So when do animation updates and animation frames matter?  Here are
some criteria we&#39;re thinking about and would love to get feedback on:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Main and compositor thread updates&lt;/li&gt;
&lt;li&gt;Missing paint updates&lt;/li&gt;
&lt;li&gt;Detecting animations&lt;/li&gt;
&lt;li&gt;Quality versus quantity&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;main-and-compositor-thread-updates&quot;&gt;Main and compositor thread updates &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#main-and-compositor-thread-updates&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Animation frame updates are not boolean. It is not the case that frames may only
be fully dropped or fully presented. There are many reasons why an animation
frame may be &lt;em&gt;partially&lt;/em&gt; &lt;em&gt;presented&lt;/em&gt;. In other words, it can simultaneously have
&lt;em&gt;some stale content&lt;/em&gt; while also having &lt;em&gt;some new visual updates&lt;/em&gt; which are
presented.&lt;/p&gt;
&lt;p&gt;The most common example of this is when the browser is unable to produce a new
main thread update within frame deadline but does have a new compositor thread
update (such as the threaded scrolling example from earlier).&lt;/p&gt;
&lt;p&gt;One important reason why using declarative animations to animate composite
properties is recommended is that doing so enables an animation to be driven
entirely by the compositor thread even when the main thread is busy. These types
of animations can continue to produce visual updates efficiently and in
parallel.&lt;/p&gt;
&lt;p&gt;On the other hand, there may be cases where a main thread update finally becomes
available for presentation, but only after missing several frame deadlines. Here
the browser will have &lt;em&gt;some&lt;/em&gt; new update, but it may not be &lt;em&gt;the very latest&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Broadly speaking, we consider frames that contain some new visual updates,
without all new visual updates, as a &lt;em&gt;partial frame&lt;/em&gt;. Partial frames are fairly
common. Ideally, partial updates would at least include the most important
visual updates, like animations, but that can only happen if animations are
driven by the compositor thread.&lt;/p&gt;
&lt;h3 id=&quot;missing-paint-updates&quot;&gt;Missing paint updates &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#missing-paint-updates&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Another type of partial update is when media like images have not finished
decoding and rasterizing in time for frame presentation.&lt;/p&gt;
&lt;p&gt;Or, even if a page is perfectly static, browsers may still fall behind rendering
visual updates during rapid scrolling. That is because the pixel renditions of
content beyond the visible viewport may be discarded to save GPU memory. It
takes time to render pixels, and it may take longer than a single frame to
render everything after a large scroll, like a finger fling. This is commonly
known as &lt;em&gt;checkerboarding&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;With each frame rendering opportunity, it&#39;s possible to track how much of the
latest visual updates actually got to the screen. Measuring the ability to do so
over many frames (or time) is broadly known as &lt;em&gt;frame throughput&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;If the GPU is really bogged down, the browser (or platform) may even begin to
throttle the rate at which it attempts visual updates and thus decreases
effective frame rates. While technically that can reduce the number of dropped
frame updates, visually it will still appear as a lower frame throughput.&lt;/p&gt;
&lt;p&gt;Yet, not all types of low frame throughput are bad. If the page is mostly idle
and there are no active animations, a low frame rate is just as visually
appealing as a high frame rate (and, it can save battery!).&lt;/p&gt;
&lt;p&gt;So when does frame throughput matter?&lt;/p&gt;
&lt;h3 id=&quot;detecting-animations&quot;&gt;Detecting animations &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#detecting-animations&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;High frame throughput matters especially during periods with important
animations. Different animation types will depend on visual updates from a
specific thread (main, compositor, or a worker), so its visual update is
dependent on that thread providing its update within the deadline. We say that a
given thread &lt;em&gt;affects smoothness&lt;/em&gt; whenever there is an active animation that
depends on that thread update.&lt;/p&gt;
&lt;p&gt;Some types of animations are easier to define and detect than others.
Declarative animations, or user-input-driven animations, are clearer to define
than JavaScript-driven animations implemented as periodic updates to animatable
style properties.&lt;/p&gt;
&lt;p&gt;Even with &lt;code&gt;requestAnimationFrame()&lt;/code&gt; you
cannot always assume that every rAF call is necessarily producing a visual
update or animation. For example, using rAF polling just to track frame rate
(as shown above) should not itself affect smoothness measurements since there is
no visual update.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Animation detection in tooling, as well as the specifics of
animation implementations in browsers, continually evolves and improves.
Chrome recently moved &lt;a href=&quot;https://developer.chrome.com/blog/hardware-accelerated-animations/#whats-coming-next&quot; rel=&quot;noopener&quot;&gt;background-color
animations&lt;/a&gt;
from the main thread to the compositor!&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h3 id=&quot;quality-versus-quantity&quot;&gt;Quality versus quantity &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#quality-versus-quantity&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Finally, detecting animations and animation frame updates is still only part of
the story because it only captures the quantity of animation updates, not the
quality.&lt;/p&gt;
&lt;p&gt;For example, you may see a steady framerate of of 60 fps while watching a
video. Technically, this is perfectly smooth, but the video itself may have a
low bit rate, or issues with network buffering. This isn&#39;t captured by
animation smoothness metrics directly, yet may still be jarring to the
user.&lt;/p&gt;
&lt;p&gt;Or, a game which leverages &lt;code&gt;&amp;lt;canvas&amp;gt;&lt;/code&gt; (perhaps even using techniques like
&lt;a href=&quot;https://developers.google.com/web/updates/2018/08/offscreen-canvas&quot; rel=&quot;noopener&quot;&gt;offscreen
canvas&lt;/a&gt; to
ensure a steady frame rate) may technically be perfectly smooth in terms of
animation frames, all while failing to load high quality game assets into the
scene or exhibiting rendering artifacts.&lt;/p&gt;
&lt;p&gt;And of course, a site can just have some really lame animations 🙂&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/1/1c/Under-Construction-Bulldozer.gif&quot; alt=&quot;Old school under construction GIF&quot; width=&quot;410&quot; height=&quot;49&quot; /&gt;&lt;/p&gt;
&lt;p&gt;I mean, I guess they were pretty cool for their time!&lt;/p&gt;
&lt;h2 id=&quot;states-of-a-single-animation-frame&quot;&gt;States of a single animation frame &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#states-of-a-single-animation-frame&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Because frames may be partially presented, or dropped frames may happen in ways
that do not affect smoothness, we have begun to think of each frame as having a
completeness or smoothness score.&lt;/p&gt;
&lt;p&gt;Here is the spectrum of ways in which we interpret the state of a single
animation frame, ordered from best to worst case:&lt;/p&gt;
&lt;div&gt;
  &lt;table&gt;
    &lt;tr&gt;
      &lt;td style=&quot;width:12em&quot;&gt;&lt;strong style=&quot;background:#BCD5AC;padding:0.25em;&quot;&gt;
        No Update Desired&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;Idle time, repeat of the previous frame.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#BCD5AC;padding:0.25em;&quot;&gt;
        Fully presented&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;The main thread update was either committed within deadline, or no
      main thread update was desired.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#BCD5AC;padding:0.25em;&quot;&gt;
        Partially presented&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;Compositor only; the delayed main thread update had no visual
      change.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#DCE9D5;padding:0.25em;&quot;&gt;
        Partially presented&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;Compositor only; the main thread had a visual update, but that
      update did not include an animation that affects smoothness.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#E9ECC2;padding:0.25em;&quot;&gt;
        Partially presented&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;Compositor only; the main thread had a visual update that affects
      smoothness, but a previously stale frame arrived and was used instead.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#FDF2D0;padding:0.25em;&quot;&gt;
        Partially presented&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;Compositor only; without the desired main update, and the
      compositor update has an animation that affects smoothness.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#EECDCD;padding:0.25em;&quot;&gt;
        Partially presented&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;Compositor only but the compositor update does not have an
      animation that affects smoothness.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#EECDCD;padding:0.25em;&quot;&gt;
        Dropped frame&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;No update. There was no compositor update desired, and main was
      delayed.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#DE9D9B;padding:0.25em;&quot;&gt;
        Dropped frame&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;A compositor update was desired, but it was delayed.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong style=&quot;background:#DE9D9B;padding:0.25em;&quot;&gt;
        Stale frame&lt;/strong&gt;
      &lt;/td&gt;
      &lt;td&gt;An update was desired, it was produced by the renderer, but the
      GPU still did not present it before the vsync deadline.&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;It&#39;s possible to turn these states into somewhat of a score. And perhaps one way
to interpret this score is to consider it a &lt;em&gt;probability&lt;/em&gt; of being observable by
the user. A single dropped frame may not be very observable, but a sequence of
many dropped frames affecting smoothness in a row sure is!&lt;/p&gt;
&lt;h2 id=&quot;putting-it-all-together:-a-percent-dropped-frames-metric&quot;&gt;Putting it all together: A Percent Dropped Frames metric &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#putting-it-all-together:-a-percent-dropped-frames-metric&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;While it can sometimes be necessary to dive deep into the state of each
animation frame, it&#39;s also useful to just assign a quick &amp;quot;at a glance&amp;quot; score for
an experience.&lt;/p&gt;
&lt;p&gt;Because frames may be &lt;em&gt;partially presented,&lt;/em&gt; and because even fully skipped
frame updates may not actually &lt;em&gt;affect smoothness&lt;/em&gt;, we want to focus less on
just counting frames, and more on the &lt;em&gt;extent&lt;/em&gt; to which the browser is unable to
provide &lt;em&gt;visually complete&lt;/em&gt; updates &lt;em&gt;when it mattered&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The mental model should move from:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;Frames Per Second&lt;/em&gt;, to&lt;/li&gt;
&lt;li&gt;Detecting missing and important animation updates, to&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Percentage Dropped&lt;/em&gt; over a given time period.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;What matters is: &lt;em&gt;the proportion of time waiting for important
updates&lt;/em&gt;. We think this matches the natural way users experience the smoothness
of web content in practice. So far, we have been using the following as an
initial set of metrics:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Average Percent Dropped:&lt;/strong&gt; for all non-idle animation frames throughout the
whole timeline&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Worst Case of Percent Dropped Frames:&lt;/strong&gt; as measured over 1 second sliding
windows of time.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;95th percentile of Percent Dropped Frames:&lt;/strong&gt; as measured over 1 second
sliding windows of time.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can find these scores in some Chrome developer tools today. While these
metrics focus only on overall frame throughput, we are also evaluating other
factors, such as frame latency.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;These names are somewhat historical. The &amp;quot;Percent Dropped&amp;quot; naming no longer
matches any literal &amp;quot;was a frame dropped&amp;quot; concept. As the previous section
covered, each animation frame is a complicated arrangement of conditions
leading to an overall probability. Expect these names to evolve over time.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;try-it-yourself-in-developer-tooling!&quot;&gt;Try it yourself in developer tooling! &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#try-it-yourself-in-developer-tooling!&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;performance-hud&quot;&gt;Performance HUD &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#performance-hud&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Chromium has a neat Performance HUD hidden behind a flag
(&lt;code&gt;chrome://flags/#show-performance-metrics-hud&lt;/code&gt;). In it, you can find live
scores for things like Core Web Vitals and also a few experimental definitions
for animation smoothness based on &lt;em&gt;Percent Dropped Frames&lt;/em&gt; over time.&lt;/p&gt;
&lt;img alt=&quot;Performance HUD&quot; decoding=&quot;async&quot; height=&quot;441&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/hblBG5oYxWsUOua0tW3C.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;frame-rendering-stats&quot;&gt;Frame Rendering Stats &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#frame-rendering-stats&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.chrome.com/docs/devtools/evaluate-performance/reference/#fps-meter&quot; rel=&quot;noopener&quot;&gt;Enable &amp;quot;Frame Rendering
Stats&amp;quot;&lt;/a&gt;
in DevTools via Rendering settings to see a live view of new animation frames,
which are color-coded to differentiate partial updates from fully-dropped frame
updates. The reported fps is for fully-presented frames only.&lt;/p&gt;
&lt;img alt=&quot;Frame rendering stats&quot; decoding=&quot;async&quot; height=&quot;372&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 398px) 398px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/xazCKFNCWwjviBGS9JO6.png?auto=format&amp;w=796 796w&quot; width=&quot;398&quot; /&gt;
&lt;h3 id=&quot;frame-viewer-in-devtools-performance-profile-recordings&quot;&gt;Frame Viewer in DevTools performance profile recordings &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#frame-viewer-in-devtools-performance-profile-recordings&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;a href=&quot;https://developer.chrome.com/docs/devtools/evaluate-performance/&quot; rel=&quot;noopener&quot;&gt;DevTools Performance
panel&lt;/a&gt; has
long had a &lt;a href=&quot;https://developer.chrome.com/docs/devtools/evaluate-performance/reference/#frames&quot; rel=&quot;noopener&quot;&gt;Frames
viewer&lt;/a&gt;.
However, it had grown a bit out of sync with how the modern rendering pipeline
actually works. There has been plenty of recent improvement, even in the latest
Chrome Canary, which we think will greatly ease debugging animation issues.&lt;/p&gt;
&lt;p&gt;Today you will find that frames in the frames viewer are better aligned with
vsync boundaries, and color-coded based on status. There is still not full
visualization for all the nuances outlined above, but we&#39;re planning to add more
in the near future.&lt;/p&gt;
&lt;img alt=&quot;Frame viewer in Chrome DevTools&quot; decoding=&quot;async&quot; height=&quot;148&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/nM10iAStORWg0YlDbPc2czmpRRr2/ou89sgoFeg2481KVUWmF.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h3 id=&quot;chrome-tracing&quot;&gt;Chrome tracing &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#chrome-tracing&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Finally, with Chrome Tracing, the tool of choice for diving deep into details,
you can record a &amp;quot;Web content rendering&amp;quot; trace via the new &lt;a href=&quot;https://ui.perfetto.dev/&quot; rel=&quot;noopener&quot;&gt;Perfetto
UI&lt;/a&gt; (or &lt;code&gt;about:tracing&lt;/code&gt;), and dig deep into Chrome&#39;s
graphics pipeline. It can be a daunting task, but there are a few things
recently added to Chromium to make it easier. You can get an overview of what is
available in the &lt;a href=&quot;https://chromium.googlesource.com/chromium/src/+/HEAD/docs/life_of_a_frame.md&quot; rel=&quot;noopener&quot;&gt;Life of a
Frame&lt;/a&gt;
document.&lt;/p&gt;
&lt;p&gt;Through trace events you can definitively determine:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Which animations are running (using events named &lt;code&gt;TrackerValidation&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;Getting the exact timeline of animation frames (using events named
&lt;code&gt;PipelineReporter&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;For janky animation updates, figure out exactly what is blocking your
animation from running faster (using the event breakdowns within
&lt;code&gt;PipelineReporter&lt;/code&gt; events).&lt;/li&gt;
&lt;li&gt;For input-driven animations, see how long it takes to get a visual update
(using events named &lt;code&gt;EventLatency&lt;/code&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;img alt=&quot;Chrome Tracing pipeline reporter&quot; decoding=&quot;async&quot; height=&quot;138&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/eqprBhZUGfb8WYnumQ9ljAxRrA72/O0vDMhhaob9bllU0xRVy.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;what&#39;s-next&quot;&gt;What&#39;s next &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#what&#39;s-next&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://web.dev/vitals/&quot;&gt;Web Vitals&lt;/a&gt; initiative aims to provide metric and guidance for
building great user experiences on the web.
&lt;a href=&quot;https://web.dev/user-centric-performance-metrics/#in-the-lab&quot;&gt;Lab-based&lt;/a&gt; metrics like &lt;a href=&quot;https://web.dev/tbt/&quot;&gt;Total
Blocking Time (TBT)&lt;/a&gt; and &lt;a href=&quot;https://web.dev/tti/&quot;&gt;Time to Interactive (TTI)&lt;/a&gt; are vital for
catching and diagnosing potential interactivity issues. We are planning to
design a similar lab-based metric for animation smoothness.&lt;/p&gt;
&lt;p&gt;We&#39;ll keep you posted as we continue to work through ideas for designing a
comprehensive metric based on individual animation frame data.&lt;/p&gt;
&lt;p&gt;In the future, we&#39;d also like to design APIs that make it possible to measure
animation smoothness performantly for real users in the
&lt;a href=&quot;https://web.dev/user-centric-performance-metrics/#in-the-field&quot;&gt;field&lt;/a&gt; as well as in the lab.
Stay tuned for updates there as well!&lt;/p&gt;
&lt;h2 id=&quot;feedback&quot;&gt;Feedback &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/smoothness/#feedback&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We&#39;re excited about all the recent improvements and developer tools that have
shipped in Chrome to measure animation smoothness. Please try these tools out,
benchmark your animations, and let us know where it leads!&lt;/p&gt;
&lt;p&gt;You can send your comments to the
&lt;a href=&quot;https://groups.google.com/g/web-vitals-feedback&quot; rel=&quot;noopener&quot;&gt;web-vitals-feedback&lt;/a&gt; Google
group with &amp;quot;[Smoothness Metrics]&amp;quot; in the subject line. We&#39;re really looking
forward to hearing what you think!&lt;/p&gt;
</content>
      <author>
          <name>Michal Mocny</name>
        </author><author>
          <name>Behdad Bakhshinategh</name>
        </author><author>
          <name>Jonathan Ross</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Feedback wanted: An experimental responsiveness metric</title>
      <link href="https://web.dev/docs/responsiveness/"/>
      <updated>2021-11-03T00:00:00Z</updated>
      <id>https://web.dev/docs/responsiveness/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;Earlier this year, the Chrome Speed Metrics Team shared &lt;a href=&quot;https://web.dev/better-responsiveness-metric/&quot;&gt;some of the
ideas&lt;/a&gt; we were considering for a
new responsiveness metric. We want to design a metric that better captures the
end-to-end latency of individual events and offers a more holistic picture of
the overall responsiveness of a page throughout its lifetime.&lt;/p&gt;
&lt;p&gt;We&#39;ve made a lot of progress on this metric in the last few months, and we
wanted to share an update on how we plan to measure interaction latency as well
as introduce a few specific aggregation options we&#39;re considering to quantify
the overall responsiveness of a web page.&lt;/p&gt;
&lt;p&gt;We&#39;d love to get &lt;a href=&quot;https://web.dev/docs/responsiveness/#feedback&quot;&gt;feedback&lt;/a&gt; from developers and site owners as to
which of these options would be most representative of the overall input
responsiveness of their pages.&lt;/p&gt;
&lt;h2 id=&quot;measure-interaction-latency&quot;&gt;Measure interaction latency &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#measure-interaction-latency&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As a review, the &lt;a href=&quot;https://web.dev/fid/#fid-in-detail&quot;&gt;First Input Delay (FID) metric captures the
delay portion&lt;/a&gt; of input latency. That is, the time between
when the user interacts with the page to the time when the event handlers are
able to run.&lt;/p&gt;
&lt;p&gt;With this new metric we plan to expand that to capture the &lt;a href=&quot;https://web.dev/better-responsiveness-metric/#capture-the-full-event-duration&quot;&gt;full event
duration&lt;/a&gt;, from
initial user input until the next frame is painted after all the event handlers
have run.&lt;/p&gt;
&lt;p&gt;We also plan to measure
&lt;a href=&quot;https://web.dev/better-responsiveness-metric/#group-events-into-interactions&quot;&gt;interactions&lt;/a&gt;
rather than individual events. Interactions are groups of events that are
dispatched as part of the same, logical user gesture (for example:
&lt;code&gt;pointerdown&lt;/code&gt;, &lt;code&gt;click&lt;/code&gt;, &lt;code&gt;pointerup&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;To measure the total interaction latency from a group of individual event
durations, we are considering two potential approaches:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Maximum event duration:&lt;/strong&gt; the interaction latency is equal to the largest
single event duration from any event in the interaction group.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Total event duration:&lt;/strong&gt; the interaction latency is the sum of all event
durations, ignoring any overlap.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As an example, the diagram below shows a &lt;em&gt;key press&lt;/em&gt; interaction that consists
of a &lt;code&gt;keydown&lt;/code&gt; and a &lt;code&gt;keyup&lt;/code&gt; event. In this example there is a duration overlap
between these two events. To measure the latency of the key press interaction,
we could use &lt;code&gt;max(keydown duration, keyup duration)&lt;/code&gt; or &lt;code&gt;sum(keydown duration, keyup duration) - duration overlap&lt;/code&gt;:&lt;/p&gt;
&lt;img alt=&quot;A diagram showing interaction latency based on event durations&quot; decoding=&quot;async&quot; height=&quot;424&quot; loading=&quot;lazy&quot; src=&quot;https://web-dev.imgix.net/image/jL3OLOhcWUQDnR4XjewLBx4e3PC3/td8jMQBTjyR34ZO1QBvp.svg&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;There are pros and cons of each approach, and we&#39;d like to collect more data and
&lt;a href=&quot;https://web.dev/docs/responsiveness/#feedback&quot;&gt;feedback&lt;/a&gt; before finalizing a latency definition.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The event duration is meant to be the time from the event hardware timestamp
to the time when the next paint is performed after the event is handled. But
if the event doesn&#39;t cause any update, the duration will be the time from
event hardware timestamp to the time when we are sure it will not cause any
update.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;For keyboard interactions, we usually measure the &lt;code&gt;keydown&lt;/code&gt; and &lt;code&gt;keyup&lt;/code&gt;. But
for IME, such as input methods for Chinese and Japanese, we measure the
&lt;code&gt;input&lt;/code&gt; events between a &lt;code&gt;compositionstart&lt;/code&gt; and a &lt;code&gt;compositionend&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;aggregate-all-interactions-per-page&quot;&gt;Aggregate all interactions per page &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#aggregate-all-interactions-per-page&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Once we&#39;re able to measure the end-to-end latency of all interactions, the next
step is to define an aggregate score for a page visit, which may contain more
than one interaction.&lt;/p&gt;
&lt;p&gt;After exploring a number of options, we&#39;ve narrowed our choices down to the
strategies outlined in the following section, each of which we&#39;re currently
collecting real-user data on in Chrome. We plan to publish the results of our
findings once we&#39;ve had time to collect sufficient data, but we&#39;re also looking
for direct &lt;a href=&quot;https://web.dev/docs/responsiveness/#feedback&quot;&gt;feedback&lt;/a&gt; from site owners as to which strategy would
most accurately reflect the interaction patterns on their pages.&lt;/p&gt;
&lt;h3 id=&quot;aggregation-strategies-options&quot;&gt;Aggregation strategies options &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#aggregation-strategies-options&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To help explain each of the following strategies, consider an example page visit
that consists of four interactions:&lt;/p&gt;
&lt;div&gt;
  &lt;table&gt;
    &lt;tr&gt;
      &lt;th&gt;Interaction&lt;/th&gt;
      &lt;th&gt;Latency&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Click&lt;/td&gt;
      &lt;td&gt;120 ms&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Click&lt;/td&gt;
      &lt;td&gt;20 ms&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Key press&lt;/td&gt;
      &lt;td&gt;60 ms&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Key press&lt;/td&gt;
      &lt;td&gt;80 ms&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&quot;worst-interaction-latency&quot;&gt;Worst interaction latency &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#worst-interaction-latency&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The largest, individual interaction latency that occurred on a page. Given the
example interactions listed above, the worst interaction latency would be 120
ms.&lt;/p&gt;
&lt;h4 id=&quot;budgets-strategies&quot;&gt;Budgets strategies &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#budgets-strategies&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://www.tactuallabs.com/papers/howMuchFasterIsFastEnoughCHI15.pdf&quot; rel=&quot;noopener&quot;&gt;User experience
research&lt;/a&gt;
suggests that users may not perceive latencies below certain thresholds as
negative. Based on this research we&#39;re considering several budget strategies
using on the following thresholds for each event type:&lt;/p&gt;
&lt;div&gt;
  &lt;table&gt;
    &lt;tr&gt;
      &lt;th&gt;Interaction type&lt;/th&gt;
      &lt;th&gt;Budget threshold&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Click/tap&lt;/td&gt;
      &lt;td&gt;100 ms&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Drag&lt;/td&gt;
      &lt;td&gt;100 ms&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Keyboard&lt;/td&gt;
      &lt;td&gt;50 ms&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;p&gt;Each of these strategies will only consider the latency that is more than the
budget threshold per interaction. Using the example page visit above, the
over-budget amounts would be as follows:&lt;/p&gt;
&lt;div&gt;
  &lt;table&gt;
    &lt;tr&gt;
      &lt;th&gt;Interaction&lt;/th&gt;
      &lt;th&gt;Latency&lt;/th&gt;
      &lt;th&gt;Latency over budget&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Click
    &lt;/td&gt;
      &lt;td&gt;120 ms&lt;/td&gt;
      &lt;td&gt;20 ms&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Click
    &lt;/td&gt;
      &lt;td&gt;20 ms&lt;/td&gt;
      &lt;td&gt;0 ms&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Key press
    &lt;/td&gt;
      &lt;td&gt;60 ms&lt;/td&gt;
      &lt;td&gt;10 ms&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Key press
    &lt;/td&gt;
      &lt;td&gt;80 ms&lt;/td&gt;
      &lt;td&gt;30 ms&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/div&gt;
&lt;h4 id=&quot;worst-interaction-latency-over-budget&quot;&gt;Worst interaction latency over budget &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#worst-interaction-latency-over-budget&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The largest single interaction latency over budget. Using the above example, the
score would be &lt;code&gt;max(20, 0, 10, 30) = 30 ms&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&quot;total-interaction-latency-over-budget&quot;&gt;Total interaction latency over budget &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#total-interaction-latency-over-budget&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The sum of all interaction latencies over budget. Using the above example, the
score would be &lt;code&gt;(20 + 0 + 10 + 30) = 60 ms&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&quot;average-interaction-latency-over-budget&quot;&gt;Average interaction latency over budget &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#average-interaction-latency-over-budget&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The total over-budget interaction latency divided by the total number of
interactions. Using the above example, the score would be &lt;code&gt;(20 + 0 + 10 + 30) / 4 = 15 ms&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&quot;high-quantile-approximation&quot;&gt;High quantile approximation &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#high-quantile-approximation&quot;&gt;#&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;As an alternative to computing the largest interaction latency over budget, we
also considered using a high quantile approximation, which should be fairer to
web pages that have a lot of interactions and may be more likely to have large
outliers. We&#39;ve identified two potential high-quantile approximation strategies
we like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Option 1:&lt;/strong&gt; Keep track of the largest and second-largest interactions over
budget. After every 50 new interactions, drop the largest interaction from the
previous set of 50 and add the largest interaction from the current set of 50.
The final value will be largest remaining interaction over budget.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Option 2:&lt;/strong&gt; Compute the largest 10 interactions over budget and choose a
value from that list depending on the total number of interactions. Given N
total interactions, select the (N / 50 + 1)th largest value, or the 10th value
for pages with more than 500 interactions.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;measure-these-options-in-javascript&quot;&gt;Measure these options in JavaScript &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#measure-these-options-in-javascript&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The following code example can be used to determine the values of the first
three strategies presented above. Note that it&#39;s not yet possible to measure the
total number of interactions on a page in JavaScript, so this example doesn&#39;t
include the average interaction over budget strategy or the high
quantile approximation strategies.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; interactionMap &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; worstLatency &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; worstLatencyOverBudget &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; totalLatencyOverBudget &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PerformanceObserver&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;entries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; entry &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; entries&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getEntries&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;// Ignore entries without an interaction ID.&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;interactionId &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token comment&quot;&gt;// Get the interaction for this entry, or create one if it doesn&#39;t exist.&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; interaction &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; interactionMap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;interactionId&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;interaction&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        interaction &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;latency&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; entries&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        interactionMap&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;interactionId&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; interaction&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;      interaction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;entries&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; latency &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;duration&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; interaction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;latency&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      worstLatency &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;worstLatency&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; latency&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; budget &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; entry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;includes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;key&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; latencyOverBudget &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latency &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; budget&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      worstLatencyOverBudget &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;br /&gt;          Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latencyOverBudget&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; worstLatencyOverBudget&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latencyOverBudget&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; oldLatencyOverBudget &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Math&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;interaction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;latency &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; budget&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;        totalLatencyOverBudget &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; latencyOverBudget &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; oldLatencyOverBudget&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token comment&quot;&gt;// Set the latency on the interaction so future events can reference.&lt;/span&gt;&lt;br /&gt;      interaction&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;latency &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; latency&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;      &lt;span class=&quot;token comment&quot;&gt;// Log the updated metric values.&lt;/span&gt;&lt;br /&gt;      console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;        worstLatency&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        worstLatencyOverBudget&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;        totalLatencyOverBudget&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// Set the `durationThreshold` to 50 to capture keyboard interactions&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// that are over-budget (the default `durationThreshold` is 100).&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;observe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;type&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;event&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; buffered&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; durationThreshold&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;aside class=&quot;aside flow bg-state-bad-bg color-state-bad-text&quot;&gt;
&lt;p class=&quot;cluster color-state-bad-text&quot;&gt;
&lt;span class=&quot;aside__icon box-block &quot;&gt;&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;currentColor&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; role=&quot;img&quot; aria-label=&quot;Error sign&quot;&gt;
  &lt;path fill-rule=&quot;evenodd&quot; clip-rule=&quot;evenodd&quot; d=&quot;M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15v-2h2v2h-2zm0-10v6h2V7h-2z&quot;&gt;&lt;/path&gt;
&lt;/svg&gt;&lt;/span&gt;
&lt;strong&gt;Caution&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;There are currently &lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/list?q=label:proj-responsiveness-bugs&quot; rel=&quot;noopener&quot;&gt;a few
bugs&lt;/a&gt;
in Chrome that affect accuracy of the reported interaction timestamps. These
bugs have been fixed in version 98, so we recommend developers test these
strategies in Chrome Canary to get the most accurate results.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;feedback&quot;&gt;Feedback &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/responsiveness/#feedback&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We want to encourage developers to try out these new responsiveness metrics on
their sites, and let us know if you discover any issue.&lt;/p&gt;
&lt;p&gt;Please also email any general feedback on the approaches outlined here to the
&lt;a href=&quot;https://groups.google.com/g/web-vitals-feedback&quot; rel=&quot;noopener&quot;&gt;web-vitals-feedback&lt;/a&gt; Google
group with &amp;quot;[Responsiveness Metrics]&amp;quot; in the subject line. We&#39;re really looking
forward to hearing what you think!&lt;/p&gt;
</content>
      <author>
          <name>Hongbo Song</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Lighthouse user flows</title>
      <link href="https://web.dev/docs/lighthouse-user-flows/"/>
      <updated>2021-11-03T00:00:00Z</updated>
      <id>https://web.dev/docs/lighthouse-user-flows/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;Lighthouse is a fantastic tool for testing performance and best practices during initial page load. However, it&#39;s traditionally been difficult to use Lighthouse to analyze other aspects of the life of a page, such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Page loads with a warm cache&lt;/li&gt;
&lt;li&gt;Pages with an activated Service Worker&lt;/li&gt;
&lt;li&gt;Accounting for potential user interactions&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This means that Lighthouse can miss vital information. The &lt;a href=&quot;https://web.dev/vitals/#core-web-vitals&quot;&gt;Core Web Vitals&lt;/a&gt; are based on &lt;em&gt;all&lt;/em&gt; page loads, not just those with an empty cache. Additionally, metrics like &lt;a href=&quot;https://web.dev/cls/&quot;&gt;Cumulative Layout Shift (CLS)&lt;/a&gt; are measurable for the entire time a page is open.&lt;/p&gt;
&lt;p&gt;Lighthouse has a new user flow API that allows lab testing at any point within a page&#39;s lifespan. &lt;a href=&quot;https://github.com/puppeteer/puppeteer&quot; rel=&quot;noopener&quot;&gt;Puppeteer&lt;/a&gt; is used to script page loads and trigger synthetic user interactions, and Lighthouse can be invoked in multiple ways to capture key insights during those interactions. This means that performance can be measured during page load &lt;em&gt;and&lt;/em&gt; during interactions with the page. Accessibility checks can be run in CI, not just on the initial view but deep within your checkout flow to make sure nothing regresses.&lt;/p&gt;
&lt;p&gt;Almost any Puppeteer script written to ensure a working user flow can now have Lighthouse inserted at any point to measure performance and best practices throughout. This tutorial will walk through the new Lighthouse modes that can measure different parts of user flows: navigations, snapshots, and timespans.&lt;/p&gt;
&lt;h2 id=&quot;setup&quot;&gt;Setup &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/lighthouse-user-flows/#setup&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The user flow APIs are still in preview, but they are available in Lighthouse today. To try out the demos below, you&#39;ll need Node version 14 or later. Create an empty directory and in it run:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Default to ES modules.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;{&quot;type&quot;: &quot;module&quot;}&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; package.json&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;# Init npm project without the wizard.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; init -y&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;# Dependencies for these examples.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; lighthouse puppeteer &lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;aside class=&quot;aside flow bg-tertiary-box-bg color-tertiary-box-text&quot;&gt;
&lt;p class=&quot;cluster &quot;&gt;
&lt;span class=&quot;aside__icon box-block &quot;&gt;&lt;svg width=&quot;24&quot; height=&quot;24&quot; viewBox=&quot;0 0 24 24&quot; role=&quot;img&quot; aria-label=&quot;Lightbulb&quot; fill=&quot;currentColor&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
  &lt;path d=&quot;M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 017 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z&quot;&gt;&lt;/path&gt;
&lt;/svg&gt;&lt;/span&gt;
&lt;strong&gt;Gotchas&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Without the &lt;code&gt;{&amp;quot;type&amp;quot;: &amp;quot;module&amp;quot;}&lt;/code&gt; line, &lt;code&gt;npm init -y&lt;/code&gt; will default to CommonJS instead of modules. The following code can still be used, but you will have to switch to &lt;code&gt;require()&lt;/code&gt; instead of &lt;code&gt;import&lt;/code&gt; to bring in dependencies.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;navigations&quot;&gt;Navigations &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/lighthouse-user-flows/#navigations&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The new Lighthouse &amp;quot;navigation&amp;quot; mode is actually giving a name to the (up until now) standard Lighthouse behavior: analyze the cold load of a page. This is the mode to use to monitor page load performance, but user flows also open up the possibility of new insights.&lt;/p&gt;
&lt;p&gt;To script Lighthouse capturing a page load:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Use puppeteer to open the browser.&lt;/li&gt;
&lt;li&gt;Start a Lighthouse user flow.&lt;/li&gt;
&lt;li&gt;Navigate to the target URL.&lt;/li&gt;
&lt;/ol&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; fs &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;fs&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; open &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;open&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; puppeteer &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;puppeteer&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;startFlow&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;lighthouse/lighthouse-core/fraggle-rock/api.js&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;captureReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; puppeteer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;launch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;headless&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;newPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; flow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;startFlow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Single Navigation&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;navigate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;https://web.dev/performance-scoring/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; report &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;generateReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFileSync&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;flow.report.html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; report&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;flow.report.html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;wait&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;captureReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This is the simplest flow. When opened, the report shows a summary view with only the single step. Clicking on that step will reveal a traditional Lighthouse report for that navigation.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A Lighthouse flow report showing a single navigation&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;333&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/kb0RiS8uXSLoDq8nDlxa.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;&lt;a href=&quot;https://chalk-confused-roundworm.glitch.me/&quot;&gt;See the report live&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;As is typical with Lighthouse, this page is loaded with any cache or local storage cleared first, but real users visiting a site will have a mixture of visits with cold and warm caches, and there can be a large performance difference between a cold load like this and a user returning to the page with a still-warm cache.&lt;/p&gt;
&lt;h3 id=&quot;capturing-a-warm-load&quot;&gt;Capturing a warm load &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/lighthouse-user-flows/#capturing-a-warm-load&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;You can also add a second navigation to this script, this time disabling the clearing of cache and storage that Lighthouse does by default in navigations. This next example loads an article on web.dev itself to see how much it benefits from caching:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;captureReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; puppeteer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;launch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;headless&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;newPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; testUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;https://web.dev/performance-scoring/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; flow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;startFlow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Cold and warm navigations&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;navigate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;testUrl&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    stepName&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Cold navigation&#39;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;navigate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;testUrl&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    stepName&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Warm navigation&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    configContext&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;      settingsOverrides&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;disableStorageReset&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; report &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;generateReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFileSync&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;flow.report.html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; report&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;flow.report.html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;wait&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;captureReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The resulting flow report looks something like this:&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A Lighthouse flow report showing two navigations, one cold and one warm, which has a higher performance score&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;400&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4i28YDRuSaCxxJxtzigX.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;&lt;a href=&quot;https://energetic-pattern-polish.glitch.me/&quot;&gt;See the report live&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The combination of cold and warm loads offers a fuller picture of what real users are experiencing. If you have a site where users load many pages in the same visit, this may be able to give you a more realistic look at what they&#39;re experiencing in the field.&lt;/p&gt;
&lt;h2 id=&quot;snapshots&quot;&gt;Snapshots &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/lighthouse-user-flows/#snapshots&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Snapshots are a new mode that runs Lighthouse audits at a single point in time. Unlike a normal Lighthouse run, the page is not reloaded. This unlocks the ability to set up a page and test it in its exact state: with a drop-down open or a form partially filled in, for example.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;Not all Lighthouse audits can be run in this mode. Many of the performance metrics are currently defined as beginning with a page load and so are not applicable in a snapshot, but the accessibility audits and many of the performance best practices can still yield important checks.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;For this example, suppose you want to check that some new UI for Advanced Settings within &lt;a href=&quot;https://squoosh.app/&quot; rel=&quot;noopener&quot;&gt;Squoosh&lt;/a&gt; passes the automated Lighthouse checks. These settings are only visible if an image has been loaded and the options menu is expanded to show the advanced settings.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;The Squoosh advanced settings menu&quot; decoding=&quot;async&quot; height=&quot;515&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 399px) 399px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/2AJz5ievB1sBVcnivsqT.png?auto=format&amp;w=798 798w&quot; width=&quot;399&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;The Squoosh advanced settings menu&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;This process is scriptable with Puppeteer and you can actually take a Lighthouse snapshot at each step:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;captureReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; puppeteer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;launch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;headless&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;newPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; flow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;startFlow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Squoosh snapshots&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;goto&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;https://squoosh.app/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;waitUntil&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;networkidle0&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Wait for first demo-image button, then open it.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; demoImageSelector &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;ul[class*=&quot;demos&quot;] button&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;waitForSelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;demoImageSelector&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;snapshot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;stepName&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Page loaded&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;click&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;demoImageSelector&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Wait for advanced settings button in UI, then open them.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; advancedSettingsSelector &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;form label[class*=&quot;option-reveal&quot;]&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;waitForSelector&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;advancedSettingsSelector&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;snapshot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;stepName&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Demo loaded&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;click&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;advancedSettingsSelector&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;snapshot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;stepName&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Advanced settings opened&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; report &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;generateReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFileSync&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;flow.report.html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; report&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;flow.report.html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;wait&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;captureReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The resulting report shows that results are generally good, but there may be some accessibility criteria that need to be checked out manually:&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A Lighthouse flow report showing a set of snapshots taken&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;433&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/4OnCFHNkZtIpNsLSw0e3.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;&lt;a href=&quot;https://ivy-cloudy-blackcurrant.glitch.me/&quot;&gt;See the report live&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;h2 id=&quot;timespans&quot;&gt;Timespans &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/lighthouse-user-flows/#timespans&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One of the biggest differences between performance results &lt;a href=&quot;https://web.dev/user-centric-performance-metrics/#in-the-field&quot;&gt;in the field&lt;/a&gt; (like from CrUX) and &lt;a href=&quot;https://web.dev/user-centric-performance-metrics/#in-the-lab&quot;&gt;in the lab&lt;/a&gt; (like from Lighthouse) is the lack of user input. This is where a timespan—the last user flow mode—can help.&lt;/p&gt;
&lt;p&gt;A timespan runs Lighthouse audits over some period of time, which may or may not include a navigation. This is a great way to capture what&#39;s going on with a page during interactions.  For instance, by default Lighthouse measures CLS during page load, but in the field, CLS is measured from initial navigation until the page is closed. If user interactions are the trigger of CLS, this is something Lighthouse previously wouldn&#39;t be able to catch and help fix.&lt;/p&gt;
&lt;p&gt;To demonstrate this, here is a &lt;a href=&quot;https://pie-charmed-treatment.glitch.me/&quot; rel=&quot;noopener&quot;&gt;test site&lt;/a&gt; that simulates ads being injected into an article during scroll without space having been reserved for them. In a long series of cards, an occasional red square is added when its slot enters the viewport. Since space was not reserved for these red squares, the cards below them are shifted out of the way, causing layout shifts.&lt;/p&gt;
&lt;p&gt;A regular Lighthouse navigation will have a CLS of 0. However, once scrolled, the page will have problematic layout shifts and the CLS value will rise.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;video class=&quot;w-screenshot&quot; controls=&quot;&quot; height=&quot;640&quot; muted=&quot;&quot; width=&quot;360&quot;&gt;      &lt;source src=&quot;https://storage.googleapis.com/web-dev-uploads/video/MtjnObpuceYe3ijODN3a79WrxLU2/Qi6B5SNt6Xk7rZ3055DO.mov&quot; type=&quot;video/mp4&quot; /&gt;    &lt;/video&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;&lt;a href=&quot;https://pie-charmed-treatment.glitch.me/&quot;&gt;Try the demo site&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;The following script will produce a user flow report with both actions, to show the difference.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;captureReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; browser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; puppeteer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;launch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;headless&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; page &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;newPage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Get a session handle to be able to send protocol commands to the page.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createCDPSession&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; testUrl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;https://pie-charmed-treatment.glitch.me/&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; flow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;startFlow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;CLS during navigation and on scroll&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Regular Lighthouse navigation.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;navigate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;testUrl&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;stepName&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Navigate only&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// Navigate and scroll timespan.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;startTimespan&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;stepName&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Navigate and scroll&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; page&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;goto&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;testUrl&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;waitUntil&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;networkidle0&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// We need the ability to scroll like a user. There&#39;s not a direct puppeteer function for this, but we can use the DevTools Protocol and issue a Input.synthesizeScrollGesture event, which has convenient parameters like repetitions and delay to somewhat simulate a more natural scrolling gesture.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// https://chromedevtools.github.io/devtools-protocol/tot/Input/#method-synthesizeScrollGesture&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Input.synthesizeScrollGesture&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    x&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    y&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    yDistance&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2500&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    speed&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    repeatCount&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    repeatDelayMs&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;endTimespan&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; browser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; report &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; flow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;generateReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  fs&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;writeFileSync&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;flow.report.html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; report&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;flow.report.html&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;wait&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;captureReport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;This generates a report comparing a regular navigation to a timespan which contains both a navigation and scrolling afterwards:&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
  &lt;img alt=&quot;A Lighthouse flow report showing a set of snapshots taken&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;367&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/wAkMF4T9IxpS82vODMdY.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
  &lt;figcaption class=&quot;w-figcaption&quot;&gt;&lt;a href=&quot;https://abaft-burnt-title.glitch.me/&quot;&gt;See the report live&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Digging into each step, the navigation-only step shows a CLS of 0. Great site!&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;The Lighthouse report covering only page navigation with all green metrics&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;364&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 400px) 400px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/ZAKscmqryi5KVWOMiB5y.png?auto=format&amp;w=800 800w&quot; width=&quot;400&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;However the &amp;quot;Navigate and scroll&amp;quot; step tells a different story. Currently only Total Blocking Time and Cumulative Layout Shift are available in timespans, but the lazy-loaded content on this page clearly tanks the CLS for the site.&lt;/p&gt;
&lt;figure class=&quot;w-figure&quot;&gt;
&lt;img alt=&quot;The Lighthouse report covering page navigation and scrolling with a failing CLS&quot; class=&quot;w-screenshot&quot; decoding=&quot;async&quot; height=&quot;305&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 400px) 400px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/MtjnObpuceYe3ijODN3a79WrxLU2/8tCyVELstYqtDFX3TunI.png?auto=format&amp;w=800 800w&quot; width=&quot;400&quot; /&gt;
&lt;/figure&gt;
&lt;p&gt;Formerly, Lighthouse would not be able to identify this problematic CLS behavior, though it would almost certainly show up in the experience of real users. Performance testing over scripted interactions improves lab fidelity significantly.&lt;/p&gt;
&lt;h2 id=&quot;looking-for-feedback&quot;&gt;Looking for feedback &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/lighthouse-user-flows/#looking-for-feedback&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The new user flow APIs in Lighthouse can do many new things, but it may still be complicated to measure the kind of scenarios your users encounter.&lt;/p&gt;
&lt;p&gt;Please reach out with any questions in the Lighthouse &lt;a href=&quot;https://github.com/GoogleChrome/lighthouse/discussions&quot; rel=&quot;noopener&quot;&gt;discussion forums&lt;/a&gt;, and file any bugs or suggestions in the &lt;a href=&quot;https://github.com/GoogleChrome/lighthouse/issues&quot; rel=&quot;noopener&quot;&gt;issue tracker&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Brendan Kenny</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Everything announced at Chrome Dev Summit 2021</title>
      <link href="https://web.dev/docs/cds2021-updates/"/>
      <updated>2021-11-03T00:00:00Z</updated>
      <id>https://web.dev/docs/cds2021-updates/</id>
      <content type="text/html" mode="escaped">&lt;div class=&quot;youtube&quot;&gt;  &lt;lite-youtube videoid=&quot;n57U2_-3NLQ&quot;&gt;  &lt;/lite-youtube&gt;&lt;/div&gt;
&lt;p&gt;This post rounds up all the key announcements from the 2021 Chrome Dev Summit, with the links you need to find out more.&lt;/p&gt;
&lt;h2 id=&quot;make-the-web-more-interoperable&quot;&gt;Make the web more interoperable &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/cds2021-updates/#make-the-web-more-interoperable&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Web compatibility is one of the biggest challenges for web developers,
and so Google has been working with other browser vendors to fix the top five compatibility pain points:
&lt;a href=&quot;https://web.dev/learn/css/flexbox/&quot;&gt;flexbox&lt;/a&gt;,
&lt;a href=&quot;https://web.dev/learn/css/grid/&quot;&gt;grid&lt;/a&gt;,
&lt;code&gt;position: sticky&lt;/code&gt;,
&lt;a href=&quot;https://web.dev/aspect-ratio/&quot;&gt;&lt;code&gt;aspect-ratio&lt;/code&gt;&lt;/a&gt;,
and &lt;a href=&quot;https://web.dev/learn/css/transitions/#transform&quot;&gt;transforms&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The work has already led to improvements in these key areas.
You can read about those in the &lt;a href=&quot;https://web.dev/compat2021-midyear/&quot;&gt;Compat 2021 mid-year update&lt;/a&gt;.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The Microsoft Edge team took on the work of rewriting CSS grid layout as part of the Compat 2021 effort.
You can read about their work in the post
&lt;a href=&quot;https://blogs.windows.com/msedgedev/2021/08/10/compat2021-css-grid-gridng/&quot; rel=&quot;noopener&quot;&gt;Compat2021: Improving CSS Grid compatibility with GridNG&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;allow-new-classes-of-applications-to-run-on-the-web&quot;&gt;Allow new classes of applications to run on the web &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/cds2021-updates/#allow-new-classes-of-applications-to-run-on-the-web&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://web.dev/fugu-status/&quot;&gt;Project Fugu&lt;/a&gt; is an effort that aims to allow new classes of applications to the web.
You can keep up to date with progress on the Fugu APIs at &lt;a href=&quot;https://fugu-tracker.web.app/&quot; rel=&quot;noopener&quot;&gt;fugu-tracker.web.app&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Adobe recently announced that they are bringing Photoshop to the web,
a feat made possible by collaboration between Adobe, Google, and web standards organizations.
Find out more in the post &lt;a href=&quot;https://web.dev/ps-on-the-web/&quot;&gt;Photoshop&#39;s journey to the web&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;ensure-privacy&quot;&gt;Ensure privacy &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/cds2021-updates/#ensure-privacy&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Many common web functions rely on third-party cookies and other cross-site tracking mechanisms that weren’t designed with privacy in mind, making it difficult for developers to meet the growing need for privacy.&lt;/p&gt;
&lt;p&gt;We are working with the web community and industry stakeholders to develop new privacy-preserving technologies to support the ecosystem,
with the aim to phase out third-party cookies and reduce covert tracking and browser fingerprinting.&lt;/p&gt;
&lt;p&gt;Find out about this work on the &lt;a href=&quot;https://privacysandbox.com/&quot; rel=&quot;noopener&quot;&gt;Privacy Sandbox&lt;/a&gt; site.
We also have &lt;a href=&quot;https://developer.chrome.com/docs/privacy-sandbox/&quot; rel=&quot;noopener&quot;&gt;information and guides to the proposals for developers&lt;/a&gt;,
a &lt;a href=&quot;https://developer.chrome.com/tags/progress-in-the-privacy-sandbox/&quot; rel=&quot;noopener&quot;&gt;monthly update or changes and progress&lt;/a&gt;,
and information on the timeline and testing details for &lt;a href=&quot;https://goo.gle/user-agent-reduction&quot; rel=&quot;noopener&quot;&gt;changes to the user-agent string&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;improve-core-web-vitals&quot;&gt;Improve Core Web Vitals &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/cds2021-updates/#improve-core-web-vitals&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We&#39;ve been working with the developers of popular JavaScript frameworks to improve Core Web Vitals,
and as part of that work have identified two new metrics that we&#39;d love your feedback on.
Read about &lt;a href=&quot;https://web.dev/responsiveness/&quot;&gt;overall responsiveness&lt;/a&gt; and
&lt;a href=&quot;https://web.dev/smoothness/&quot;&gt;smoothness&lt;/a&gt;, then let us know what you think.&lt;/p&gt;
&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;You can find out more on our collaboration with JavaScript frameworks in our post
&lt;a href=&quot;https://web.dev/introducing-aurora/&quot;&gt;Introducing Aurora&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;p&gt;Also announced is an updated version of &lt;a href=&quot;https://web.dev/whats-new-pagespeed-insights/&quot;&gt;PageSpeed Insights&lt;/a&gt;,
a new &lt;a href=&quot;https://developer.chrome.com/docs/devtools/recorder/&quot; rel=&quot;noopener&quot;&gt;Recorder Panel for Chrome DevTools&lt;/a&gt;, currently available in Canary,
and a new &lt;a href=&quot;https://web.dev/lighthouse-user-flows/&quot;&gt;user flow API for Lighthouse&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;enable-new-web-platform-features&quot;&gt;Enable new web platform features &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/cds2021-updates/#enable-new-web-platform-features&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;RenderingNG is an ambitious refactoring of Chromium&#39;s rendering engine,
a project that is fixing long standing bugs in Chrome, and also unlocking new features.
This includes one feature that has been the top request from web developers for many years—&lt;a href=&quot;https://developer.mozilla.org/docs/Web/CSS/CSS_Container_Queries&quot; rel=&quot;noopener&quot;&gt;container queries&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Container queries look familiar to anyone who has ever used a media query to create a responsive design.
However, inside of querying the viewport size, they allow you to query the size of the container your component is in.
Google has been working on a trial implementation of the emerging specification, behind the &lt;code&gt;#enable-container-queries&lt;/code&gt; flag in Chrome.&lt;/p&gt;
&lt;p&gt;Read a blog post covering
&lt;a href=&quot;https://developer.chrome.com/blog/renderingng/&quot; rel=&quot;noopener&quot;&gt;RenderingNG in detail&lt;/a&gt;,
or watch &lt;a href=&quot;https://www.youtube.com/watch?v=sUbJPHYKZkU&quot; rel=&quot;noopener&quot;&gt;this video&lt;/a&gt;
to get all the key details of how this work unlocks implementation of features that were once thought impossible to land.&lt;/p&gt;
&lt;h2 id=&quot;help-you-to-create-beautiful-and-responsive-sites&quot;&gt;Help you to create beautiful and responsive sites &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/cds2021-updates/#help-you-to-create-beautiful-and-responsive-sites&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://web.dev/new-responsive/&quot;&gt;new responsive design&lt;/a&gt; is so much more than just screen—or container—size.
You can learn how to create modern responsive sites in our course
&lt;a href=&quot;https://web.dev/learn/design/&quot;&gt;Learn Design&lt;/a&gt;.
The first five modules launch today, the rest will be posted over the coming weeks.&lt;/p&gt;
&lt;p&gt;New CSS properties have landed in Chrome and other browsers this year to make creating beautiful experiences easier.
Find out more about &lt;a href=&quot;https://web.dev/accent-color/&quot;&gt;&lt;code&gt;accent-color&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;https://web.dev/css-size-adjust/&quot;&gt;&lt;code&gt;size-adjust&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To help you quickly take advantage of new CSS, we have launched a set of &lt;a href=&quot;https://web.dev/patterns/layout/&quot;&gt;layout patterns&lt;/a&gt;.
These will give you a robust starting point for many common interface patterns.&lt;/p&gt;
&lt;h2 id=&quot;provide-courses-to-help-you-learn-web-technology&quot;&gt;Provide courses to help you learn web technology &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/cds2021-updates/#provide-courses-to-help-you-learn-web-technology&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In addition to Learn Design, we are launching new modules for &lt;a href=&quot;https://web.dev/learn/css/&quot;&gt;Learn CSS&lt;/a&gt;,
our comprehensive CSS course launched earlier this year.&lt;/p&gt;
&lt;p&gt;We have also developed a complete course helping you to design functional and accessible forms—&lt;a href=&quot;https://web.dev/learn/forms/&quot;&gt;Learn Forms&lt;/a&gt;.
Along with these courses, you can find the first few modules of &lt;a href=&quot;https://web.dev/learn/pwa/&quot;&gt;Learn PWA&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Rachel Andrew</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Picking colors of any pixel on the screen with the EyeDropper API</title>
      <link href="https://web.dev/docs/eyedropper/"/>
      <updated>2021-10-27T00:00:00Z</updated>
      <id>https://web.dev/docs/eyedropper/</id>
      <content type="text/html" mode="escaped">&lt;aside class=&quot;aside flow bg-state-info-bg color-state-info-text&quot;&gt;
&lt;div class=&quot; flow&quot;&gt;
&lt;p&gt;The EyeDropper API is part of the &lt;a href=&quot;https://web.dev/fugu-status/&quot;&gt;capabilities project&lt;/a&gt; and is currently
in development. This post will be updated as the implementation progresses.&lt;/p&gt;
&lt;/div&gt;&lt;/aside&gt;
&lt;h2 id=&quot;what&quot;&gt;What is the EyeDropper API? &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#what&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Many creative applications allow users to pick colors from parts of the app window or even from the
entire screen, typically using an eyedropper metaphor.&lt;/p&gt;
&lt;p&gt;Photoshop, for example, lets users sample colors from the canvas so they don&#39;t have to guess a color
and risk getting it wrong. PowerPoint also has an eyedropper tool,
useful when setting the outline or fill color of a shape. Even Chromium DevTools has an eyedropper
you can use when editing colors in the CSS styles panel so you don&#39;t have to remember or copy the
color code from somewhere else.&lt;/p&gt;
&lt;p&gt;If you&#39;re building a creative application with web technologies, you might want to provide a similar
feature to your users. However, doing this on the web is hard, if possible at all, especially if you
want to sample colors from the entire device&#39;s screen (for example, from a different application)
and not just from the current browser tab. There isn&#39;t a browser-supplied eyedropper tool that web
apps can use for their own needs.&lt;/p&gt;
&lt;p&gt;The &lt;a href=&quot;https://developer.mozilla.org/docs/Web/HTML/Element/input/color&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;&amp;lt;input type=&amp;quot;color&amp;quot;&amp;gt;&lt;/code&gt;&lt;/a&gt;
element comes close. On Chromium-based browsers running on desktop devices, it provides a helpful
eyedropper in the color picker drop down. However, using this means your app would have to customize
it with CSS, and wrap it in a bit of JavaScript to make it available to other parts of your app.
Going with this option also means other browsers would not have access to the feature.&lt;/p&gt;
&lt;p&gt;The EyeDropper API fills this gap by providing a way to sample colors from the screen.&lt;/p&gt;
&lt;img alt=&quot;Chromium color picker.&quot; decoding=&quot;async&quot; height=&quot;400&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 308px) 308px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/JqDpX2OSqF6WAO9ytD8x.png?auto=format&amp;w=616 616w&quot; width=&quot;308&quot; /&gt;
&lt;h2 id=&quot;status&quot;&gt;Current status &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#status&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;div&gt;
&lt;div class=&quot;w-table-wrapper&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Step&lt;/th&gt;
&lt;th&gt;Status&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1. Create explainer&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://github.com/WICG/eyedropper-api&quot; rel=&quot;noopener&quot;&gt;Complete&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2. Create initial draft of specification&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://wicg.github.io/eyedropper-api/&quot; rel=&quot;noopener&quot;&gt;Complete&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3. Gather feedback &amp;amp; iterate on design&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;https://web.dev/docs/eyedropper/#feedback&quot;&gt;In progress&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4. Origin trial&lt;/td&gt;
&lt;td&gt;Complete&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5. &lt;strong&gt;Launch&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;Chromium 95&lt;/strong&gt;&lt;br /&gt;(Desktop only.)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;use&quot;&gt;How to use the EyeDropper API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#use&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;feature-detection-and-browser-support&quot;&gt;Feature detection and browser support &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#feature-detection-and-browser-support&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;First, make sure the API is available before using it.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;EyeDropper&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; window&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// The API is available!&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The EyeDropper API is supported on Chromium-based browsers like Edge or Chrome as of
version 95.&lt;/p&gt;
&lt;h3 id=&quot;using-the-api&quot;&gt;Using the API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#using-the-api&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To use the API, create an &lt;code&gt;EyeDropper&lt;/code&gt; object and then call its &lt;code&gt;open()&lt;/code&gt; method.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; eyeDropper &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EyeDropper&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The &lt;code&gt;open()&lt;/code&gt; method returns a promise that resolves after the user selects a pixel on the
screen, and the resolved value provides access to the pixel&#39;s color in sRGBHex format (&lt;code&gt;#RRGGBB&lt;/code&gt;).
The promise is rejected if the user leaves the eyedropper mode by pressing the &lt;kbd&gt;esc&lt;/kbd&gt; key.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; eyeDropper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// The user selected a pixel, here is its color:&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; colorHexValue &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sRGBHex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// The user escaped the eyedropper mode.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;The app&#39;s code can also cancel the eyedropper mode. This can come in handy if the app&#39;s state
changes in a substantial way. Maybe a popup dialog appears and requires the input of the user. The
eyedropper mode should be stopped at that point.&lt;/p&gt;
&lt;p&gt;To cancel the eyedropper, you can use an
&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/AbortController&quot; rel=&quot;noopener&quot;&gt;AbortController&lt;/a&gt; object&#39;s signal and
pass it to the &lt;code&gt;open()&lt;/code&gt; method.&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; abortController &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AbortController&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; eyeDropper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;signal&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; abortController&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;signal&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;err&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;// And then later, when the eyedropper mode needs to be stopped:&lt;/span&gt;&lt;br /&gt;abortController&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;abort&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;p&gt;Putting it all together, below you can find a reusable async function:&lt;/p&gt;
&lt;div&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sampleColorFromScreen&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;abortController&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; eyeDropper &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EyeDropper&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; eyeDropper&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;signal&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; abortController&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;signal&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sRGBHex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;h2 id=&quot;try-it!&quot;&gt;Try it! &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#try-it!&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using Microsoft Edge or Google Chrome 95 or later, on Windows or Mac, open one of the
&lt;a href=&quot;https://captainbrosset.github.io/eyedropper-demos/&quot; rel=&quot;noopener&quot;&gt;EyeDropper demos&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Try the &lt;a href=&quot;https://captainbrosset.github.io/eyedropper-demos/color-game.html&quot; rel=&quot;noopener&quot;&gt;color game demo&lt;/a&gt; for
instance. Hit the &lt;strong&gt;Play&lt;/strong&gt; button and in a limited amount of time, attempt to sample a color from
the list at the bottom that matches the colored square at the top.&lt;/p&gt;
&lt;img alt=&quot;Color game demo.&quot; decoding=&quot;async&quot; height=&quot;455&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/gD2C2AmnOnP4EhVBhczm.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;h2 id=&quot;privacy-and-security-considerations&quot;&gt;Privacy and security considerations &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#privacy-and-security-considerations&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Behind this seemingly simple web API hides a potentially harmful privacy and security concern. What
if a malicious website could start seeing pixels from your screen?&lt;/p&gt;
&lt;p&gt;To address this concern, the API specification requires the following measures:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;First, the API doesn&#39;t actually let the eyedropper mode start without user intent. The &lt;code&gt;open()&lt;/code&gt; method
can only be called in response to a user action (like a button click).&lt;/li&gt;
&lt;li&gt;Second, no pixel information can be retrieved without user intent again. The promise returned by
&lt;code&gt;open()&lt;/code&gt; only resolves to a color value in response to a user action (clicking on a pixel). So the
eyedropper cannot be used in the background without the user noticing it.&lt;/li&gt;
&lt;li&gt;To help users notice the eyedropper mode easily, browsers are required to make the mode obvious.
This is why the normal mouse cursor disappears after a short delay and the dedicated user interface
appears instead. There&#39;s also a delay between when the eyedropper mode starts and when the user
can select a pixel to ensure the user has had time to see the magnifying glass.&lt;/li&gt;
&lt;li&gt;Finally, users are able to cancel the eyedropper mode at any time (by pressing the &lt;kbd&gt;esc&lt;/kbd&gt;
key).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;feedback&quot;&gt;Feedback &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#feedback&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Chromium team wants to hear about your experiences with the EyeDropper API.&lt;/p&gt;
&lt;h3 id=&quot;tell-us-about-the-api-design&quot;&gt;Tell us about the API design &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#tell-us-about-the-api-design&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Is there something about the API that doesn&#39;t work like you expected? Or are there missing methods
or properties that you need to implement your idea? Have a question or comment on the security
model? File a spec issue on the API&#39;s &lt;a href=&quot;https://github.com/wicg/eyedropper-api/issues&quot; rel=&quot;noopener&quot;&gt;GitHub repo&lt;/a&gt;, or add your thoughts to an
existing issue.&lt;/p&gt;
&lt;h3 id=&quot;report-a-problem-with-the-implementation&quot;&gt;Report a problem with the implementation &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#report-a-problem-with-the-implementation&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Did you find a bug with Chromium&#39;s implementation? Or is the implementation different from the spec?
File a bug at &lt;a href=&quot;https://new.crbug.com/&quot; rel=&quot;noopener&quot;&gt;new.crbug.com&lt;/a&gt;. Be sure to include as much detail as you can,
simple instructions for reproducing, and enter &lt;code&gt;Blink&amp;gt;Forms&amp;gt;Color&lt;/code&gt; in the &lt;strong&gt;Components&lt;/strong&gt; box.
&lt;a href=&quot;https://glitch.com/&quot; rel=&quot;noopener&quot;&gt;Glitch&lt;/a&gt; works great for sharing quick and easy repros.&lt;/p&gt;
&lt;h3 id=&quot;show-support-for-the-api&quot;&gt;Show support for the API &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#show-support-for-the-api&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Are you planning to use the EyeDropper API? Your public support helps the Chromium team prioritize
features and shows other browser vendors how critical it is to support them. Send a tweet to
&lt;a href=&quot;https://twitter.com/ChromiumDev&quot; rel=&quot;noopener&quot;&gt;@ChromiumDev&lt;/a&gt; using the hashtag
&lt;a href=&quot;https://twitter.com/search?q=%23EyeDropper&amp;amp;src=recent_search_click&amp;amp;f=live&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;#EyeDropper&lt;/code&gt;&lt;/a&gt; and let
us know where and how you&#39;re using it.&lt;/p&gt;
&lt;h2 id=&quot;helpful&quot;&gt;Helpful links &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#helpful&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/WICG/eyedropper-api&quot; rel=&quot;noopener&quot;&gt;Public explainer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://captainbrosset.github.io/eyedropper-demos/&quot; rel=&quot;noopener&quot;&gt;EyeDropper API Demo&lt;/a&gt; | &lt;a href=&quot;https://github.com/captainbrosset/eyedropper-demos&quot; rel=&quot;noopener&quot;&gt;EyeDropper API Demo source&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=897309&quot; rel=&quot;noopener&quot;&gt;Chromium tracking bug&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bugs.chromium.org/p/chromium/issues/detail?id=897309&quot; rel=&quot;noopener&quot;&gt;ChromeStatus.com entry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Blink Component: &lt;a href=&quot;https://chromestatus.com/features#component%3ABlink%3EForms%3EForms&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;Blink&amp;gt;Forms&amp;gt;Color&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/w3ctag/design-reviews/issues/587&quot; rel=&quot;noopener&quot;&gt;TAG Review&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://lists.webkit.org/pipermail/webkit-dev/2021-July/031929.html&quot; rel=&quot;noopener&quot;&gt;WebKit position request&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/mozilla/standards-positions/issues/557&quot; rel=&quot;noopener&quot;&gt;Mozilla position request&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://groups.google.com/a/chromium.org/g/blink-dev/c/rdniQ0D5UfY/m/Aywn9XyyAAAJ&quot; rel=&quot;noopener&quot;&gt;Intent to Ship&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;acknowledgements&quot;&gt;Acknowledgements &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/eyedropper/#acknowledgements&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The EyeDropper API was specified and implemented by
&lt;a href=&quot;https://www.linkedin.com/in/ionelpopescu/&quot; rel=&quot;noopener&quot;&gt;Ionel Popescu&lt;/a&gt; from the Microsoft Edge team. This post
was reviewed by &lt;a href=&quot;https://github.com/jpmedley&quot; rel=&quot;noopener&quot;&gt;Joe Medley&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Patrick Brosset</name>
        </author><author>
          <name>Thomas Steiner</name>
        </author>
    </entry>
    
    
    
    <entry>
      <title>Photoshop&#39;s journey to the web</title>
      <link href="https://web.dev/docs/ps-on-the-web/"/>
      <updated>2021-10-26T00:00:00Z</updated>
      <id>https://web.dev/docs/ps-on-the-web/</id>
      <content type="text/html" mode="escaped">&lt;p&gt;Over the last three years, Chrome has been working to empower web applications that want to push the boundaries of what&#39;s possible in the browser. One such web application has been Photoshop. The idea of running software as complex as Photoshop directly in the browser would have been hard to imagine just a few years ago. However, by using various new standardized web technologies, Adobe has now brought a public beta of Photoshop to the web.&lt;/p&gt;
&lt;img alt=&quot;The Photoshop web app running in a browser with an image showing an elephant on the canvas and the &amp;#x27;selection tools&amp;#x27; menu item open.&quot; decoding=&quot;async&quot; height=&quot;500&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/kfFAUTzDHzvE3hXISyQO.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;In this post, we&#39;d like to share for the first time the details of how our collaboration is extending Photoshop to the web. You can use all the APIs Adobe used and more in your own apps as well. Be sure to check out our &lt;a href=&quot;https://web.dev/tags/capabilities/&quot;&gt;web capabilities related blog posts&lt;/a&gt; for inspiration and watch our &lt;a href=&quot;https://fugu-tracker.web.app/&quot; rel=&quot;noopener&quot;&gt;API tracker&lt;/a&gt; for the latest and greatest we&#39;re working on.&lt;/p&gt;
&lt;h2 id=&quot;why-photoshop-came-to-the-web&quot;&gt;Why Photoshop came to the web &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#why-photoshop-came-to-the-web&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As the web has evolved, one thing that hasn&#39;t changed are the core advantages that websites and web apps offer over platform-specific applications. These advantages include many unique capabilities such as being linkable, ephemeral, and universal, but they boil down to enabling simple access, easy sharing, and great collaboration.&lt;/p&gt;
&lt;p&gt;The simple power of a URL is that anyone can click it and instantly access it. All you need is a browser. There is no need to install an application or worry about what operating system you are running on. For web applications, that means users can have access to the application and their documents and comments. This makes the web the ideal collaboration platform, something that is becoming more and more essential to creative and marketing teams.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.google.com/&quot; rel=&quot;noopener&quot;&gt;Google Docs&lt;/a&gt; was a pioneer of this simplified access. Most of us know how easy it is to start a document, send the link to someone, and immediately jump into not only the application, but the specific document or comment as well. Since then, a plethora of amazing applications, such as &lt;a href=&quot;https://www.youtube.com/watch?v=Nrm5G9A_dfs&quot; rel=&quot;noopener&quot;&gt;those we&#39;ve shown off in the past&lt;/a&gt;, have adopted this model and now Photoshop, too, will benefit.&lt;/p&gt;
&lt;h2 id=&quot;how-photoshop-came-to-the-web&quot;&gt;How Photoshop came to the web &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#how-photoshop-came-to-the-web&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The web started out as a platform only suited for documents, but has grown dramatically throughout its history. Early apps like &lt;a href=&quot;https://www.google.com/gmail/&quot; rel=&quot;noopener&quot;&gt;Gmail&lt;/a&gt; showed that more complex interactivity and applications were at least possible. Since then, we&#39;ve seen impressive co-development where web apps push the boundaries of what&#39;s possible, and browser vendors respond by further expanding web capabilities. The latest iteration of this virtuous loop is what has enabled Photoshop on the web.&lt;/p&gt;
&lt;p&gt;Adobe previously brought &lt;a href=&quot;https://spark.adobe.com/sp/&quot; rel=&quot;noopener&quot;&gt;Spark&lt;/a&gt; and &lt;a href=&quot;https://lightroom.adobe.com/&quot; rel=&quot;noopener&quot;&gt;Lightroom&lt;/a&gt; to the web and had been interested in bringing Photoshop to the web for many years. However, they were blocked by the performance limitations of JavaScript, the absence of a good compile target for their code, and the lack of web capabilities. Read on to learn what Chrome built in the browser to solve these problems.&lt;/p&gt;
&lt;h2 id=&quot;webassembly-porting-with-emscripten&quot;&gt;WebAssembly porting with Emscripten &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#webassembly-porting-with-emscripten&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;WebAssembly and its C++ toolchain &lt;a href=&quot;https://emscripten.org/&quot; rel=&quot;noopener&quot;&gt;Emscripten&lt;/a&gt; have been the key to unlocking Photoshop&#39;s ability to come to the web, as it meant that Adobe would not have to start from scratch, but could leverage their existing Photoshop codebase. WebAssembly is a portable binary instruction set shipping in all browsers that was designed as a compilation target for programming languages. This means that applications such as Photoshop that are written in C++ can be ported directly to the web without requiring a rewrite in JavaScript. To get started porting yourself, check out the full &lt;a href=&quot;https://emscripten.org/docs/index.html&quot; rel=&quot;noopener&quot;&gt;Emscripten documentation&lt;/a&gt;, or follow this &lt;a href=&quot;https://developers.google.com/web/updates/2018/03/emscripting-a-c-library&quot; rel=&quot;noopener&quot;&gt;guided example of how to port a library&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Emscripten is a fully-featured toolchain that not only helps you compile your C++ to Wasm, but provides a translation layer that turns POSIX API calls into web API calls and even converts OpenGL into WebGL. For example, you can port applications that reference the local filesystem and &lt;a href=&quot;https://emscripten.org/docs/porting/files/file_systems_overview.html#file-system-overview&quot; rel=&quot;noopener&quot;&gt;Emscripten will provide an emulated file system&lt;/a&gt; to maintain functionality.&lt;/p&gt;
&lt;p&gt;Emscripten has been capable of bringing most parts of Photoshop to the web for a while, but it wasn&#39;t necessarily fast enough. We have continually worked with Adobe to figure out where bottlenecks are and improve Emscripten. Photoshop depends upon multithreading. Bringing dynamic &lt;a href=&quot;https://emscripten.org/docs/porting/pthreads.html&quot; rel=&quot;noopener&quot;&gt;multithreading&lt;/a&gt; to WebAssembly was a critical requirement.&lt;/p&gt;
&lt;p&gt;Also, exception-based error handling is very common in C++, but wasn&#39;t well supported in Emscripten and WebAssembly. We have worked with the &lt;a href=&quot;https://www.w3.org/community/webassembly/&quot; rel=&quot;noopener&quot;&gt;WebAssembly Community Group&lt;/a&gt; in the W3C to improve the WebAssembly standard and the tooling around it to bring C++ exceptions to WebAssembly.&lt;/p&gt;
&lt;p&gt;Emscripten doesn&#39;t just work on large applications, but also lets you port libraries or smaller projects! For example, you can see &lt;a href=&quot;https://docs.opencv.org/3.4/d4/da1/tutorial_js_setup.html&quot; rel=&quot;noopener&quot;&gt;how you can compile the popular OpenCV library&lt;/a&gt; to the web through Emscripten.&lt;/p&gt;
&lt;p&gt;Lastly, WebAssembly offers advanced performance primitives such as &lt;a href=&quot;https://emscripten.org/docs/porting/simd.html&quot; rel=&quot;noopener&quot;&gt;SIMD instructions&lt;/a&gt; which dramatically improve your web app performance. For example, &lt;a href=&quot;https://halide-lang.org/&quot; rel=&quot;noopener&quot;&gt;Halide&lt;/a&gt; is essential to Adobe&#39;s performance, and here SIMD provides a 3–4× speedup on average and in some cases a 80–160× speedup.&lt;/p&gt;
&lt;h2 id=&quot;webassembly-debugging&quot;&gt;WebAssembly debugging &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#webassembly-debugging&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;No large project can be successfully completed without the appropriate tools for the job, and it&#39;s for this reason that the Chrome team developed full featured WebAssembly debugging support. It provides support for stepping through the source code, setting breakpoints and pausing on exceptions, variable inspection with rich type support, and even basic support for evaluation in the DevTools console!&lt;/p&gt;
&lt;img alt=&quot;WebAssembly debugging in DevTools showing breakpoints in the code so it can be stepped through.&quot; decoding=&quot;async&quot; height=&quot;325&quot; loading=&quot;lazy&quot; sizes=&quot;(min-width: 800px) 800px, calc(100vw - 48px)&quot; src=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&quot; srcset=&quot;https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=200 200w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=228 228w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=260 260w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=296 296w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=338 338w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=385 385w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=439 439w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=500 500w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=571 571w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=650 650w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=741 741w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=845 845w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=964 964w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=1098 1098w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=1252 1252w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=1428 1428w, https://web-dev.imgix.net/image/8WbTDNrhLsU0El80frMBGE4eMCD3/ZwSsG07jcIvFZOdid5yd.png?auto=format&amp;w=1600 1600w&quot; width=&quot;800&quot; /&gt;
&lt;p&gt;Be sure to check out the &lt;a href=&quot;https://developer.chrome.com/blog/wasm-debugging-2020/&quot; rel=&quot;noopener&quot;&gt;authoritative guide on how to utilize WebAssembly Debugging&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;high-performance-storage&quot;&gt;High performance storage &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#high-performance-storage&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Given how large Photoshop documents can be, a critical need for Photoshop is the ability to dynamically move data from on-disk to in-memory as the user pans around. On other platforms, this is accomplished usually through memory mapping via &lt;a href=&quot;https://en.wikipedia.org/wiki/Mmap&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;mmap&lt;/code&gt;&lt;/a&gt;, but this hasn&#39;t been performantly possible on the web—that is until origin private file system access handles were developed and implemented as an origin trial! You can read how to leverage this new API &lt;a href=&quot;https://web.dev/file-system-access/#accessing-files-optimized-for-performance-from-the-origin-private-file-system&quot;&gt;in the documentation&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;p3-color-space-for-canvas&quot;&gt;P3 color space for canvas &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#p3-color-space-for-canvas&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Historically, colors on the web have been specified in the &lt;a href=&quot;https://en.wikipedia.org/wiki/SRGB&quot; rel=&quot;noopener&quot;&gt;sRGB&lt;/a&gt; color space, which is a standard from the mid-nineties, based on the capabilities of cathode-ray tube monitors. Cameras and monitors have come a long way in the intervening quarter-century, and many larger and more capable color spaces have been standardized. One of the most popular modern color spaces is &lt;a href=&quot;https://en.wikipedia.org/wiki/DCI-P3&quot; rel=&quot;noopener&quot;&gt;Display P3&lt;/a&gt;. Photoshop uses a &lt;a href=&quot;https://github.com/WICG/canvas-color-space/blob/main/CanvasColorSpaceProposal.md&quot; rel=&quot;noopener&quot;&gt;Display P3 Canvas&lt;/a&gt; to display images more accurately in the browser. In particular, images with bright whites, bright colors, and details in shadows will display as best as possible on modern displays that support Display P3 data.
The Display P3 Canvas API is being further built upon to enable &lt;a href=&quot;https://github.com/w3c/ColorWeb-CG/blob/master/hdr_html_canvas_element.md&quot; rel=&quot;noopener&quot;&gt;high dynamic range&lt;/a&gt; displays.&lt;/p&gt;
&lt;h2 id=&quot;web-components-and-lit&quot;&gt;Web Components and Lit &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#web-components-and-lit&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Photoshop is a famously large and feature-rich application, with hundreds of UI elements supporting dozens of workflows. The app is built by multiple teams using a variety of tools and development practices, but its disparate parts need to come together into a cohesive, high-performing whole.&lt;/p&gt;
&lt;p&gt;To meet this challenge, Adobe turned to &lt;a href=&quot;https://developer.mozilla.org/docs/Web/Web_Components&quot; rel=&quot;noopener&quot;&gt;Web Components&lt;/a&gt; and the &lt;a href=&quot;https://lit.dev/&quot; rel=&quot;noopener&quot;&gt;Lit library&lt;/a&gt;. Photoshop&#39;s UI elements come from Adobe&#39;s &lt;a href=&quot;https://opensource.adobe.com/spectrum-web-components/&quot; rel=&quot;noopener&quot;&gt;Spectrum Web Components&lt;/a&gt; library, a lightweight, performant implementation of the Adobe design system that works with any framework, or no framework at all.&lt;/p&gt;
&lt;p&gt;What&#39;s more, the entire Photoshop app is built using Lit-based Web Components. Leaning on the browser&#39;s built-in component model and Shadow DOM encapsulation, the team found it easy to cleanly integrate a few &amp;quot;islands&amp;quot; of React code provided by other Adobe teams.&lt;/p&gt;
&lt;h2 id=&quot;service-worker-caching-with-workbox&quot;&gt;Service worker caching with Workbox &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#service-worker-caching-with-workbox&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/docs/Web/API/Service_Worker_API&quot; rel=&quot;noopener&quot;&gt;Service workers&lt;/a&gt; act as a programmable local proxy, intercepting network requests and responding with data from the network, long-lived caches, or a mixture of both.&lt;/p&gt;
&lt;p&gt;As part of the &lt;a href=&quot;https://v8.dev/&quot; rel=&quot;noopener&quot;&gt;V8&lt;/a&gt; team&#39;s efforts to improve performance, the first time a service worker responds with a cached WebAssembly response, Chrome generates and stores an optimized version of the code—even for multi-megabyte WebAssembly scripts, which are common in the Photoshop codebase. A similar precompilation takes place when &lt;a href=&quot;https://v8.dev/blog/code-caching-for-devs#use-service-worker-caches&quot; rel=&quot;noopener&quot;&gt;JavaScript is cached&lt;/a&gt; by a service worker during its &lt;a href=&quot;https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle#install&quot; rel=&quot;noopener&quot;&gt;&lt;code&gt;install&lt;/code&gt; step&lt;/a&gt;. In both cases, Chrome is able to load and execute the optimized versions of cached scripts with minimal runtime overhead.&lt;/p&gt;
&lt;p&gt;Photoshop on the web takes advantage of this by deploying a service worker that precaches many of its JavaScript and WebAssembly scripts. Because the URLs for these scripts are generated at build time, and because the logic of keeping caches up to date can be complex, they turned to a set of libraries maintained by Google called &lt;a href=&quot;https://developers.google.com/web/tools/workbox/&quot; rel=&quot;noopener&quot;&gt;Workbox&lt;/a&gt; to generate their service worker as part of their build process.&lt;/p&gt;
&lt;p&gt;A Workbox-based service worker along with the V8 engine&#39;s script caching led to measurable performance improvements. The specific numbers vary based on the device executing the code, but the team estimates these optimizations decreased the time spent on code initialization by 75%.&lt;/p&gt;
&lt;h2 id=&quot;what&#39;s-next-for-adobe-on-the-web&quot;&gt;What&#39;s next for Adobe on the web &lt;a class=&quot;w-headline-link&quot; href=&quot;https://web.dev/docs/ps-on-the-web/#what&#39;s-next-for-adobe-on-the-web&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The launch of the Photoshop beta is just the beginning, and we&#39;ve got several performance and feature improvements already underway as Photoshop tracks towards their full launch after this beta. Adobe isn&#39;t stopping with Photoshop and plans to aggressively expand &lt;a href=&quot;https://www.adobe.com/creativecloud.html&quot; rel=&quot;noopener&quot;&gt;Creative Cloud&lt;/a&gt; to the web, making it a primary platform for both creative content creation and collaboration. This will enable millions of first-time creators to tell their story and benefit from innovative workflows on the web.&lt;/p&gt;
&lt;p&gt;As Adobe continues to push the boundaries of what&#39;s possible, the Chrome team will continue our collaboration to drive the web forward for Adobe and the vibrant web developer ecosystem in general. As other browsers also catch up on these modern browser capabilities, we&#39;re excited to see Adobe make their products available there as well. Stay tuned for future updates as we continue to push the web forward!&lt;/p&gt;
&lt;p&gt;You can learn more about accessing Photoshop on the web (beta) in the &lt;a href=&quot;https://helpx.adobe.com/photoshop/using/photoshop-web-faq.html&quot; rel=&quot;noopener&quot;&gt;Adobe Help Center&lt;/a&gt;.&lt;/p&gt;
</content>
      <author>
          <name>Thomas Nattestad</name>
        </author><author>
          <name>Nabeel Al-Shamma</name>
        </author>
    </entry>
    
</feed>
