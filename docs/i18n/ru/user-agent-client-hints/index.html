
<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
<script>
  // A global function that the theme toggle can use to apply the current theme.
  window.applyThemeSetting = function(override) {
    const currentSetting = override || localStorage.getItem('user-color-scheme');
    const currentAttribute = document.documentElement.getAttribute('data-user-theme');

    if (currentSetting && currentSetting !== currentAttribute) {
      document.documentElement.setAttribute('data-user-theme', currentSetting);
    }
  };
window.applyThemeSetting();
</script>

  
  <link rel="stylesheet" href="/css/next.css?v=04e9efda261c8">
  <link rel="stylesheet" href="/css/legacy-rollout.css?v=8d387d9c38651">
  <link rel="preload" as="font" crossorigin href="/fonts/material-icons/regular.woff2">


<link rel="preload" as="font" crossorigin href="/fonts/google-sans/regular/latin.woff2">
<link rel="preload" as="font" crossorigin href="/fonts/google-sans/bold/latin.woff2">

<meta name="theme-color" content="#fff"/>




<title>Повышение конфиденциальности пользователей и удобства разработчиков с помощью расширения User-Agent Client Hints</title>
<meta name="description" content="" />

<link rel="canonical" href="https://web.dev/i18n/ru/user-agent-client-hints/" />
<link rel="alternate" hreflang="es" href="https://web.dev/i18n/es/user-agent-client-hints/" />
<link rel="alternate" hreflang="ja" href="https://web.dev/i18n/ja/user-agent-client-hints/" />
<link rel="alternate" hreflang="ko" href="https://web.dev/i18n/ko/user-agent-client-hints/" />
<link rel="alternate" hreflang="pt" href="https://web.dev/i18n/pt/user-agent-client-hints/" />
<link rel="alternate" hreflang="ru" href="https://web.dev/i18n/ru/user-agent-client-hints/" />
<link rel="alternate" hreflang="zh" href="https://web.dev/i18n/zh/user-agent-client-hints/" />
<link rel="alternate" hreflang="en" href="https://web.dev/user-agent-client-hints/" />
<meta itemprop="name" content="Повышение конфиденциальности пользователей и удобства разработчиков с помощью расширения User-Agent Client Hints" />
<meta itemprop="description" content="" />
<meta itemprop="image" content="https://web-dev.imgix.net/image/admin/hgxRNa56Vb9o3QRwIrm9.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:locale" content="ru_RU" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://web.dev/i18n/ru/user-agent-client-hints/" />
<meta property="og:site_name" content="web.dev" />
<meta property="og:title" content="Повышение конфиденциальности пользователей и удобства разработчиков с помощью расширения User-Agent Client Hints" />
<meta property="og:description" content="" />
<meta property="og:image" content="https://web-dev.imgix.net/image/admin/hgxRNa56Vb9o3QRwIrm9.jpg?auto=format&fit=max&w=1200&fm=auto" />
<meta property="og:image:alt" content="Множество разных следов на снегу. Намек на то, кто там был." />
<meta property="tag" content="privacy" />
<meta property="tag" content="security" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Повышение конфиденциальности пользователей и удобства разработчиков с помощью расширения User-Agent Client Hints" />
<meta name="twitter:description" content="" />
<meta name="twitter:image" content="https://web-dev.imgix.net/image/admin/hgxRNa56Vb9o3QRwIrm9.jpg?auto=format&fit=max&w=1200&fm=auto" />
<link
  rel="alternate"
  href="/feed.xml"
  type="application/atom+xml"
  data-title="web.dev feed"
/>

<link rel="manifest" href="/manifest.webmanifest" />

<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="mask-icon" color="#0054ff" href="/images/safari-pinned-tab.svg">



<script>
window.ga =
  window.ga ||
  function () {
    (ga.q = ga.q || []).push(arguments);
  };
ga.l = +new Date();
ga('create', 'UA-126406676-2');
ga('set', 'transport', 'beacon');
ga('set', 'anonymizeIp', true);
ga('set', 'page', window.location.pathname);
ga('set', 'dimension5', '4');
ga('send', 'pageview');
</script>







<script>
function loadScript(url, type) {
  const s = document.createElement('script');
  s.src = url;
  if (type) {
    s.type = type;
  }
  if (type === 'module') {
    s.async = false; // Preserve load order.
    const pre = document.createElement('link');
    pre.rel = 'modulepreload';
    pre.href = url;
    document.head.append(pre);
    // We use DOMContentLoaded as the loader script is running sync, and inserting a module script here doesn't defer. This brings back normal type="module" behavior.
    window.addEventListener('DOMContentLoaded', () => {
      document.head.append(s);
    });
  } else {
    document.head.append(s);
  }
}
loadScript('/js/app.js?v=c621469fe1202', 'module');




  loadScript('/js/content.js?v=e85ebb468f4bf', 'module');


  loadScript('https://www.google-analytics.com/analytics.js', null);

</script>

  </head>
  <body class="unresolved">
    
    <web-snackbar-container></web-snackbar-container>

    
<a href="#main" class="skip-link button" data-type="primary">Skip to content</a>


<web-header role="banner" class="site-header">
  <div class="cluster gutter-base">
    <button class="icon-button tooltip color-core-text md:hidden-yes" data-open-drawer-button data-alignment="right">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
      <span class="tooltip__content">Open menu</span>
    </button>
    <a href="/" class="site-header__brand brand">
      


  <svg role="img" aria-label="web.dev" xmlns="http://www.w3.org/2000/svg" width="119.79" height="22.32" viewBox="0 0 119.79 22.32"><path class="brand__text" d="M114.99 19.32h-2.2l-4.8-11.9h2.4l3.5 9.2 3.5-9.2h2.4Zm-16.8-7.3h6.8a3.17 3.17 0 0 0-3.4-2.9 3.42 3.42 0 0 0-3.4 2.9Zm3.6 7.7a6 6 0 0 1-6-6.3c0-3.6 2.5-6.3 5.9-6.3s5.8 2.4 5.8 6.5v.2h-9.3a3.88 3.88 0 0 0 3.8 3.9 3.56 3.56 0 0 0 3.3-2.1l2 1a6.22 6.22 0 0 1-5.5 3.1Zm-14 0c-3.1 0-5.7-2.8-5.7-6.3s2.6-6.3 5.7-6.3a5 5 0 0 1 4.1 2h.1l-.1-1.6v-5.5h2.2v17.3h-2.1v-1.6h-.1a5.12 5.12 0 0 1-4.1 2Zm.3-2c2.2 0 3.8-1.7 3.8-4.3s-1.6-4.3-3.8-4.3a4 4 0 0 0-3.8 4.3 4 4 0 0 0 3.8 4.3Zm-6.8.1a1.61 1.61 0 0 1-1.7 1.6 1.74 1.74 0 0 1-1.7-1.6 1.67 1.67 0 0 1 1.7-1.6 1.61 1.61 0 0 1 1.7 1.6Zm-10.5-.1a4 4 0 0 0 3.8-4.3 4 4 0 0 0-3.8-4.3c-2.2 0-3.8 1.8-3.8 4.3s1.6 4.3 3.8 4.3Zm.4 2a5 5 0 0 1-4.1-2h-.1v1.6h-2.1V2.02h2.2v5.5l-.1 1.6h.1a4.84 4.84 0 0 1 4.1-2c3.1 0 5.7 2.8 5.7 6.3s-2.6 6.3-5.7 6.3Zm-17.4-7.7h6.8a3.17 3.17 0 0 0-3.4-2.9 3.42 3.42 0 0 0-3.4 2.9Zm3.6 7.7a6 6 0 0 1-6-6.3c0-3.6 2.5-6.3 5.9-6.3s5.8 2.4 5.8 6.5v.2h-9.3a3.88 3.88 0 0 0 3.8 3.9 3.67 3.67 0 0 0 3.3-2.1l2 1a6.22 6.22 0 0 1-5.5 3.1Zm-6.3-12.2-3.8 11.9h-2.3l-3-9.1-2.9 9.1h-2.3l-3.9-11.9h2.3l2.6 9 2.9-9h2.3l2.9 9 2.6-9Z" fill="#5f6368" fill-rule="evenodd"/><path d="M0 19.28a3 3 0 0 1 3-3h16.27a3.045 3.045 0 0 1 0 6.09H3.04A3 3 0 0 1 0 19.28Z" fill="#6cf"/><path d="M.89.9a3 3 0 0 1 4.3 0l8.12 8.11a3.05 3.05 0 0 1 0 4.3l-8.12 8.12a3.04 3.04 0 1 1-4.3-4.3l5.6-5.61a.51.51 0 0 0 0-.72L.89 5.22A3 3 0 0 1 .89.9Z" fill="#06f" fill-rule="evenodd"/><path d="m10.39 16.22-5.2 5.2a3.04 3.04 0 1 1-4.3-4.3l.89-.9Z" fill="#c6f"/><circle cx="19.27" cy="19.27" r="3.04" fill="#06f"/></svg>


    </a>
  </div>
  <web-navigation-drawer type="standard">
    <nav class="site-header__nav" aria-label="main navigation" data-drawer-container>
      <a
        class="site-header__link"
        href="/learn/" data-category="Site-Wide Custom Events"
        data-label="Tab: Learn"
        >
          Обучение
      </a>
      <a
        class="site-header__link"
        href="/measure/"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Measure"
        >
        Измерение
      </a>
      <a
        class="site-header__link"
        href="/blog/"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Blog"
        >
        Блог
      </a>
      <a
        class="site-header__link"
        href="/tags/case-study/"
        data-category="Site-Wide Custom Events"
        data-label="Tab: Case Studies"
        >
        Case studies
      </a>
      <a
        class="site-header__link"
        href="/about/"
        data-category="Site-Wide Custom Events"
        data-label="Tab: About" >
        О сайте
      </a>
      <button class="icon-button tooltip color-core-text md:hidden-yes" data-drawer-close-button>
        








  










  <svg class="icon " role="img" aria-label="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>


        <span class="tooltip__content">Закрыть</span>
      </button>
    </nav>
  </web-navigation-drawer>
  <div class="site-header__actions cluster">
    <div class="site-header__search">
      <web-search results-id="search-main-results" i18n="{&quot;search&quot;:{&quot;en&quot;:&quot;Search&quot;},&quot;open_search&quot;:{&quot;en&quot;:&quot;Open search&quot;},&quot;all_articles&quot;:{&quot;en&quot;:&quot;All articles&quot;},&quot;close_search&quot;:{&quot;en&quot;:&quot;Close search&quot;}}"></web-search>
      <web-search-results id="search-main-results"></web-search-results>
    </div>
  </div>
</web-header>

<main id="main">
  
    
  
  





  <img     alt="Множество разных следов на снегу. Намек на то, кто там был."     class="hero-image"     decoding="async"     height="480"               sizes="100vw"     src="https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format"     srcset="https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=200 200w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=228 228w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=260 260w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=296 296w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=338 338w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=385 385w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=439 439w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=500 500w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=571 571w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=650 650w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=741 741w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=845 845w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=964 964w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=1098 1098w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=1252 1252w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=1428 1428w,     https://web-dev.imgix.net/image/admin/xlg4t3uiTp0L5TBThFHQ.jpg?auto=format&w=1600 1600w"          width="1600"   />


<div class="post wrapper" data-flush>
  
    
    
    
  
  

  <div class="sidebar region flex-align-start flex-dir-rev flex-wrap-no">
    

  <nav class="course__toc toc over-scroll hidden-yes xl:hidden-no" data-type="side" aria-label="Содержание">
    <div class="course-toc__heading font-google-sans weight-medium">Содержание</div>
    <web-scroll-spy>
      <div class="toc__wrapper flow-recursive">
        <ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#predystoriya">Предыстория</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#sostoyanie-stroki-user-agent">Состояние строки User-Agent</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#predstavlyaem-novoe-rasshirenie-user-agent-client-hints">Представляем новое расширение User-Agent Client Hints</a></li><li class="toc__listitem"><a class="toc__anchor" href="#user-agent-client-hints-v-chromium-84">User-Agent Client Hints в Chromium 84</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#otvet-user-agent-i-zagolovki-zaprosov">Ответ User-Agent и заголовки запросов</a></li><li class="toc__listitem"><a class="toc__anchor" href="#primer-obmena">Пример обмена</a></li><li class="toc__listitem"><a class="toc__anchor" href="#javascript-api">JavaScript API</a></li><li class="toc__listitem"><a class="toc__anchor" href="#zapustite-demoversiyu">Запустите демоверсию</a></li><li class="toc__listitem"><a class="toc__anchor" href="#srok-sluzhby-podskazki-i-sbros">Срок службы подсказки и сброс</a></li><li class="toc__listitem"><a class="toc__anchor" href="#oblast-primeneniya-podskazok-i-zaprosov-mezhdu-raznymi-istochnikami">Область применения подсказок и запросов между разными источниками</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#gde-ispolzovat-user-agent-client-hints">Где использовать User-Agent Client Hints?</a></li><li class="toc__listitem"><a class="toc__anchor" href="#chto-proishodit-so-strokoj-user-agent">Что происходит со строкой User-Agent?</a></li></ul>
      </div>
    </web-scroll-spy>
  </nav>


    
    <article class="prose legacy-rollout">
      <header class="flow gap-bottom-size-3">
        
          <nav class="breadcrumbs" aria-label="breadcrumbs">
            <ul class="breadcrumbs__list" role="list">
              <li>
                <a
                  class="gc-analytics-event"
                  data-category="web.dev"
                  data-label="post, home breadcrumb"
                  data-action="click"
                  href="/"
                >
                  Home
                </a>
              </li>
              
              <li>
                <a
                  class="gc-analytics-event"
                  data-category="web.dev"
                  data-label="post, path breadcrumb"
                  data-action="click"
                  href="/blog"
                >
                  All articles
                </a>
              </li>
              
            </ul>
          </nav>
        

        <h1 id="povyshenie-konfidencialnosti-polzovatelej-i-udobstva-razrabotchikov-s-pomoshyu-rasshireniya-user-agent-client-hints">Повышение конфиденциальности пользователей и удобства разработчиков с помощью расширения User-Agent Client Hints</h1>
        
          <p class="color-mid-text flow-space-base">
            <p>User-Agent Client Hintsэто новое расширение API Client Hints, которое позволяет разработчикам получать доступ к информации о браузере эргономичным способом с сохранением конфиденциальности пользователей.</p>

          </p>
        

        
          <div class="flow-space-size-1 color-mid-text text-size-0">
            <time>Jun 25, 2020</time>
             — Обновлено <time>Feb 12, 2021</time> 
          </div>
        

        
        
        <div class="flow">
          <span class="w-post-signpost__title">Available in:
    <a class="w-post-signpost__link"
        translate="no"
        lang="es"
        href="/i18n/es/user-agent-client-hints/">
      Español</a>, <a class="w-post-signpost__link"
        translate="no"
        lang="ja"
        href="/i18n/ja/user-agent-client-hints/">
      日本語</a>, <a class="w-post-signpost__link"
        translate="no"
        lang="ko"
        href="/i18n/ko/user-agent-client-hints/">
      한국어</a>, <a class="w-post-signpost__link"
        translate="no"
        lang="pt"
        href="/i18n/pt/user-agent-client-hints/">
      Português</a>, <a class="w-post-signpost__link"
        translate="no"
        lang="zh"
        href="/i18n/zh/user-agent-client-hints/">
      中文</a>, <a class="w-post-signpost__link"
        translate="no"
        lang="en"
        href="/i18n/en/user-agent-client-hints/">
      English</a></span>
        </div>
        

        <div class="w-layout-container--narrow w-post-signpost">
  <span class="w-post-signpost__title">
    Appears in:
  </span>
  <a
          class="w-post-signpost__link"
          href="/secure"
          >Безопасность и надежность</a
        >
</div>

        
          <div class="cluster flow-space-size-2">
            
              <div class="author">
  <a class="avatar" href="/authors/rowan_m/"> <img     alt="Rowan Merewood"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/TASwqsVceW68MrM7bjt8.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /> </a>
  <div class="flow">
    <cite class="author__name">
      <a href="/authors/rowan_m/">Rowan Merewood</a>
    </cite>
    <div class="author__links cluster">
               <a href="https://twitter.com/rowan_m">Twitter</a>
               <a href="https://github.com/rowan-m">GitHub</a>
               <a href="https://glitch.com/@rowan-m">Glitch</a>
               
             </div>
  </div>
</div>
            
              <div class="author">
  <a class="avatar" href="/authors/yoavweiss/"> <img     alt="Yoav Weiss"     class="w-author__image"     decoding="async"     height="64"          loading="lazy"     sizes="(min-width: 64px) 64px, calc(100vw - 48px)"     src="https://web-dev.imgix.net/image/admin/FOIxDKJfuHssXMNzezIt.jpg?auto=format&fit=crop&h=64&w=64"     srcset="https://web-dev.imgix.net/image/admin/FOIxDKJfuHssXMNzezIt.jpg?fit=crop&h=64&w=64&auto=format&dpr=1&q=75 1x,     https://web-dev.imgix.net/image/admin/FOIxDKJfuHssXMNzezIt.jpg?fit=crop&h=64&w=64&auto=format&dpr=2&q=50 2x,     https://web-dev.imgix.net/image/admin/FOIxDKJfuHssXMNzezIt.jpg?fit=crop&h=64&w=64&auto=format&dpr=3&q=35 3x,     https://web-dev.imgix.net/image/admin/FOIxDKJfuHssXMNzezIt.jpg?fit=crop&h=64&w=64&auto=format&dpr=4&q=23 4x,     https://web-dev.imgix.net/image/admin/FOIxDKJfuHssXMNzezIt.jpg?fit=crop&h=64&w=64&auto=format&dpr=5&q=20 5x"          width="64"   /> </a>
  <div class="flow">
    <cite class="author__name">
      <a href="/authors/yoavweiss/">Yoav Weiss</a>
    </cite>
    <div class="author__links cluster">
               <a href="https://twitter.com/yoavweiss">Twitter</a>
               <a href="https://github.com/yoavweiss">GitHub</a>
               
               
             </div>
  </div>
</div>
            
          </div>
        
      </header>

      

      

  

  <div class="xl:hidden-yes flow-space-size-1">
    <details data-type="inner" role="navigation" aria-label="Содержание">
      <summary>
        Содержание
      </summary>
      <div class="toc"><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#predystoriya">Предыстория</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#sostoyanie-stroki-user-agent">Состояние строки User-Agent</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#predstavlyaem-novoe-rasshirenie-user-agent-client-hints">Представляем новое расширение User-Agent Client Hints</a></li><li class="toc__listitem"><a class="toc__anchor" href="#user-agent-client-hints-v-chromium-84">User-Agent Client Hints в Chromium 84</a><ul class="toc__list"><li class="toc__listitem"><a class="toc__anchor" href="#otvet-user-agent-i-zagolovki-zaprosov">Ответ User-Agent и заголовки запросов</a></li><li class="toc__listitem"><a class="toc__anchor" href="#primer-obmena">Пример обмена</a></li><li class="toc__listitem"><a class="toc__anchor" href="#javascript-api">JavaScript API</a></li><li class="toc__listitem"><a class="toc__anchor" href="#zapustite-demoversiyu">Запустите демоверсию</a></li><li class="toc__listitem"><a class="toc__anchor" href="#srok-sluzhby-podskazki-i-sbros">Срок службы подсказки и сброс</a></li><li class="toc__listitem"><a class="toc__anchor" href="#oblast-primeneniya-podskazok-i-zaprosov-mezhdu-raznymi-istochnikami">Область применения подсказок и запросов между разными источниками</a></li></ul></li><li class="toc__listitem"><a class="toc__anchor" href="#gde-ispolzovat-user-agent-client-hints">Где использовать User-Agent Client Hints?</a></li><li class="toc__listitem"><a class="toc__anchor" href="#chto-proishodit-so-strokoj-user-agent">Что происходит со строкой User-Agent?</a></li></ul></div>
    </details>
  </div>



      <div class="youtube">  <lite-youtube    videoid="f0YY0o2OAKA"      >  </lite-youtube></div>
<p>Client Hints позволяют разработчикам активно запрашивать информацию об устройстве или условиях пользователя, вместо того, чтобы извлекать ее из строки User-Agent (UA). Предоставление этого альтернативного маршрутапервый шаг к уменьшению детализации строки User-Agent.</p>
<p>Узнайте, как обновить существующий функционал, основанный на анализе строки User-Agent, чтобы вместо этого использовать User-Agent Client Hints.</p>
<div role="banner" class="banner bg-state-bad-bg color-core-text">
    <div class="banner__content flow">
       Если вы уже используете User-Agent Client Hints, обратите внимание на предстоящие изменения. Формат заголовков меняется, чтобы токены <code>Accept-CH</code> точно соответствовали возвращаемым заголовкам. Ранее сайт мог отправлять <code>Accept-CH: UA-Platform</code>, чтобы получить заголовок <code>Sec-CH-UA-Platform</code>, а теперь сайт должен отправить <code>Accept-CH: Sec-CH-UA-Platform</code>.  Если вы уже внедрили расширение User-Agent Client Hints, отправляйте оба формата до тех пор, пока изменение не будет полностью развернуто в стабильной версии Chromium. См. обсуждение <a href="https://groups.google.com/a/chromium.org/g/blink-dev/c/t-S9nnos9qU/m/pUFJb00jBAAJ">Intent to Remove: Rename User-Agent Client Hint ACCEPT-CH tokens</a>. 
    </div>
    </div>
<h2 id="predystoriya">Предыстория <a class="w-headline-link" href="#predystoriya">#</a></h2>
<p>Когда веб-браузеры отправляют запросы, они включают информацию о браузере и его среде, чтобы серверы могли включить аналитику и настроить ответ. Это было определено еще в 1996 году в стандарте RFC 1945 для HTTP/1.0, там же можно найти <a href="https://tools.ietf.org/html/rfc1945#section-10.15" rel="noopener">исходное определение для строки User-Agent</a>, которое включает пример:</p>
<web-copy-code><pre class="language-text"><code class="language-text">User-Agent: CERN-LineMode/2.15 libwww/2.17b3</code></pre>
</web-copy-code><p>Этот заголовок предназначался для указания в порядке значимости продукта (например, браузера или библиотеки) и комментария (например, версии).</p>
<h3 id="sostoyanie-stroki-user-agent">Состояние строки User-Agent <a class="w-headline-link" href="#sostoyanie-stroki-user-agent">#</a></h3>
<p>За прошедшие <em>десятилетия в</em> этой строке накопилось множество дополнительных сведений о клиенте, делающем запрос (а также мусор из-за сохранения совместимости с предыдущими версиями). Взглянем на текущую строку User-Agent из Chrome:</p>
<web-copy-code><pre class="language-text"><code class="language-text">Mozilla/5.0 (Linux; Android 10; Pixel 3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4076.0 Mobile Safari/537.36</code></pre>
</web-copy-code><p>Приведенная выше строка содержит информацию об операционной системе пользователя и ее версии, модели устройства, марке и полной версии браузера, достаточно подсказок, чтобы сделать вывод о том, что это мобильный браузер, не говоря уже о ряде ссылок на другие браузеры по историческим причинам.</p>
<p>Комбинация этих параметров с огромным разнообразием возможных значений означает, что строка User-Agent может содержать достаточно информации, чтобы можно было однозначно идентифицировать отдельных пользователей. Если вы протестируете свой браузер в <a href="https://amiunique.org/" rel="noopener">AmIUnique</a>, вы увидите, насколько точно <strong>ваша</strong> строка User-Agent идентифицирует <strong>вас</strong>. Чем ниже ваш результирующий «коэффициент подобия», тем более уникальны ваши запросы, тем легче серверам скрыто вас отслеживать.</p>
<p>Строка User-Agent позволяет включать множество допустимых <a href="https://github.com/WICG/ua-client-hints/blob/main/README.md#use-cases" rel="noopener">вариантов использования</a>, и важна для разработчиков и владельцев сайтов. Но не менее важно, чтобы конфиденциальность пользователей была защищена от скрытых методов отслеживания, и отправка информации UA по умолчанию идет вразрез с этой целью.</p>
<p>Необходимо также улучшить веб-совместимость строки User-Agent. Она неструктурированна, поэтому её разбор затруднен, что часто является причиной неприятных для пользователей ошибок и проблем совместимости сайтов. Эти проблемы в несоразмерно большей степени  затрагивают пользователей менее распространенных браузеров, поскольку сайтам не всегда удается проверить их конфигурацию.</p>
<h2 id="predstavlyaem-novoe-rasshirenie-user-agent-client-hints">Представляем новое расширение User-Agent Client Hints <a class="w-headline-link" href="#predstavlyaem-novoe-rasshirenie-user-agent-client-hints">#</a></h2>
<p>Расширение <a href="https://github.com/WICG/ua-client-hints#explainer-reducing-user-agent-granularity" rel="noopener">User-Agent Client Hints</a> позволяет получить доступ к той же информации, но более конфиденциальным способом, что, в свою очередь, позволяет браузерам в конечном итоге сократить стандартную передачу данных в строке User-Agent. <a href="https://tools.ietf.org/html/draft-ietf-httpbis-client-hints" rel="noopener">Client Hints</a> применяет модель, в которой сервер должен запрашивать у браузера набор данных о клиенте (подсказки), а браузер применяет свои собственные политики или конфигурацию пользователя для определения того, какие данные будут возвращены. Это означает, что вместо того, чтобы раскрывать <strong>все</strong> данные User-Agent по умолчанию, доступ теперь управляется явным и контролируемым образом. Разработчики также выигрывают от более простого APIбольше никаких регулярных выражений!</p>
<p>Текущий набор Client Hints в первую очередь описывает возможности браузера и подключения к нему. Вы можете ознакомиться с подробностями в статье <a href="https://developers.google.com/web/updates/2015/09/automating-resource-selection-with-client-hints" rel="noopener">«Автоматизация выбора ресурсов с помощью Client Hints»</a>, но вот краткое описание процесса.</p>
<p>Сервер запрашивает определенные Client Hints через заголовок:</p>
<p>⬇️ <em>Ответ от сервера</em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Accept-CH: Viewport-Width, Width</code></pre>
</web-copy-code><p>Или метатег:</p>
<web-copy-code><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Accept-CH<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Viewport-Width, Width<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre>
</web-copy-code><p>Затем браузер может выбрать, отправлять ли следующие заголовки обратно при последующих запросах:</p>
<p>⬆️ <em>Последующий запрос</em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Viewport-Width: 460<br>Width: 230</code></pre>
</web-copy-code><p>Сервер может изменять свои ответы, например, отображая изображения с соответствующим разрешением.</p>
<aside class="aside flow bg-state-info-bg color-state-info-text">
<div class=" flow">
<p>В настоящее время ведутся дискуссии о включении клиентских подсказок при первоначальном запросе, но прежде чем идти по этому пути, следует подумать об <a href="/responsive-web-design-basics">отзывчивом дизайне</a> или прогрессивном улучшении.</p>
</div></aside>
<p>Спецификация User-Agent Client Hints расширяет диапазон свойств с помощью префикса <code>Sec-CH-UA</code>, который можно указать в заголовке ответа сервера <code>Accept-CH</code>. Чтобы узнать все подробности, начните с <a href="https://github.com/WICG/ua-client-hints/blob/main/README.md" rel="noopener">пояснения</a>, а затем погрузитесь в <a href="https://wicg.github.io/ua-client-hints/" rel="noopener">полное описание проекта</a>.</p>
<aside class="aside flow bg-state-info-bg color-state-info-text">
<div class=" flow">
<p>Client Hints отправляются <strong>только через защищенные соединения</strong>, поэтому убедитесь, что вы <a href="/why-https-matters">перенесли свой сайт на HTTPS</a>.</p>
</div></aside>
<p>Новый набор подсказок доступен в Chromium 84, поэтому давайте рассмотрим, как всё это работает.</p>
<h2 id="user-agent-client-hints-v-chromium-84">User-Agent Client Hints в Chromium 84 <a class="w-headline-link" href="#user-agent-client-hints-v-chromium-84">#</a></h2>
<p>User-Agent Client Hints будут постепенно включаться в стабильную версию Chrome по мере решения <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1091285" rel="noopener">проблем с совместимостью</a>. Чтобы включить эту функцию для тестирования:</p>
<ul>
<li>используйте <strong>бета-версию</strong> Chrome 84 или аналогичную;</li>
<li>включите флаг <code>about://flags/#enable-experimental-web-platform-features</code>.</li>
</ul>
<p>По умолчанию браузер возвращает марку браузера, основную/старшую версию и индикатор, если клиент является мобильным устройством:</p>
<p>⬆️ <em>Все запросы</em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Sec-CH-UA: "Chromium";v="84", "Google Chrome";v="84"<br>Sec-CH-UA-Mobile: ?0</code></pre>
</web-copy-code><aside class="aside flow bg-state-bad-bg color-state-bad-text">
<p class="cluster color-state-bad-text">
<span class="aside__icon box-block "><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Error sign">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15v-2h2v2h-2zm0-10v6h2V7h-2z" />
</svg></span>
<strong>Внимание</strong></p>
<div class=" flow">
<p>Эти свойства сложнее, чем просто одно значение, поэтому для представления списков и логических значений используются <a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html" rel="noopener">структурированные заголовки</a>.</p>
</div></aside>
<h3 id="otvet-user-agent-i-zagolovki-zaprosov">Ответ User-Agent и заголовки запросов <a class="w-headline-link" href="#otvet-user-agent-i-zagolovki-zaprosov">#</a></h3>
<style>
.table-wrapper th:nth-of-type(1), .table-wrapper th:nth-of-type(2) {
    width: 28ch;
}

.table-wrapper td {
  padding: 4px 8px 4px 0;
}
</style>
<div class="w-table-wrapper">
<table>
<thead>
<tr>
<th>⬇️Ответ <code>Accept-CH</code><br><br>⬆️ Заголовок запроса</th>
<th>⬆️ Запрос<br> Пример значения</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Sec-CH-UA</code></td>
<td><code>&quot;Chromium&quot;;v=&quot;84&quot;,</code><br><code>&quot;Google Chrome&quot;;v=&quot;84&quot;</code></td>
<td>Список брендов браузеров и их основные версии.</td>
</tr>
<tr>
<td><code>Sec-CH-UA-Mobile</code></td>
<td><code>?1</code></td>
<td>Логическое значение, указывающее, находится ли браузер на мобильном устройстве ( <code>?1</code>истина) или нет ( <code>?0</code>ложь).</td>
</tr>
<tr>
<td><code>Sec-CH-UA-Full-Version</code></td>
<td><code>&quot;84.0.4143.2&quot;</code></td>
<td>Полная версия браузера.</td>
</tr>
<tr>
<td><code>Sec-CH-UA-Platform</code></td>
<td><code>&quot;Android&quot;</code></td>
<td>Платформа устройства, обычно операционная система (ОС).</td>
</tr>
<tr>
<td><code>Sec-CH-UA-Platform-Version</code></td>
<td><code>&quot;10&quot;</code></td>
<td>Версия платформы или ОС.</td>
</tr>
<tr>
<td><code>Sec-CH-UA-Arch</code></td>
<td><code>&quot;arm&quot;</code></td>
<td>Базовая архитектура устройства. Хотя это может не иметь отношения к отображению страницы, сайт может предложить загрузку, которая по умолчанию имеет правильный формат.</td>
</tr>
<tr>
<td><code>Sec-CH-UA-Model</code></td>
<td><code>&quot;Pixel 3&quot;</code></td>
<td>Модель устройства.</td>
</tr>
</tbody>
</table>
</div><aside class="aside flow bg-tertiary-box-bg color-tertiary-box-text">
<p class="cluster ">
<span class="aside__icon box-block "><svg width="24" height="24" viewBox="0 0 24 24" role="img" aria-label="Lightbulb" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 017 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z" />
</svg></span>
<strong>Обратите внимание</strong></p>
<div class=" flow">
<p>По соображениям конфиденциальности и совместимости значение может быть пустым, не возвращаться или заполняться изменяющимся значением. Это называется <a href="https://wicg.github.io/ua-client-hints/#grease" rel="noopener">GREASE</a>.</p>
</div></aside>
<h3 id="primer-obmena">Пример обмена <a class="w-headline-link" href="#primer-obmena">#</a></h3>
<p>Обмен будет выглядеть следующим образом:</p>
<p>⬆️ <em>Первоначальный запрос из браузера</em><br> Браузер запрашивает страницу <code>/downloads</code> с сайта и отправляет свою основную строку User-Agent по умолчанию.</p>
<web-copy-code><pre class="language-text"><code class="language-text">GET /downloads HTTP/1.1<br>Host: example.site<br><br>Sec-CH-UA: "Chromium";v="84", "Google Chrome";v="84"<br>Sec-CH-UA-Mobile: ?0</code></pre>
</web-copy-code><p>⬇️ <em>Ответ от сервера</em><br> Сервер отправляет страницу обратно и дополнительно запрашивает полную версию браузера и платформу.</p>
<web-copy-code><pre class="language-text"><code class="language-text">HTTP/1.1 200 OK<br>Accept-CH: Sec-CH-UA-Full-Version, Sec-CH-UA-Platform</code></pre>
</web-copy-code><p>⬆️ <em>Последующие запросы</em><br> Браузер предоставляет серверу доступ к дополнительной информации и отправляет дополнительные подсказки во всех последующих ответах.</p>
<web-copy-code><pre class="language-text"><code class="language-text">GET /downloads/app1 HTTP/1.1<br>Host: example.site<br><br>Sec-CH-UA: "Chromium";v="84", "Google Chrome";v="84"<br>Sec-CH-UA-Mobile: ?0<br>Sec-CH-UA-Full-Version: "84.0.4143.2"<br>Sec-CH-UA-Platform: "Android"</code></pre>
</web-copy-code><h3 id="javascript-api">JavaScript API <a class="w-headline-link" href="#javascript-api">#</a></h3>
<p>Наряду с заголовками, доступ к User-Agent можно получить в JavaScript через <code>navigator.userAgentData</code>. К информации заголовков по умолчанию <code>Sec-CH-UA</code> и <code>Sec-CH-UA-Mobile</code> можно получить доступ через свойства <code>brands</code> и <code>mobile</code> соответственно:</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Log the brand data</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>userAgentData<span class="token punctuation">.</span>brands<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// output</span><br><span class="token punctuation">[</span><br>  <span class="token punctuation">{</span><br>    brand<span class="token operator">:</span> <span class="token string">'Chromium'</span><span class="token punctuation">,</span><br>    version<span class="token operator">:</span> <span class="token string">'84'</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    brand<span class="token operator">:</span> <span class="token string">'Google Chrome'</span><span class="token punctuation">,</span><br>    version<span class="token operator">:</span> <span class="token string">'84'</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br><span class="token comment">// Log the mobile indicator</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>userAgentData<span class="token punctuation">.</span>mobile<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// output</span><br><span class="token boolean">false</span><span class="token punctuation">;</span></code></pre>
</web-copy-code><p>Доступ к дополнительным значениям осуществляется через вызов <code>getHighEntropyValues()</code>. Термин «высокая энтропия» относится к <a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)" rel="noopener">информационной энтропии</a>, другими словамиколичеству информации, которую эти значения раскрывают о браузере пользователя. Как и в случае с запросом дополнительных заголовков, браузер решает, какие значения будут возвращены.</p>
<web-copy-code><pre class="language-js"><code class="language-js"><span class="token comment">// Log the full user-agent data</span><br>navigator<br>  <span class="token punctuation">.</span>userAgentData<span class="token punctuation">.</span><span class="token function">getHighEntropyValues</span><span class="token punctuation">(</span><br>    <span class="token punctuation">[</span><span class="token string">"architecture"</span><span class="token punctuation">,</span> <span class="token string">"model"</span><span class="token punctuation">,</span> <span class="token string">"platform"</span><span class="token punctuation">,</span> <span class="token string">"platformVersion"</span><span class="token punctuation">,</span><br>     <span class="token string">"uaFullVersion"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">ua</span> <span class="token operator">=></span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ua<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// output</span><br><span class="token punctuation">{</span><br>  <span class="token string">"architecture"</span><span class="token operator">:</span> <span class="token string">"x86"</span><span class="token punctuation">,</span><br>  <span class="token string">"model"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span><br>  <span class="token string">"platform"</span><span class="token operator">:</span> <span class="token string">"Linux"</span><span class="token punctuation">,</span><br>  <span class="token string">"platformVersion"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span><br>  <span class="token string">"uaFullVersion"</span><span class="token operator">:</span> <span class="token string">"84.0.4143.2"</span><br><span class="token punctuation">}</span></code></pre>
</web-copy-code><h3 id="zapustite-demoversiyu">Запустите демоверсию <a class="w-headline-link" href="#zapustite-demoversiyu">#</a></h3>
<p>Вы можете опробовать как заголовки, так и JavaScript API на своем устройстве на сайте <a href="https://user-agent-client-hints.glitch.me" rel="noopener">user-agent-client-hints.glitch.me</a>.</p>
<aside class="aside flow bg-state-info-bg color-state-info-text">
<div class=" flow">
<p>Убедитесь, что вы используете версию Chrome 84 Beta или аналогичную с включенным флагом <code>about://flags/#enable-experimental-web-platform-features</code>.</p>
</div></aside>
<h3 id="srok-sluzhby-podskazki-i-sbros">Срок службы подсказки и сброс <a class="w-headline-link" href="#srok-sluzhby-podskazki-i-sbros">#</a></h3>
<p>Подсказки, указанные в заголовке <code>Accept-CH</code>, будут отправляться в течение всего сеанса работы браузера или до тех пор, пока не будет указан другой набор подсказок.</p>
<p>Это означает, что если сервер отправляет:</p>
<p>⬇️ <em>Ответ</em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Accept-CH: Sec-CH-UA-Full-Version</code></pre>
</web-copy-code><p>Браузер будет отправлять заголовок <code>Sec-CH-UA-Full-Version</code> по всем запросам для этого сайта, пока браузер не будет закрыт.</p>
<p>⬆️ <em>Последующие запросы</em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Sec-CH-UA-Full-Version: "84.0.4143.2"</code></pre>
</web-copy-code><p>Однако, если будет получен заголовок <code>Accept-CH</code>, он <strong>полностью заменит</strong> текущие подсказки, отправляемые браузером.</p>
<p>⬇️ <em>Ответ</em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Accept-CH: Sec-CH-UA-Platform</code></pre>
</web-copy-code><p>⬆️ <em>Последующие запросы</em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Sec-CH-UA-Platform: "Android"</code></pre>
</web-copy-code><p>Запрошенная ранее <code>Sec-CH-UA-Full-Version</code> <strong>не будет отправлена</strong>.</p>
<p>Лучше всего думать о заголовке <code>Accept-CH</code> как об указании полного набора подсказок, предпочтительных для этой страницы, то есть браузер затем отправляет указанные подсказки для всех подресурсов на этой странице. Хотя подсказки будут сохраняться до следующей навигации, сайту не следует полагаться на них или предполагать, что они будут доставлены.</p>
<aside class="aside flow bg-state-good-bg color-state-good-text">
<p class="cluster ">
<span class="aside__icon box-block "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="24" width="24" fill="currentColor" role="img" aria-label="Check">
  <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
</svg></span>
<strong>Успех</strong></p>
<div class=" flow">
<p>Следите за тем, чтобы и без этой информации вы могли предоставлять пользователю качественный опыт взаимодействия. Это сделано для улучшения пользовательского опыта, а не для его определения. Вот почему их называют «подсказками», а не «ответами» или «требованиями»!</p>
</div></aside>
<p>Вы также можете эффективно очистить все подсказки, отправляемые браузером, отправив в ответ <code>Accept-CH</code>. Подумайте о добавлении этого заголовка в любом месте, где пользователь сбрасывает настройки или выходит из вашего сайта.</p>
<p>Этот шаблон также соответствует тому, как работают подсказки через тег <code>&lt;meta http-equiv=&quot;Accept-CH&quot; ...&gt;</code>. Запрашиваемые подсказки будут отправляться только на запросы, инициированные страницей, а не при последующей навигации.</p>
<h3 id="oblast-primeneniya-podskazok-i-zaprosov-mezhdu-raznymi-istochnikami">Область применения подсказок и запросов между разными источниками <a class="w-headline-link" href="#oblast-primeneniya-podskazok-i-zaprosov-mezhdu-raznymi-istochnikami">#</a></h3>
<p>По умолчанию Client Hints отправляются только по запросам из одного источника. Это означает, что если вы запрашиваете конкретные подсказки на <code>https://example.com</code>, но ресурсы, которые вы хотите оптимизировать, находятся на <code>https://downloads.example.com</code> они <strong>не</strong> получат никаких подсказок.</p>
<p>Чтобы разрешить подсказки по запросам между разными источниками, каждая подсказка и источник должны быть указаны в заголовке <code>Feature-Policy</code>. Чтобы применить это к User-Agent Client Hint, нужно записать подсказку в нижнем регистре и удалить префикс <code>sec-</code>. Например:</p>
<p>⬇️ <em>Ответ от <code>example.com</code></em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Accept-CH: Sec-CH-UA-Platform, DPR<br>Feature-Policy: ch-ua-platform downloads.example.com;<br>                ch-dpr cdn.provider img.example.com</code></pre>
</web-copy-code><p>⬆️ <em>Запрос к <code>downloads.example.com</code></em></p>
<web-copy-code><pre class="language-text"><code class="language-text">Sec-CH-UA-Platform: "Android"</code></pre>
</web-copy-code><p>⬆️ <em>Запросы к <code>cdn.provider</code> или <code>img.example.com</code></em></p>
<web-copy-code><pre class="language-text"><code class="language-text">DPR: 2</code></pre>
</web-copy-code><h2 id="gde-ispolzovat-user-agent-client-hints">Где использовать User-Agent Client Hints? <a class="w-headline-link" href="#gde-ispolzovat-user-agent-client-hints">#</a></h2>
<p>Быстрый ответ: вам следует провести рефакторинг любых экземпляров, где вы анализируете заголовок User-Agent или используете вызовы JavaScript, которые обращаются к той же информации (например, <code>navigator.userAgent</code>, <code>navigator.appVersion</code> или <code>navigator.platform</code>), чтобы вместо этого использовать User-Agent Client Hints.</p>
<p>Если пойти еще дальше, то следует пересмотреть использование информации User-Agent и по возможности заменить ее другими методами. Часто можно достичь той же цели, используя прогрессивное улучшение, обнаружение особенностей или <a href="/responsive-web-design-basics">отзывчивый дизайн</a>. Основная проблема с использованием данных User-Agent вы всегда поддерживаете соответствие между проверяемым свойством и тем поведением, которое оно обеспечивает. Это накладные расходы на обслуживание, затрачиваемые на проверку того, является ли ваше обнаружение полным и актуальным.</p>
<p>С учетом этих предостережений в репозитории <a href="https://github.com/WICG/ua-client-hints#use-cases" rel="noopener">User-Agent Client Hints перечислены некоторые допустимые варианты использования</a> для сайтов.</p>
<h2 id="chto-proishodit-so-strokoj-user-agent">Что происходит со строкой User-Agent? <a class="w-headline-link" href="#chto-proishodit-so-strokoj-user-agent">#</a></h2>
<p>План: свести к минимуму возможность скрытого отслеживания в Интернете за счет уменьшения количества идентифицирующей информации, предоставляемой существующей строкой User-Agent, не вызывая при этом чрезмерных сбоев в работе существующих сайтов. Внедрение User-Agent Client Hints теперь дает вам возможность понять новую функциональность и поэкспериментировать с ней, прежде чем какие-либо изменения будут внесены в строки User-Agent.</p>
<p><a href="https://groups.google.com/a/chromium.org/d/msg/blink-dev/-2JIRNMWJ7s/u-YzXjZ8BAAJ" rel="noopener">В конечном итоге</a> информация в строке User-Agent будет сведена к минимуму, чтобы поддерживать устаревший формат, предоставляя только высокоуровневую информацию о браузере и старшей версии, как в подсказках по умолчанию. В Chromium это изменение было отложено как минимум до 2021 года, чтобы предоставить экосистеме дополнительное время для оценки новых возможностей ​User Agent Client Hints.</p>
<p>Вы можете протестировать эту версию, включив флаг <code>about://flags/#reduce-user-agent</code> из Chrome 93 (примечание: в версиях Chrome 84 –92 этот флаг назывался <code>about://flags/#freeze-user-agent</code>). Это вернет строку с историческими записями по соображениям совместимости, но с очищенными деталями. Например:</p>
<web-copy-code><pre class="language-text"><code class="language-text">Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.0.0 Mobile Safari/537.36</code></pre>
</web-copy-code><p><em>Фото <a href="https://unsplash.com/@szolkin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener">Сергея Золкина</a> с <a href="https://unsplash.com/photos/m9qMoh-scfE?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener">Unsplash</a></em></p>


      

      <div class="cluster gutter-base flow-space-size-2" role="list" aria-label="tags">
        
          
        
          
        
          
            
            <a class="pill" href="/tags/privacy/">Конфиденциальность</a>
          
        
          
            
            <a class="pill" href="/tags/security/">Безопасность</a>
          
        
      </div>

      <div class="text-size-0 color-mid-text">
        <span>
          
          Последнее обновление: <time>Feb 12, 2021</time>
          
        </span>
        —
        <a
          href="https://github.com/GoogleChrome/web.dev/blob/main/src/site/content/ru/blog/user-agent-client-hints/index.md"
        >
          Улучшить статью
        </a>
      </div>

      

      
        
        
      

      
        <div class="flow-space-size-2">
          <a href="/blog" class="button" data-type="secondary">
            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>

            <span>Return to all articles</span>
          </a>
        </div>
      
      <div class="docked-actions flow flow-space-base">    
        <div>
          <share-action class="gc-analytics-event fab"
            authors="@rowan_m | @yoavweiss"
            data-category="web.dev"
            data-label="share"
            data-action="click"
            data-type="primary"
            data-icon="share"
            tabindex="0"
            role="button"
          >
            <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M18 16.1c-.8 0-1.4.3-2 .8l-7.1-4.2c.1-.2.1-.5.1-.7s0-.5-.1-.7L16 7.2c.5.5 1.2.8 2 .8 1.7 0 3-1.3 3-3s-1.3-3-3-3-3 1.3-3 3c0 .2 0 .5.1.7L8 9.8C7.5 9.3 6.8 9 6 9c-1.7 0-3 1.3-3 3s1.3 3 3 3c.8 0 1.5-.3 2-.8l7.1 4.2c-.1.2-.1.4-.1.6 0 1.6 1.3 2.9 2.9 2.9s2.9-1.3 2.9-2.9-1.2-2.9-2.8-2.9z" fill="currentColor"/></svg>
 
            <span class="fab__label">Поделиться</span>
          </share-action>
        </div>
        
      </div>
    </article>
  </div>
</div>


</main>
<footer class="site-footer" role="contentinfo">
  <nav class="site-footer__primary-nav auto-grid" aria-label="footer navigation">
    <div>
      <h3 class="text-size-2 color-mid-text">Contribute</h3>
      <ul class="w-footer__linkbox-list" role="list">
        <li>
          <a href="https://github.com/GoogleChrome/web.dev/issues/new?assignees=&labels=bug&template=bug_report.md&title="
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            Сообщить об ошибке
          </a>
        </li>
        <li>
          <a href="https://github.com/googlechrome/web.dev"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
            Просмотреть исходный код
          </a>
        </li>
      </ul>
    </div>
    <div>
      <h3 class="text-size-2 color-mid-text">Дополнительная информация</h3>
      <ul class="w-footer__linkbox-list" role="list">
          <li>
          <a href="https://developer.chrome.com/"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            developer.chrome.com
          </a>
        </li>
        <li>
          <a href="https://blog.chromium.org/"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            Новости Chrome
          </a>
        </li>
        <li>
          <a href="https://developers.google.com/web/fundamentals"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
            Web Fundamentals
          </a>
        </li>
        <li>
          <a href="/tags/case-study/"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">
            Разборы конкретных случаев
          </a>
        </li>
        <li>
          <a href="/podcasts/"
            data-category="Podcasts" data-label="Footer Link (index 5)">
            Подкасты
          </a>
        </li>
        <li>
          <a href="/shows/"
            data-category="Shows" data-label="Footer Link (index 6)">
            Шоу
          </a>
        </li>
      </ul>
    </div>
    <div>
      <h3 class="text-size-2 color-mid-text">Соцсети</h3>
      <ul class="w-footer__linkbox-list" role="list">
        <li>
          <a href="https://www.twitter.com/ChromiumDev"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">
            Twitter
          </a>
        </li>
        <li>
          <a href="https://www.youtube.com/user/ChromeDevelopers"
            data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">
            YouTube
          </a>
        </li>
      </ul>
    </div>
  </nav>
  <nav class="site-footer__brand-nav repel" aria-label="Google developers">
    <ul class="cluster" role="list">
      <li>
        <a href="https://developers.google.com/" data-category="Site-Wide Custom Events" data-label="Footer Google Developers Link">
          <img loading="lazy" width="185" height="33" class="w-footer__utility-logo" src="/images/lockup-color.png"
            alt="Google Developers" />
        </a>
      </li>
      <li>
        <a href="https://developer.chrome.com/"
          data-category="Site-Wide Custom Events" data-label="Footer Chrome Link">
          Chrome
        </a>
      </li>
      <li>
        <a href="https://firebase.google.com/" data-category="Site-Wide Custom Events"
          data-label="Footer Firebase Link">
          Firebase
        </a>
      </li>
      <li>
        <a href="https://cloud.google.com/" data-category="Site-Wide Custom Events"
          data-label="Footer Google Cloud Platform Link">
          Google Cloud Platform
        </a>
      </li>
      <li>
        <a href="https://developers.google.com/products"
          data-category="Site-Wide Custom Events" data-label="Footer All products Link">
          Все продукты
        </a>
      </li>
    </ul>
    <web-language-select current="ru"></web-language-select>
  </nav>
  <nav class="site-footer__misc-links" aria-label="terms and policies">
    <ul class="cluster" role="list">
      <li>
        <a href="https://policies.google.com/" data-category="Site-Wide Custom Events"
          data-label="Footer Terms and Privacy link">
          Условия и конфиденциальность
        </a>
      </li>
      <li>
        <a href="/community-guidelines/" data-category="Site-Wide Custom Events"
          data-label="Footer Community Guidelines link">
          Правила сообщества
        </a>
      </li>
    </ul>
  </nav>
  <p class="gap-top-size-2 text-size-0">
    Except as otherwise noted, the content of this page is licensed
    under the
    <a href="https://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 License</a>,
    and code samples are licensed under the
    <a href="https://www.apache.org/licenses/LICENSE-2.0">
    Apache 2.0 License</a>. For details, see the
    <a href="https://developers.google.com/terms/site-policies">
    Google Developers Site Policies</a>.
  </p>
</footer>


  </body>
</html>
